<HTML>
<HEAD>
   <TITLE> module coupler (generated by f90doc) </TITLE>
</HEAD>
<H1> Module coupler </H1>
<PRE>module coupler

        ! Uses
    use <A HREF="coupler_parameters.html">coupler_parameters</A>

        ! Interfaces
    public interface <A HREF="coupler.html#interface_cpl_send">CPL_send</A>
    public interface <A HREF="coupler.html#interface_cpl_recv">CPL_recv</A>
    public interface <A HREF="coupler.html#interface_coupler_send_data">coupler_send_data</A>
    public interface <A HREF="coupler.html#interface_coupler_recv_data">coupler_recv_data</A>

        ! Subroutines and functions
    public subroutine <A HREF="coupler.html#subroutine_cpl_create_comm">CPL_create_comm</A> (callingrealm, RETURNED_REALM_COMM, ierror)
    public subroutine <A HREF="coupler.html#subroutine_cpl_create_map">CPL_create_map</A> ()
    public subroutine <A HREF="coupler.html#subroutine_cpl_cfd_adjust_domain">CPL_cfd_adjust_domain</A> (xL, yL, zL, nx, ny, nz, density_cfd)
    public subroutine <A HREF="coupler.html#subroutine_cpl_gather">CPL_gather</A> (gatherarray, npercell, limits, recvarray)
    public subroutine <A HREF="coupler.html#subroutine_cpl_scatter">CPL_scatter</A> (scatterarray, npercell, limits, recvarray)
    private subroutine <A HREF="coupler.html#subroutine_cpl_send_3d">CPL_send_3d</A> (temp, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    private subroutine <A HREF="coupler.html#subroutine_cpl_send_4d">CPL_send_4d</A> (asend, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    private subroutine <A HREF="coupler.html#subroutine_cpl_send_xd">CPL_send_xd</A> (asend, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    private subroutine <A HREF="coupler.html#subroutine_cpl_recv_3d">CPL_recv_3d</A> (temp, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    private subroutine <A HREF="coupler.html#subroutine_cpl_recv_4d">CPL_recv_4d</A> (arecv, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    private subroutine <A HREF="coupler.html#subroutine_cpl_recv_xd">CPL_recv_xd</A> (arecv, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    public subroutine <A HREF="coupler.html#subroutine_cpl_rank_map">CPL_rank_map</A> (COMM, rank, nproc, comm2world, world2comm, ierr)
    public subroutine <A HREF="coupler.html#subroutine_cpl_pack">CPL_pack</A> (unpacked, packed, realm, icmax_pack, icmin_pack, jcmax_pack, jcmin_pack, kcmax_pack, kcmin_pack)
    public subroutine <A HREF="coupler.html#subroutine_cpl_unpack">CPL_unpack</A> (packed, unpacked, realm)
    public subroutine <A HREF="coupler.html#subroutine_cpl_proc_extents">CPL_proc_extents</A> (coord, realm, extents, ncells)
    public subroutine <A HREF="coupler.html#subroutine_cpl_olap_extents">CPL_olap_extents</A> (coord, realm, extents, ncells)
    public subroutine <A HREF="coupler.html#subroutine_cpl_proc_portion">CPL_proc_portion</A> (coord, realm, limits, portion, ncells)
    public subroutine <A HREF="coupler.html#subroutine_cpl_cart_coords">CPL_Cart_coords</A> (COMM, rank, realm, maxdims, coords, ierr)
    private subroutine <A HREF="coupler.html#subroutine_coupler_send_data_3d">coupler_send_data_3d</A> (temp, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    private subroutine <A HREF="coupler.html#subroutine_coupler_send_data_4d">coupler_send_data_4d</A> (asend, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    private subroutine <A HREF="coupler.html#subroutine_coupler_send_data_xd">coupler_send_data_xd</A> (asend, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    private subroutine <A HREF="coupler.html#subroutine_coupler_recv_data_3d">coupler_recv_data_3d</A> (temp, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, accumulate, pbc)
    private subroutine <A HREF="coupler.html#subroutine_coupler_recv_data_4d">coupler_recv_data_4d</A> (arecv, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, accumulate, pbc)
    private subroutine <A HREF="coupler.html#subroutine_coupler_recv_data_xd">coupler_recv_data_xd</A> (arecv, index_transpose, a_lbound, a_grid_start, a_grid_end, glower, gupper, accumulate, pbc)
    public subroutine <A HREF="coupler.html#subroutine_coupler_cfd_get">coupler_cfd_get</A> (jcmax_overlap, jcmin)
    public subroutine <A HREF="coupler.html#subroutine_coupler_md_get">coupler_md_get</A> (xL_md, yL_md, zL_md, MD_initial_cellsize, top_dy, overlap_with_top_cfd)
    public function <A HREF="coupler.html#function_coupler_md_get_save_period">coupler_md_get_save_period</A> () result (p)
    public function <A HREF="coupler.html#function_coupler_md_get_average_period">coupler_md_get_average_period</A> () result (p)
    public function <A HREF="coupler.html#function_coupler_md_get_md_steps_per_cfd_dt">coupler_md_get_md_steps_per_cfd_dt</A> () result (p)
    public function <A HREF="coupler.html#function_coupler_md_get_nsteps">coupler_md_get_nsteps</A> () result (n)
    public function <A HREF="coupler.html#function_coupler_md_get_dt_cfd">coupler_md_get_dt_cfd</A> () result (t)
    public function <A HREF="coupler.html#function_coupler_md_get_density">coupler_md_get_density</A> () result (r)
    public function <A HREF="coupler.html#function_coupler_md_get_cfd_id">coupler_md_get_cfd_id</A> () result (r)

end module coupler
</PRE>
 Routines accessible from application ( molecular or continuum ) after 
 the name, in parenthesis, is the realm in which each routine must be called
<P>
 <UL>
 <LI>  CPL_create_comm	      (cfd+md)   splits MPI_COMM_WORLD, create inter - 
                                   communicator between CFD and MD
<P>
 <LI>  CPL_create_map	      (cfd+md)   creates correspondence maps between 
                                      the CFD grid and MD domains
<P>
 <LI>  CPL_cfd_adjust_domain     (cfd)    adjust CFD tomain to an integer number 
                                      FCC or similar MD initial layout
<P>
 <LI>  CPL_send_data        	  (cfd+md)   sends grid data exchanged between 
                                      realms ( generic interface)
<P>
 <LI>  CPL_recv_data        	  (cfd+md)   receives data exchanged between realms 
                                      ( generic interface)
<P>
 <LI>  CPL_cfd_get               (cfd)    returns coupler internal parameters 
                                      for CFD realm
<P>
 <LI>  CPL_md_get                 (md)    returns coupler internal parameters 
                                      for MD realm
<P>
 <LI>  CPL_md_get_save_period     (md)    auxiliary used for testing
<P>
 <LI>  CPL_md_get_average_period  (md)    returns average period of BC
<P>
 <LI>  CPL_md_get_md_per_cfd_dt   (md) 	returns the number of step MD does for 
                                      each CFD step
<P>
 <LI>  CPL_md_get_nsteps          (md)    returm CFD nsteps  
<P>
 <LI>  CPL_md_get_dt_cfd          (md)    returns MD dt
<P>
 <LI>  CPL_md_set                 (md)    sets zL if CFD is 2D
<P>
 <LI>  CPL_md_get_density         (md)    gets CFD density
<P>
 <LI>  CPL_md_get_cfd_id          (md)    id for CFD code, possible values set 
                                      in coupler_parameters
<P>
 </UL>
<P>
<STRONG>Author:</STRONG> Lucian Anton, November 2011, Edward Smith, Dave Trevelyan September 2012
<P>
<STRONG>See also:</STRONG> module <A HREF="coupler_module.html">coupler_module</A>, module <A HREF="coupler_internal_cfd.html">coupler_internal_cfd</A>, module <A HREF="coupler_internal_md.html">coupler_internal_md</A>, module <A HREF="coupler_parameters.html">coupler_parameters</A>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_cpl_send"><H3>CPL_send</H3></A>
<PRE>public interface CPL_send
    module procedure <A HREF="#subroutine_cpl_send_3d">CPL_send_3d</A>
    module procedure <A HREF="#subroutine_cpl_send_4d">CPL_send_4d</A>
end interface CPL_send
</PRE>
<A NAME="interface_cpl_recv"><H3>CPL_recv</H3></A>
<PRE>public interface CPL_recv
    module procedure <A HREF="#subroutine_cpl_recv_3d">CPL_recv_3d</A>
    module procedure <A HREF="#subroutine_cpl_recv_4d">CPL_recv_4d</A>
end interface CPL_recv
</PRE>
<A NAME="interface_coupler_send_data"><H3>coupler_send_data</H3></A>
<PRE>public interface coupler_send_data
    module procedure <A HREF="#subroutine_coupler_send_data_3d">coupler_send_data_3d</A>
    module procedure <A HREF="#subroutine_coupler_send_data_4d">coupler_send_data_4d</A>
end interface coupler_send_data
</PRE>
<A NAME="interface_coupler_recv_data"><H3>coupler_recv_data</H3></A>
<PRE>public interface coupler_recv_data
    module procedure <A HREF="#subroutine_coupler_recv_data_3d">coupler_recv_data_3d</A>
    module procedure <A HREF="#subroutine_coupler_recv_data_4d">coupler_recv_data_4d</A>
end interface coupler_recv_data
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_cpl_create_comm"><H3>CPL_create_comm</H3></A>
<PRE>public subroutine CPL_create_comm (callingrealm, RETURNED_REALM_COMM, ierror)
    integer, intent(in) :: callingrealm
    integer, intent(out) :: RETURNED_REALM_COMM
    integer, intent(out) :: ierror
    ! Calls: MPI_comm_rank, MPI_comm_size, create_comm, test_realms
end subroutine CPL_create_comm
</PRE>
 (cfd+md) Splits MPI_COMM_WORLD in both the CFD and MD code respectively
 		   and create intercommunicator between CFD and MD
<A NAME="subroutine_cpl_create_map"><H3>CPL_create_map</H3></A>
<PRE>public subroutine CPL_create_map ()
    ! Calls: CPL_overlap_topology, check_config_feasibility, get_md_cell_ranges, get_overlap_blocks, prepare_overlap_comms
end subroutine CPL_create_map
</PRE>
 Establish for all MD processors the mapping (if any) 
 to coupled CFD processors
<A NAME="subroutine_cpl_cfd_adjust_domain"><H3>CPL_cfd_adjust_domain</H3></A>
<PRE>public subroutine CPL_cfd_adjust_domain (xL, yL, zL, nx, ny, nz, density_cfd)
    real (kind=kind (0.d0)), optional, intent(inout) :: xL
    real (kind=kind (0.d0)), optional, intent(inout) :: yL
    real (kind=kind (0.d0)), optional, intent(inout) :: zL
    integer, optional, intent(inout) :: nx
    integer, optional, intent(inout) :: ny
    integer, optional, intent(inout) :: nz
    real (kind=kind (0.d0)), optional, intent(inout) :: density_cfd
    ! Calls: MPI_Abort, init_length, test_cfd_cell_sizes
end subroutine CPL_cfd_adjust_domain
</PRE>
<A NAME="subroutine_cpl_gather"><H3>CPL_gather</H3></A>
<PRE>public subroutine CPL_gather (gatherarray, npercell, limits, recvarray)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: gatherarray
    integer, intent(in) :: npercell
    integer, intent(in), dimension (6) :: limits
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(inout) :: recvarray
    ! Calls: MPI_gatherv, deallocate_gather_u, pack_sendbuf, prepare_gatherv_parameters, unpack_recvbuf
end subroutine CPL_gather
</PRE>
<A NAME="subroutine_cpl_scatter"><H3>CPL_scatter</H3></A>
<PRE>public subroutine CPL_scatter (scatterarray, npercell, limits, recvarray)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: scatterarray
    integer, intent(in) :: npercell
    integer, intent(in), dimension (6) :: limits
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(inout) :: recvarray
    ! Calls: MPI_scatterv, deallocate_scatter_s, pack_scatterbuf, prepare_scatterv_parameters, unpack_scatterbuf
end subroutine CPL_scatter
</PRE>
<A NAME="subroutine_cpl_send_3d"><H3>CPL_send_3d</H3></A>
<PRE>private subroutine CPL_send_3d (temp, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    real (kind=kind (0.d0)), dimension(:,:,:), intent(in) :: temp
    integer, optional, intent(in) :: icmin_send
    integer, optional, intent(in) :: icmax_send
    integer, optional, intent(in) :: jcmin_send
    integer, optional, intent(in) :: jcmax_send
    integer, optional, intent(in) :: kcmin_send
    integer, optional, intent(in) :: kcmax_send
    logical, optional, intent(out) :: send_flag
    ! Calls: CPL_send_xd, error_abort
end subroutine CPL_send_3d
</PRE>
 CPL_send_data wrapper for 3d arrays
 see CPL_send_xd for input description
<P>
<STRONG>See also:</STRONG> <A HREF="coupler.html#subroutine_cpl_send_xd">subroutine_CPL_send_xd</A> in module <A HREF="coupler.html">coupler</A>
<A NAME="subroutine_cpl_send_4d"><H3>CPL_send_4d</H3></A>
<PRE>private subroutine CPL_send_4d (asend, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: asend
    integer, optional, intent(in) :: icmin_send
    integer, optional, intent(in) :: icmax_send
    integer, optional, intent(in) :: jcmin_send
    integer, optional, intent(in) :: jcmax_send
    integer, optional, intent(in) :: kcmin_send
    integer, optional, intent(in) :: kcmax_send
    logical, optional, intent(out) :: send_flag
    ! Calls: CPL_send_xd, error_abort
end subroutine CPL_send_4d
</PRE>
 CPL_send_data wrapper for 4d arrays
 see CPL_send_xd for input description
<P>
<STRONG>See also:</STRONG> <A HREF="coupler.html#subroutine_cpl_send_xd">subroutine_CPL_send_xd</A> in module <A HREF="coupler.html">coupler</A>
<A NAME="subroutine_cpl_send_xd"><H3>CPL_send_xd</H3></A>
<PRE>private subroutine CPL_send_xd (asend, icmin_send, icmax_send, jcmin_send, jcmax_send, kcmin_send, kcmax_send, send_flag)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: asend
    integer, intent(in) :: icmin_send
    integer, intent(in) :: icmax_send
    integer, intent(in) :: jcmin_send
    integer, intent(in) :: jcmax_send
    integer, intent(in) :: kcmin_send
    integer, intent(in) :: kcmax_send
    logical, optional, intent(out) :: send_flag
    ! Calls: CPL_Cart_coords, CPL_proc_extents, CPL_proc_portion, MPI_Graph_neighbors, MPI_Graph_neighbors_count, MPI_send
end subroutine CPL_send_xd
</PRE>
 Send data from the local grid to the associated ranks from the other 
 realm
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  CPL_send_xd(asend,icmin_send,icmax_send,jcmin_send,  
  </UL>
 </UL>
						     jcmax_send,kcmin_send,kcmax_send,send_flag)
<P>
 <UL>
 <LI>  Input Parameters
<P>
   <UL>
   <LI>  asend
<P>
   <LI>  jcmax_recv
<P>
   <LI>  jcmin_recv
<P>
   </UL>
 <LI>  Output Parameter
<P>
   <UL>
   <LI>  send_flag
<P>
   </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_cpl_recv_3d"><H3>CPL_recv_3d</H3></A>
<PRE>private subroutine CPL_recv_3d (temp, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    real (kind=kind (0.d0)), dimension(:,:,:), intent(inout) :: temp
    integer, optional, intent(in) :: icmin_recv
    integer, optional, intent(in) :: icmax_recv
    integer, optional, intent(in) :: jcmin_recv
    integer, optional, intent(in) :: jcmax_recv
    integer, optional, intent(in) :: kcmin_recv
    integer, optional, intent(in) :: kcmax_recv
    logical, optional, intent(out) :: recv_flag
    ! Calls: CPL_recv_xd, error_abort
end subroutine CPL_recv_3d
</PRE>
 CPL_recv_xd wrapper for 3d arrays
 see CPL_recv_xd for input description
<P>
<STRONG>See also:</STRONG> <A HREF="coupler.html#subroutine_cpl_recv_xd">subroutine_CPL_recv_xd</A> in module <A HREF="coupler.html">coupler</A>
<A NAME="subroutine_cpl_recv_4d"><H3>CPL_recv_4d</H3></A>
<PRE>private subroutine CPL_recv_4d (arecv, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(out) :: arecv
    integer, optional, intent(in) :: icmin_recv
    integer, optional, intent(in) :: icmax_recv
    integer, optional, intent(in) :: jcmin_recv
    integer, optional, intent(in) :: jcmax_recv
    integer, optional, intent(in) :: kcmin_recv
    integer, optional, intent(in) :: kcmax_recv
    logical, optional, intent(out) :: recv_flag
    ! Calls: CPL_recv_xd, error_abort
end subroutine CPL_recv_4d
</PRE>
 CPL_recv_xd  wrapper for 4d arrays
 See CPL_recv_xd for input description
<P>
<STRONG>See also:</STRONG> <A HREF="coupler.html#subroutine_cpl_recv_xd">subroutine_CPL_recv_xd</A> in module <A HREF="coupler.html">coupler</A>
<A NAME="subroutine_cpl_recv_xd"><H3>CPL_recv_xd</H3></A>
<PRE>private subroutine CPL_recv_xd (arecv, icmin_recv, icmax_recv, jcmin_recv, jcmax_recv, kcmin_recv, kcmax_recv, recv_flag)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(inout) :: arecv
    integer, intent(in) :: icmin_recv
    integer, intent(in) :: icmax_recv
    integer, intent(in) :: jcmin_recv
    integer, intent(in) :: jcmax_recv
    integer, intent(in) :: kcmin_recv
    integer, intent(in) :: kcmax_recv
    logical, optional, intent(out) :: recv_flag
    ! Calls: CPL_Cart_coords, CPL_proc_extents, CPL_proc_portion, MPI_Graph_neighbors, MPI_Graph_neighbors_count, MPI_irecv, MPI_waitall
end subroutine CPL_recv_xd
</PRE>
 Receive data from to local grid from the associated ranks from the other 
 realm
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  CPL_recv_xdarecv,icmin_recv,icmax_recv,jcmin_recv,  
  </UL>
 </UL>
						     jcmax_recv,kcmin_recv,kcmax_recv,recv_flag)
<P>
 <UL>
 <LI>  Input Parameters
<P>
   <UL>
   <LI>  arecv
<P>
   <LI>  jcmax_recv
<P>
   <LI>  jcmin_recv
<P>
   <LI>  index_transpose
<P>
   </UL>
 <LI>  Output Parameter
<P>
   <UL>
   <LI>  recv_flag
<P>
   </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_cpl_rank_map"><H3>CPL_rank_map</H3></A>
<PRE>public subroutine CPL_rank_map (COMM, rank, nproc, comm2world, world2comm, ierr)
    integer, intent(in) :: COMM
    integer, intent(out) :: rank
    integer, intent(out) :: nproc
    integer, dimension(:), allocatable, intent(out) :: comm2world
    integer, dimension(:), allocatable, intent(out) :: world2comm
    integer, intent(out) :: ierr
    ! Calls: MPI_allgather, MPI_comm_rank, MPI_comm_size
end subroutine CPL_rank_map
</PRE>
<A NAME="subroutine_cpl_pack"><H3>CPL_pack</H3></A>
<PRE>public subroutine CPL_pack (unpacked, packed, realm, icmax_pack, icmin_pack, jcmax_pack, jcmin_pack, kcmax_pack, kcmin_pack)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: unpacked
    real (kind=kind (0.d0)), dimension(:), allocatable, intent(out) :: packed
    integer, intent(in) :: realm
    integer, optional, intent(in) :: icmax_pack
    integer, optional, intent(in) :: icmin_pack
    integer, optional, intent(in) :: jcmax_pack
    integer, optional, intent(in) :: jcmin_pack
    integer, optional, intent(in) :: kcmax_pack
    integer, optional, intent(in) :: kcmin_pack
    ! Calls: CPL_Cart_coords, CPL_olap_extents, MPI_Graph_neighbors, MPI_Graph_neighbors_count, error_abort
end subroutine CPL_pack
</PRE>
<A NAME="subroutine_cpl_unpack"><H3>CPL_unpack</H3></A>
<PRE>public subroutine CPL_unpack (packed, unpacked, realm)
    real (kind=kind (0.d0)), dimension(:), allocatable, intent(inout) :: packed
    real (kind=kind (0.d0)), dimension(:,:,:,:), allocatable, intent(out) :: unpacked
    integer, intent(in) :: realm
    ! Calls: CPL_Cart_coords, CPL_proc_extents, MPI_Graph_neighbors, MPI_Graph_neighbors_count
end subroutine CPL_unpack
</PRE>
<A NAME="subroutine_cpl_proc_extents"><H3>CPL_proc_extents</H3></A>
<PRE>public subroutine CPL_proc_extents (coord, realm, extents, ncells)
    integer, intent(in), dimension (3) :: coord
    integer, intent(in) :: realm
    integer, intent(out), dimension (6) :: extents
    integer, optional, intent(out) :: ncells
    ! Calls: error_abort
end subroutine CPL_proc_extents
</PRE>
<A NAME="subroutine_cpl_olap_extents"><H3>CPL_olap_extents</H3></A>
<PRE>public subroutine CPL_olap_extents (coord, realm, extents, ncells)
    integer, intent(in), dimension (3) :: coord
    integer, intent(in) :: realm
    integer, intent(out), dimension (6) :: extents
    integer, optional, intent(out) :: ncells
    ! Calls: error_abort
end subroutine CPL_olap_extents
</PRE>
 Get maximum and minimum cells for current communicator within
 the overlapping region only
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  CPL_olap_extents(coord,realm,extents,ncells)
<P>
  </UL>
 <LI>  Input
<P>
  <UL>
  <LI>  coord
   <UL>
   <LI>  processor cartesian coordinate (3 x integer) 
   </UL>
  <LI>  realm
   <UL>
   <LI>  cfd_realm (1) or md_realm (2) (integer) 
<P>
   </UL>
  </UL>
 <LI>  Output
  <UL>
  <LI>  extents
   <UL>
   <LI>  Six components array which defines processor extents within
     the overlap region only xmin,xmax,ymin,ymax,zmin,zmax (6 x integer) 
   </UL>
  <LI>  ncells (optional)
   <UL>
   <LI>  number of cells on processor (integer)
   </UL>
  </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> David Trevelyan
<A NAME="subroutine_cpl_proc_portion"><H3>CPL_proc_portion</H3></A>
<PRE>public subroutine CPL_proc_portion (coord, realm, limits, portion, ncells)
    integer, intent(in), dimension (3) :: coord
    integer, intent(in) :: realm
    integer, intent(in), dimension (6) :: limits
    integer, intent(out), dimension (6) :: portion
    integer, optional, intent(out) :: ncells
    ! Calls: CPL_proc_extents
end subroutine CPL_proc_portion
</PRE>
<A NAME="subroutine_cpl_cart_coords"><H3>CPL_Cart_coords</H3></A>
<PRE>public subroutine CPL_Cart_coords (COMM, rank, realm, maxdims, coords, ierr)
    integer, intent(in) :: COMM
    integer, intent(in) :: rank
    integer, intent(in) :: realm
    integer, intent(in) :: maxdims
    integer, intent(out), dimension (maxdims) :: coords
    integer, intent(out) :: ierr
    ! Calls: error_abort
end subroutine CPL_Cart_coords
</PRE>
 Determines process coords in appropriate realm's cartesian topology 
 given a rank in any communicator
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  CPL_Cart_coords(COMM, rank, realm, maxdims, coords, ierr)
<P>
  </UL>
 <LI>  Input Parameters
<P>
  <UL>
  <LI>  comm
   <UL>
   <LI>  communicator with cartesian structure (handle) 
<P>
   </UL>
  <LI>  realm
   <UL>
   <LI>  cfd_realm (1) or md_realm (2) (integer) 
<P>
   </UL>
  <LI>  rank
   <UL>
   <LI>  rank of a process within group of comm (integer) 
      NOTE fortran convention rank=1 to nproc
<P>
   </UL>
  <LI>  maxdims
   <UL>
   <LI>  length of vector coords in the calling program (integer) 
<P>
   </UL>
  </UL>
 <LI>  Output Parameter
<P>
  <UL>
  <LI>  coords
   <UL>
   <LI>  integer array (of size ndims) containing the Cartesian coordinates 
     of specified process (integer) 
<P>
   </UL>
  <LI>  ierr
   <UL>
   <LI>  error flag
   </UL>
  </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_coupler_send_data_3d"><H3>coupler_send_data_3d</H3></A>
<PRE>private subroutine coupler_send_data_3d (temp, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    real (kind=kind (0.d0)), dimension(:,:,:), intent(in) :: temp
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: asend_lbound
    integer, optional, intent(in), dimension (3) :: asend_grid_start
    integer, optional, intent(in), dimension (3) :: asend_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in), dimension (3) :: use_overlap_box
    ! Calls: coupler_send_data_xd
end subroutine coupler_send_data_3d
</PRE>
<A NAME="subroutine_coupler_send_data_4d"><H3>coupler_send_data_4d</H3></A>
<PRE>private subroutine coupler_send_data_4d (asend, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: asend
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: asend_lbound
    integer, optional, intent(in), dimension (3) :: asend_grid_start
    integer, optional, intent(in), dimension (3) :: asend_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in), dimension (3) :: use_overlap_box
    ! Calls: coupler_send_data_xd
end subroutine coupler_send_data_4d
</PRE>
<A NAME="subroutine_coupler_send_data_xd"><H3>coupler_send_data_xd</H3></A>
<PRE>private subroutine coupler_send_data_xd (asend, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, use_overlap_box)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(in) :: asend
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: asend_lbound
    integer, optional, intent(in), dimension (3) :: asend_grid_start
    integer, optional, intent(in), dimension (3) :: asend_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in), dimension (3) :: use_overlap_box
    ! Calls: MPI_Abort, MPI_send
end subroutine coupler_send_data_xd
</PRE>
<A NAME="subroutine_coupler_recv_data_3d"><H3>coupler_recv_data_3d</H3></A>
<PRE>private subroutine coupler_recv_data_3d (temp, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, accumulate, pbc)
    real (kind=kind (0.d0)), dimension(:,:,:), intent(inout) :: temp
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: asend_lbound
    integer, optional, intent(in), dimension (3) :: asend_grid_start
    integer, optional, intent(in), dimension (3) :: asend_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in) :: accumulate
    integer, optional, intent(in) :: pbc
    ! Calls: coupler_recv_data_xd
end subroutine coupler_recv_data_3d
</PRE>
<A NAME="subroutine_coupler_recv_data_4d"><H3>coupler_recv_data_4d</H3></A>
<PRE>private subroutine coupler_recv_data_4d (arecv, index_transpose, asend_lbound, asend_grid_start, asend_grid_end, glower, gupper, accumulate, pbc)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(inout) :: arecv
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: asend_lbound
    integer, optional, intent(in), dimension (3) :: asend_grid_start
    integer, optional, intent(in), dimension (3) :: asend_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in) :: accumulate
    integer, optional, intent(in) :: pbc
    ! Calls: coupler_recv_data_xd
end subroutine coupler_recv_data_4d
</PRE>
<A NAME="subroutine_coupler_recv_data_xd"><H3>coupler_recv_data_xd</H3></A>
<PRE>private subroutine coupler_recv_data_xd (arecv, index_transpose, a_lbound, a_grid_start, a_grid_end, glower, gupper, accumulate, pbc)
    real (kind=kind (0.d0)), dimension(:,:,:,:), intent(inout) :: arecv
    integer, optional, intent(in), dimension (3) :: index_transpose
    integer, optional, intent(in), dimension (3) :: a_lbound
    integer, optional, intent(in), dimension (3) :: a_grid_start
    integer, optional, intent(in), dimension (3) :: a_grid_end
    integer, optional, intent(in), dimension (3) :: glower
    integer, optional, intent(in), dimension (3) :: gupper
    logical, optional, intent(in) :: accumulate
    integer, optional, intent(in) :: pbc
    ! Calls: MPI_Abort, MPI_irecv, MPI_waitall, halos
end subroutine coupler_recv_data_xd
</PRE>
<A NAME="subroutine_coupler_cfd_get"><H3>coupler_cfd_get</H3></A>
<PRE>public subroutine coupler_cfd_get (jcmax_overlap, jcmin)
    integer, optional, intent(out) :: jcmax_overlap
    integer, optional, intent(out) :: jcmin
end subroutine coupler_cfd_get
</PRE>
<A NAME="subroutine_coupler_md_get"><H3>coupler_md_get</H3></A>
<PRE>public subroutine coupler_md_get (xL_md, yL_md, zL_md, MD_initial_cellsize, top_dy, overlap_with_top_cfd)
    real (kind=kind (0.d0)), optional, intent(out) :: xL_md
    real (kind=kind (0.d0)), optional, intent(out) :: yL_md
    real (kind=kind (0.d0)), optional, intent(out) :: zL_md
    real (kind=kind (0.d0)), optional, intent(out) :: MD_initial_cellsize
    real (kind=kind (0.d0)), optional, intent(out) :: top_dy
    logical, optional, intent(out) :: overlap_with_top_cfd
end subroutine coupler_md_get
</PRE>
<A NAME="function_coupler_md_get_save_period"><H3>coupler_md_get_save_period</H3></A>
<PRE>public function coupler_md_get_save_period () result (p)
    integer :: p
end function coupler_md_get_save_period
</PRE>
<A NAME="function_coupler_md_get_average_period"><H3>coupler_md_get_average_period</H3></A>
<PRE>public function coupler_md_get_average_period () result (p)
    integer :: p
end function coupler_md_get_average_period
</PRE>
<A NAME="function_coupler_md_get_md_steps_per_cfd_dt"><H3>coupler_md_get_md_steps_per_cfd_dt</H3></A>
<PRE>public function coupler_md_get_md_steps_per_cfd_dt () result (p)
    integer :: p
end function coupler_md_get_md_steps_per_cfd_dt
</PRE>
<A NAME="function_coupler_md_get_nsteps"><H3>coupler_md_get_nsteps</H3></A>
<PRE>public function coupler_md_get_nsteps () result (n)
    integer :: n
end function coupler_md_get_nsteps
</PRE>
<A NAME="function_coupler_md_get_dt_cfd"><H3>coupler_md_get_dt_cfd</H3></A>
<PRE>public function coupler_md_get_dt_cfd () result (t)
    real (kind=kind (0.d0)) :: t
end function coupler_md_get_dt_cfd
</PRE>
<A NAME="function_coupler_md_get_density"><H3>coupler_md_get_density</H3></A>
<PRE>public function coupler_md_get_density () result (r)
    real (kind=kind (0.d0)) :: r
end function coupler_md_get_density
</PRE>
<A NAME="function_coupler_md_get_cfd_id"><H3>coupler_md_get_cfd_id</H3></A>
<PRE>public function coupler_md_get_cfd_id () result (r)
    integer :: r
end function coupler_md_get_cfd_id
</PRE>
</HTML>
