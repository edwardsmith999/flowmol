LAMMPS (1 Feb 2014)
# 2d SRD test: big + small particles

units		lj
atom_style	sphere
atom_modify	first big
dimension	2

# create big particles with sigma 1.0

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		box block 0 10 0 10 -0.5 0.5
create_box	2 box
Created orthogonal box = (0 0 -0.790569) to (15.8114 15.8114 0.790569)
  2 by 2 by 1 MPI processor grid
create_atoms	1 region box
Created 100 atoms
set		type 1 mass 1.0
  100 settings made for mass
set		type 1 diameter 1.0
  100 settings made for diameter

group		big type 1
100 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big nve
fix		2 all enforce2d

run		1000
Memory usage per processor = 2.74724 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         1.44     -0.54272            0      0.88288    -0.041088 
    1000    1.8791467  -0.97185784            0    0.8884974   0.61487657 
Loop time of 0.0147891 on 4 procs for 1000 steps with 100 atoms

Pair  time (%) = 0.00214434 (14.4994)
Neigh time (%) = 0.000745177 (5.03869)
Comm  time (%) = 0.00851029 (57.5443)
Outpt time (%) = 2.07424e-05 (0.140255)
Other time (%) = 0.00336856 (22.7773)

Nlocal:    25 ave 26 max 23 min
Histogram: 1 0 0 0 0 0 1 0 0 2
Nghost:    47 ave 48 max 46 min
Histogram: 1 0 0 0 0 2 0 0 0 1
Neighs:    114.75 ave 124 max 100 min
Histogram: 1 0 0 0 0 1 0 0 0 2

Total # of neighbors = 459
Ave neighs/atom = 4.59
Neighbor list builds = 129
Dangerous builds = 0

unfix		1
unfix		2

# add small particles as hi density lattice

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 21316 atoms
set		type 2 mass 0.01
  21316 settings made for mass
set		type 2 diameter 0.0
  21316 settings made for diameter

group		small type 2
21316 atoms in group small

velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 6700 atoms, new total = 14716

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones

timestep	0.001

fix		1 big nve
fix	        2 small srd 20 big 1.0 0.25 49894 		  radius 0.88 search 0.2 collision slip
fix		3 all enforce2d

# diagnostics

compute		tbig big temp
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[7] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[8] f_2[9] f_2[10]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (../thermo.cpp:439)
thermo		100

#dump		1 all atom 250 dump.srd.mixture

#dump		2 all image 250 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 4 adiam 1 1 adiam 2 0.2

#dump		3 all movie 250 movie.mpg type type zoom 1.6
#dump_modify	3 pad 4 adiam 1 1 adiam 2 0.2

run		5000
SRD info:
  SRD/big particles = 14616 100
  big particle diameter max/min = 0.88 0.88
  SRD temperature & lamda = 1 0.2
  SRD max distance & max velocity = 0.8 40
  SRD grid counts: 63 63 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250974 0.250974 1.58114
  SRD per actual grid cell = 4.86648
  SRD viscosity = 0.463448
  big/SRD mass density ratio = 2.12808
WARNING: Fix srd grid size > 1/4 of big particle diameter (../fix_srd.cpp:2875)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 13.2944 24.262
  ave/max big velocity = 1.69284 5.10989
Memory usage per processor = 6.52001 Mbytes
Step Temp 2[7] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[8] 2[9] 2[10] 
       0    1.8791467            0 0.0060376284  -0.97185784    0.8884974   0.61487657            0            0            0            0            0            0            0            0            0 
     100    1.4044369         3969 0.0030633087  -0.93959598   0.45079651   0.78900114         7464           99           99            0           17        22500         3005     1.028131            0 
     200    1.1569395         3969 0.0010544039  -0.99020406   0.15516608   0.50132859         7393           82           82            0           43        22500         2996     1.014347            0 
     300    1.0082066         3969 1.5754289e-06  -0.99789266 0.00023184012   0.36859357         7443           90           90            0           82        22500         3003    1.0238037            0 
     400    1.1459472         3969 0.0010570023  -0.97893929   0.15554845   0.47616067         7327           81           81            0          104        22500         2993    1.0108719            0 
     500    1.0836955         3969 0.00072569678    -0.966065   0.10679354   0.49205907         7447           89           89            0          133        22500         2982    1.0221211            0 
     600   0.95868561         3969 -0.00031108604  -0.99487817 -0.045779421    0.3676888         7488           90           90            0          162        22500         2994   0.99760594            0 
     700   0.98121671         3969 -0.00022225428   -1.0041115  -0.03270694    0.3605398         7393           80           80            0          209        22500         2992    1.0032861            0 
     800    1.0870893         3969 0.00028589178   -1.0341466  0.042071834    0.3576364         7506           96           96            0          241        22500         3004    1.0173044            0 
     900     1.087553         3969 8.795578e-05   -1.0637339  0.012943573   0.28026879         7405           82           82            0          276        22500         2999    1.0082354            0 
    1000    1.0160539         3969 7.5618714e-05  -0.99476531   0.01112805   0.60009776         7334           88           88            0          312        22500         2998     1.020285            0 
    1100   0.94619807         3969 -0.00084794884   -1.0615202  -0.12478415   0.36153566         7565           89           89            0          338        22500         3009    1.0274592            0 
    1200    1.2187057         3969 0.00079088888   -1.0901314   0.11638721   0.34195358         7558           94           94            0          375        22500         2987    1.0120179            0 
    1300    1.0297116         3969 -6.2029069e-05   -1.0285427 -0.0091281978   0.44490154         7365           76           76            0          398        22500         2983    1.0132722            0 
    1400    1.0723726         3969 3.8902675e-05    -1.055924 0.0057249176   0.40617642         7524           90           90            0          439        22500         3009    1.0114417            0 
    1500    1.0661279         3969 -0.00010841884   -1.0714216 -0.015954917   0.49701435         7285           69           69            0          470        22500         2997    1.0209628            0 
    1600    1.2175256         3969 0.00087968156   -1.0758964   0.12945394   0.64512981         7286           89           89            0          510        22500         3007    1.0143888            0 
    1700    1.1985014         3969 0.0014648642    -0.970947   0.21556942    1.0479949         7228           85           85            0          537        22500         2983    1.0107134            0 
    1800    1.2075839         3969 0.00072247447   -1.0891887   0.10631934   0.57872746         7449           87           87            0          561        22500         2992     1.011785            0 
    1900    1.2255534         3969 0.00088656095   -1.0828315   0.13046631   0.65685308         7385           76           76            0          581        22500         3003   0.99158619            0 
    2000     1.291624         3969 0.0012489132   -1.0949177   0.18379006   0.54486534         7460           88           88            0          609        22500         2985    1.0084802            0 
    2100    1.1111637         3969 8.680692e-05   -1.0872776  0.012774506   0.54623825         7399           79           79            0          652        22500         2974   0.99115959            0 
    2200    1.1101509         3969 -0.00019790624   -1.1281733 -0.029123882   0.36938914         7394           80           80            0          687        22500         3009    1.0098928            0 
    2300   0.99008142         3969 -0.0010221939   -1.1306067  -0.15042605   0.49715741         7403           77           77            0          707        22500         2997   0.99398166            0 
    2400    1.1298599         3969 -0.00028442155   -1.1604168 -0.041855476   0.62622034         7213           99           99            0          739        22500         2981    1.0151717            0 
    2500   0.96755195         3969 -0.0013882655   -1.1621736  -0.20429715   0.53854953         7302           91           91            0          762        22500         2981    1.0095159            0 
    2600   0.92289325         3969 -0.0018295583   -1.1829021   -0.2692378   0.48117908         7387          114          114            0          796        22500         2984   0.99596772            0 
    2700    1.0556828         3969 -0.0010119543   -1.1940452  -0.14891919   0.38438637         7379           77           77            0          821        22500         2990    0.9995489            0 
    2800   0.96725457         3969 -0.0014988251   -1.1781491   -0.2205671   0.45335869         7311           77           77            0          850        22500         3000    1.0021877            0 
    2900    1.0133684         3969 -0.0012783239   -1.1913529  -0.18811815   0.47922787         7445           91           91            0          871        22500         3012    1.0157316            0 
    3000   0.97710883         3969 -0.0011590153   -1.1378984  -0.17056069   0.64470243         7454           90           90            0          907        22500         2982   0.99909177            0 
    3100   0.85234697         3969 -0.002077265   -1.1495138  -0.30569031   0.55071072         7386           95           95            0          935        22500         2963    1.0015568            0 
    3200     1.052911         3969 -0.00084248304   -1.1663617   -0.1239798   0.49920749         7410           84           84            0          962        22500         3023    1.0268965            0 
    3300    1.1427076         3969 0.00052348324   -1.0542447  0.077035793   0.97657677         7268           70           70            0          999        22500         2991    1.0309378            0 
    3400    1.1749571         3969 -0.00049301879   -1.2357602 -0.072552645    0.2551001         7443           77           77            0         1024        22500         2992    1.0153988            0 
    3500   0.99448585         3969 -0.0015705474   -1.2156628  -0.23112176   0.31069295         7502           97           97            0         1051        22500         2999    1.0325626            0 
    3600    1.0615674         3969 -0.00088670873   -1.1814398  -0.13048806   0.42774035         7386           70           70            0         1075        22500         3015    1.0004252            0 
    3700   0.92549328         3969 -0.0018599812   -1.1899532  -0.27371483   0.36471531         7459           81           81            0         1106        22500         3009    1.0256903            0 
    3800   0.85987993         3969 -0.0018189231   -1.1189538  -0.26767272   0.42802928         7232           75           75            0         1134        22500         2973    1.0167911            0 
    3900   0.92111833         3969 -0.0011824977   -1.0859235  -0.17401636   0.73992354         7351           80           80            0         1165        22500         3024    1.0274158            0 
    4000   0.91817371         3969 -0.0014469814   -1.1219298  -0.21293778   0.64725317         7478           86           86            0         1195        22500         3003    1.0213446            0 
    4100    1.0607641         3969 -0.00061451533   -1.1405885 -0.090432076   0.54575249         7474           87           87            0         1222        22500         3005    1.0432431            0 
    4200    1.1112883         3969 0.00012926229   -1.0811532  0.019022238   0.71771029         7527           67           67            0         1261        22500         2995    1.0263853            0 
    4300    1.3096702         3969 0.00060322354   -1.2078031  0.088770376   0.31006723         7617           88           88            0         1298        22500         2997    1.0462257            0 
    4400    1.2076765         3969  0.001009301    -1.047071   0.14852873   0.83105522         7355           97           97            0         1333        22500         2972    1.0438217            0 
    4500   0.94049473         3969 -0.0011505342   -1.1004024  -0.16931262   0.46258624         7403           78           78            0         1360        22500         3004    1.0378682            0 
    4600    0.8241741         3969 -0.0025714658   -1.1943493  -0.37841691  0.010193689         7604           99           99            0         1393        22500         3031    1.0288913            0 
    4700   0.98678642         3969 -0.0011664864   -1.1485787  -0.17166013   0.16963181         7691           94           94            0         1421        22500         3008    1.0074925            0 
    4800   0.97602307         3969 -0.0010910984   -1.1268289  -0.16056604   0.24433738         7547           85           85            0         1453        22500         2991    1.0124834            0 
    4900    1.0427787         3969 -0.00050976935   -1.1073686 -0.075017657   0.30774039         7563           85           85            0         1494        22500         2994    1.0235529            0 
    5000    1.3048873         3969 0.0015736036   -1.0602669   0.23157151   0.49881308         7529          104          104            0         1524        22500         2984    1.0094313            0 
Loop time of 0.868197 on 4 procs for 5000 steps with 14716 atoms

Pair  time (%) = 0.0116689 (1.34403)
Neigh time (%) = 0.0541446 (6.23644)
Comm  time (%) = 0.0662674 (7.63276)
Outpt time (%) = 0.00228554 (0.263251)
Other time (%) = 0.733831 (84.5235)

Nlocal:    3679 ave 4052 max 3370 min
Histogram: 1 0 0 1 1 0 0 0 0 1
Nghost:    49 ave 53 max 42 min
Histogram: 1 0 0 0 0 0 0 1 1 1
Neighs:    120.5 ave 162 max 85 min
Histogram: 1 0 0 1 0 1 0 0 0 1

Total # of neighbors = 482
Ave neighs/atom = 0.0327535
Neighbor list builds = 250
Dangerous builds = 0

Please see the log.cite file for references relevant to this simulation

