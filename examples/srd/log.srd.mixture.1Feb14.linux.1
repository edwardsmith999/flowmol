LAMMPS (1 Feb 2014)
# 2d SRD test: big + small particles

units		lj
atom_style	sphere
atom_modify	first big
dimension	2

# create big particles with sigma 1.0

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		box block 0 10 0 10 -0.5 0.5
create_box	2 box
Created orthogonal box = (0 0 -0.790569) to (15.8114 15.8114 0.790569)
  1 by 1 by 1 MPI processor grid
create_atoms	1 region box
Created 100 atoms
set		type 1 mass 1.0
  100 settings made for mass
set		type 1 diameter 1.0
  100 settings made for diameter

group		big type 1
100 atoms in group big
velocity	big create 1.44 87287 loop geom

# equilibrate big particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

fix		1 big nve
fix		2 all enforce2d

run		1000
Memory usage per processor = 2.74778 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0         1.44     -0.54272            0      0.88288    -0.041088 
    1000    1.8791467  -0.97185784            0    0.8884974   0.61487656 
Loop time of 0.0157461 on 1 procs for 1000 steps with 100 atoms

Pair  time (%) = 0.00811386 (51.5293)
Neigh time (%) = 0.00263572 (16.7388)
Comm  time (%) = 0.00207138 (13.1549)
Outpt time (%) = 7.86781e-06 (0.0499667)
Other time (%) = 0.00291729 (18.527)

Nlocal:    100 ave 100 max 100 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    88 ave 88 max 88 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    459 ave 459 max 459 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 459
Ave neighs/atom = 4.59
Neighbor list builds = 129
Dangerous builds = 0

unfix		1
unfix		2

# add small particles as hi density lattice

lattice		sq 0.4
Lattice spacing in x,y,z = 1.58114 1.58114 1.58114
region		plane block 0 10 0 10 -0.001 0.001
lattice		sq 85.0
Lattice spacing in x,y,z = 0.108465 0.108465 0.108465
create_atoms	2 region plane
Created 21316 atoms
set		type 2 mass 0.01
  21316 settings made for mass
set		type 2 diameter 0.0
  21316 settings made for diameter

group		small type 2
21316 atoms in group small

velocity	small create 1.0 593849 loop geom

# delete overlaps
# must set 1-2 cutoff to non-zero value

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.5

delete_atoms	overlap 0.5 small big
Deleted 6700 atoms, new total = 14716

# SRD run

reset_timestep	0

neighbor	0.3 bin
neigh_modify	delay 0 every 1 check yes

communicate	multi group big vel yes
neigh_modify	include big

# no pairwise interactions with small particles

pair_style	lj/cut 2.5
pair_coeff	1 1 1.0 1.0
pair_coeff	2 2 0.0 1.0 0.0
pair_coeff	1 2 0.0 1.0 0.0

# use fix SRD to push small particles out from inside big ones

timestep	0.001

fix		1 big nve
fix	        2 small srd 20 big 1.0 0.25 49894 		  radius 0.88 search 0.2 collision slip
fix		3 all enforce2d

# diagnostics

compute		tbig big temp
variable	pebig equal pe*atoms/count(big)
variable	ebig equal etotal*atoms/count(big)
thermo_style	custom step temp f_2[7] etotal v_pebig v_ebig press 		f_2[1] f_2[2] f_2[3] f_2[4] f_2[5] 		f_2[6] f_2[8] f_2[9] f_2[10]

thermo_modify	temp tbig
WARNING: Temperature for thermo pressure is not for group all (../thermo.cpp:439)
thermo		100

#dump		1 all atom 250 dump.srd.mixture

#dump		2 all image 250 image.*.jpg type type zoom 1.6
#dump_modify	2 pad 4 adiam 1 1 adiam 2 0.2

#dump		3 all movie 250 movie.mpg type type zoom 1.6
#dump_modify	3 pad 4 adiam 1 1 adiam 2 0.2

run		5000
SRD info:
  SRD/big particles = 14616 100
  big particle diameter max/min = 0.88 0.88
  SRD temperature & lamda = 1 0.2
  SRD max distance & max velocity = 0.8 40
  SRD grid counts: 63 63 1
  SRD grid size: request, actual (xyz) = 0.25, 0.250974 0.250974 1.58114
  SRD per actual grid cell = 4.86648
  SRD viscosity = 0.463448
  big/SRD mass density ratio = 2.12808
WARNING: Fix srd grid size > 1/4 of big particle diameter (../fix_srd.cpp:2875)
  # of rescaled SRD velocities = 0
  ave/max small velocity = 13.2944 24.262
  ave/max big velocity = 1.69284 5.10989
Memory usage per processor = 12.7948 Mbytes
Step Temp 2[7] TotEng pebig ebig Press 2[1] 2[2] 2[3] 2[4] 2[5] 2[6] 2[8] 2[9] 2[10] 
       0    1.8791467            0 0.0060376284  -0.97185784    0.8884974   0.61487656            0            0            0            0            0            0            0            0            0 
     100    1.1596877         3969   0.00179671  -0.88368702   0.26440384   0.85824544         7578           83           83            0           14        12996         3000    1.0041859            0 
     200    1.2193121         3969  0.001834514  -0.93715195   0.26996708   0.70474789         7511           90           90            0           53        12996         3022    1.0188814            0 
     300   0.99964232         3969 -0.00024687038   -1.0259753 -0.036329445   0.17545201         7647           91           91            0           84        12996         3012    1.0119139            0 
     400    1.0499322         3969 0.00055095426  -0.95835442  0.081078429   0.36186511         7386          108          108            0          111        12996         2998    1.0216118            0 
     500    1.0774128         3969 0.00085873911  -0.94026661   0.12637205   0.44079381         7472           85           85            0          138        12996         2996    1.0224021            0 
     600    1.0713454         3969 0.00045284139  -0.99399184  0.066640139   0.10369128         7656           83           83            0          159        12996         3007     1.030888            0 
     700   0.98148416         3969 0.00027332701  -0.93144651  0.040222802   0.40064794         7616           68           68            0          194        12996         2999    1.0156811            0 
     800     1.038835         3969 0.00026382768  -0.98962177  0.038824881   0.26546656         7518          100          100            0          217        12996         3018    1.0169426            0 
     900    1.0976069         3969 0.0005211042   -1.0099451  0.076685694   0.28307539         7658           91           91            0          243        12996         3028     1.037322            0 
    1000    1.0541417         3969 0.00060061674  -0.95521356  0.088386759   0.61226289         7577           78           78            0          285        12996         2996     1.019357            0 
    1100    1.0332458         3969 0.00050159758  -0.94909829  0.073815099    0.6685224         7581           79           79            0          317        12996         3000    1.0327932            0 
    1200   0.89438281         3969 -0.00096584613   -1.0275729  -0.14213392   0.37403554         7576           96           96            0          346        12996         2999    1.0185657            0 
    1300    1.0211539         3969 2.286332e-05   -1.0075778 0.0033645662   0.56342549         7660           94           94            0          385        12996         2994     1.019908            0 
    1400   0.99883891         3969 0.00024046091   -0.9534643  0.035386228    0.5689857         7634           82           82            0          416        12996         3022    1.0247654            0 
    1500   0.93938218         3969 -0.00014395945  -0.95117343 -0.021185072   0.53463026         7632           87           87            0          441        12996         3012    1.0411548            0 
    1600    1.2197277         3969 0.0011523527   -1.0379502   0.16958023    0.3478121         7659           82           82            0          466        12996         3011    1.0361286            0 
    1700   0.96932134         3969 -0.00064508306   -1.0545586 -0.094930423   0.29578009         7332           92           92            0          506        12996         2993    1.0361228            0 
    1800    1.0534784         3969 -4.2619236e-05   -1.0492155 -0.0062718467   0.42534773         7647           94           94            0          533        12996         3030    1.0252953            0 
    1900    1.1715618         3969 0.00031188504   -1.1139492  0.045897003   0.23182966         7624           78           78            0          557        12996         2987    1.0274073            0 
    2000    0.9840555         3969 -0.00078568321   -1.0898361  -0.11562114   0.24175316         7571           77           77            0          582        12996         3016    1.0207729            0 
    2100   0.91303589         3969 -0.001459571    -1.118696  -0.21479047   0.27799152         7668           84           84            0          599        12996         3022     1.024854            0 
    2200   0.97316562         3969 -0.00087469617   -1.0921543  -0.12872029   0.40701899         7422           96           96            0          634        12996         3003     1.030247            0 
    2300    1.1071289         3969 0.00055485995   -1.0144044   0.08165319   0.70028696         7242           86           86            0          659        12996         3013    1.0181269            0 
    2400   0.95313231         3969 -0.00066790967   -1.0418906 -0.098289587   0.56977108         7370           88           88            0          693        12996         3037    1.0174525            0 
    2500    1.0789299         3969 -0.00067288654   -1.1671626 -0.099021984    0.1320041         7485           84           84            0          723        12996         3011    1.0310304            0 
    2600    1.0013882         3969 -0.00086378434   -1.1184888   -0.1271145   0.31303314         7412           82           82            0          753        12996         2983    1.0183276            0 
    2700   0.99821888         3969 -0.00016681979   -1.0127859 -0.024549201   0.71198483         7543           93           93            0          788        12996         3025    1.0179264            0 
    2800     1.032743         3969 -0.00066018247    -1.119568 -0.097152452   0.34329585         7442          106          106            0          826        12996         2981    1.0218667            0 
    2900     1.158581         3969 0.00061952386    -1.055826  0.091169131   0.55199976         7462           85           85            0          853        12996         3022    1.0105531            0 
    3000    1.0890666         3969 -5.0289217e-05   -1.0855765 -0.0074005612   0.35916031         7412           77           77            0          886        12996         2994    1.0387853            0 
    3100   0.98273391         3969 -0.00062906795   -1.0654802  -0.09257364   0.32240559         7489           71           71            0          922        12996         3007     1.038908            0 
    3200    1.0182699         3969 -0.00092197839   -1.1437655  -0.13567834  0.060449966         7464           94           94            0          954        12996         3008    1.0137212            0 
    3300   0.92962276         3969 -0.0012252227   -1.1006303  -0.18030378    0.2692969         7449           98           98            0          985        12996         3011    1.0121446            0 
    3400    1.0270974         3969 -0.00078991522   -1.1330703  -0.11624392   0.28393475         7555           74           74            0         1013        12996         2981    1.0218996            0 
    3500   0.91276883         3969 -0.0012028955   -1.0806592   -0.1770181   0.48380351         7422          100          100            0         1045        12996         3019    1.0270228            0 
    3600    1.1604674         3969 0.00041287296   -1.0881043  0.060758384    0.4937285         7451           78           78            0         1084        12996         3001     1.021449            0 
    3700   0.92829756         3969 -0.0012843951   -1.1080262  -0.18901158   0.28403593         7502           80           80            0         1106        12996         3011    1.0140255            0 
    3800   0.99862294         3969 -0.00028587151   -1.0307056 -0.042068851   0.57880501         7353           84           84            0         1136        12996         3011    1.0238774            0 
    3900    1.0748889         3969 -0.00039644261   -1.1224805 -0.058340495    0.3117021         7199           95           95            0         1169        12996         2997    1.0141241            0 
    4000    1.1443251         3969 0.00073233367   -1.0251116   0.10777022   0.72975938         7478           90           90            0         1203        12996         3000     1.016123            0 
    4100    1.0573661         3969 -8.8349019e-05   -1.0597939 -0.013001442   0.62403315         7528           77           77            0         1235        12996         2993    1.0207081            0 
    4200   0.93387975         3969 -0.0012090318   -1.1024621  -0.17792112   0.50858912         7397           80           80            0         1285        12996         3007    1.0232781            0 
    4300   0.99747825         3969 -0.00050121316    -1.061262 -0.073758528   0.63526459         7355           90           90            0         1313        12996         3015    1.0210677            0 
    4400   0.91351004         3969 -0.0013423585   -1.1019164  -0.19754147   0.44962963         7448           94           94            0         1344        12996         3009    1.0203146            0 
    4500     1.112129         3969 -9.3639925e-05   -1.1147878 -0.013780051    0.5084257         7570           77           77            0         1375        12996         2993    1.0224154            0 
    4600    1.0070341         3969 -0.00044065884   -1.0618111 -0.064847355   0.50331376         7503           74           74            0         1406        12996         3001    1.0099788            0 
    4700    1.1678442         3969 0.00045268406   -1.0895488  0.066616986   0.46676039         7514           81           81            0         1436        12996         2983    1.0099861            0 
    4800    1.1647145         3969 0.00063121154   -1.0601783  0.092889091   0.52493522         7437           89           89            0         1467        12996         3016    1.0214313            0 
    4900    1.1545752         3969 -0.00015064108   -1.1651978 -0.022168341  0.098732178         7561           85           85            0         1490        12996         2999    1.0108506            0 
    5000    1.2758575         3969 0.0016719011    -1.017062   0.24603697   0.63374434         7283           77           77            0         1521        12996         2989    1.0136454            0 
Loop time of 2.94861 on 1 procs for 5000 steps with 14716 atoms

Pair  time (%) = 0.0425909 (1.44444)
Neigh time (%) = 0.207188 (7.02665)
Comm  time (%) = 0.0410075 (1.39074)
Outpt time (%) = 0.00202203 (0.0685757)
Other time (%) = 2.6558 (90.0696)

Nlocal:    14716 ave 14716 max 14716 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    80 ave 80 max 80 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    490 ave 490 max 490 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 490
Ave neighs/atom = 0.0332971
Neighbor list builds = 250
Dangerous builds = 0

Please see the log.cite file for references relevant to this simulation

