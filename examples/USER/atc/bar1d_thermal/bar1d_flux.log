LAMMPS (7 Jul 2009)
#AtC Thermal Coupling
# This benchmark tests heat conducting into and out of the MD region.  The
# temperature is intially 20 everywhere and the left boundary BC is fixed at
# 40.# The result should show heat diffusing through the FEM to the MD and back
# out # to the FEM on the right.  Insufficient time is captured to reach the
# linear # steady state, but heat crossing both boundaries should be observed.
#echo both
units		real
atom_style	atomic

# create domain
#lattice	type reduced density rho* = 4*(sigma/a)^3, where N=4 for fcc, s = 3.405 A (Wagner) and a = 5.25 A (Ashcroft & Mermin, p. 70)
# NOTE following 3 lines added for restart
boundary	f p p
pair_style	lj/cut 13.5
read_data       temp.init
  orthogonal box = (-27.025 -16.215 -16.215) to (27.025 16.215 16.215)
  1 by 1 by 1 processor grid
  1440 atoms
  1440 velocities
lattice         fcc 5.405 origin 0.25 0.25 0.25
Lattice spacing in x,y,z = 5.405 5.405 5.405
region		simRegion block -12 12 -3 3 -3 3

# create atoms, NOTE commented out for restart
#region		mdRegion block -5 5 -3 3 -3 3
#boundary	f p p
#create_box	1 mdRegion
#create_atoms	1 region mdRegion
#mass		1 39.95

# specify interal/ghost atoms
region		mdInternal block -4 4 -3 3 -3 3
group		internal region mdInternal
1152 atoms in group internal
group		ghost subtract all internal
288 atoms in group ghost

# velocities have Vcm = 0, NOTE next four lines commented out for restart
#velocity	internal create 40. 87287 mom yes loop geom

#pair_style	lj/cut 13.5
##pair_coeff	1 1 0.010323166 3.405 13.5
#pair_coeff  	1 1 .238 3.405 13.5

neighbor	5. bin
neigh_modify	every 10 delay 0 check no

#write_restart	tinit.dat

#               ID  group atc PhysicsType ParameterFile
fix             AtC internal   atc thermal     Ar_thermal.mat

#               ID  part keywords    nx ny nz region
#fix_modify      AtC fem  create mesh 12 2  2  simRegion f p p
fix_modify      AtC fem  create mesh 12 1  1  simRegion f p p
fix_modify      AtC mesh create_faceset ibndy box -4.0 4.0 -12 12 -12  12 in
fix_modify      AtC mesh create_faceset obndy box -4.0 4.0 -12 12 -12  12 outward

# specify atom types
#fix_modify      AtC transfer internal type internal
fix_modify      AtC transfer boundary type ghost

# fix a temperature
fix_modify     	AtC transfer fix temperature all 20.
#fix_modify	AtC transfer fix temperature all linear 0 0 0 -0.154 0 0 30.

# turn on thermostat
fix_modify	AtC transfer thermal control rescale 10

variable xdof equal 3*count(ghost)
compute_modify thermo_temp extra ${xdof}
compute_modify thermo_temp extra 864
thermo_style custom step cpu etotal pe f_AtC[1] temp f_AtC[2]
thermo_modify  format 1 %6i format 2 %7.2g

# equilibrate MD field
#fix_modify      AtC transfer output bar1dfe_flux_init 100
timestep	5
thermo		10
run 		400
Memory usage per processor = 8.7506 Mbytes
Step CPU TotEng PotEng AtC[1] Temp AtC[2] 
     0       0   -2573.6428   -2710.8793    412.06718    39.965279           20 
    10    0.28   -2626.7498   -2695.4276    412.06718           20           20 
    20    0.56   -2600.7022     -2669.38    412.06718           20           20 
    30    0.84   -2570.0142   -2638.6921    412.06718           20           20 
    40     1.1   -2548.1494   -2616.8273    412.06718           20           20 
    50     1.4   -2541.6409   -2610.3188    412.06718           20           20 
    60     1.7   -2539.3355   -2608.0134    412.06718           20           20 
    70       2   -2534.3684   -2603.0463    412.06718           20           20 
    80     2.2   -2530.2415   -2598.9194    412.06718           20           20 
    90     2.5   -2531.3411    -2600.019    412.06718           20           20 
   100     2.8   -2537.6764   -2606.3542    412.06718           20           20 
   110     3.1    -2546.506   -2615.1838    412.06718           20           20 
   120     3.4   -2555.0937   -2623.7716    412.06718           20           20 
   130     3.6   -2562.4178   -2631.0957    412.06718           20           20 
   140     3.9   -2568.7827   -2637.4606    412.06718           20           20 
   150     4.2   -2574.6292    -2643.307    412.06718           20           20 
   160     4.5   -2579.7542    -2648.432    412.06718           20           20 
   170     4.8   -2583.6629   -2652.3408    412.06718           20           20 
   180       5   -2585.9113   -2654.5892    412.06718           20           20 
   190     5.3   -2586.1786   -2654.8565    412.06718           20           20 
   200     5.6   -2584.8754   -2653.5532    412.06718           20           20 
   210     5.9   -2582.8956   -2651.5734    412.06718           20           20 
   220     6.2   -2580.6882    -2649.366    412.06718           20           20 
   230     6.5     -2578.24   -2646.9179    412.06718           20           20 
   240     6.7   -2575.9058   -2644.5836    412.06718           20           20 
   250       7   -2574.2875   -2642.9654    412.06718           20           20 
   260     7.3   -2573.8273   -2642.5052    412.06718           20           20 
   270     7.6   -2574.3017   -2642.9796    412.06718           20           20 
   280     7.8   -2574.7059   -2643.3838    412.06718           20           20 
   290     8.1   -2574.7745   -2643.4524    412.06718           20           20 
   300     8.4   -2575.3126   -2643.9904    412.06718           20           20 
   310     8.7   -2576.5002    -2645.178    412.06718           20           20 
   320       9   -2577.7411    -2646.419    412.06718           20           20 
   330     9.3   -2578.2283   -2646.9061    412.06718           20           20 
   340     9.5   -2577.7485   -2646.4263    412.06718           20           20 
   350     9.8   -2576.9631   -2645.6409    412.06718           20           20 
   360      10   -2576.0309   -2644.7088    412.06718           20           20 
   370      10   -2574.9309   -2643.6088    412.06718           20           20 
   380      11   -2573.7943   -2642.4721    412.06718           20           20 
   390      11   -2573.0353   -2641.7132    412.06718           20           20 
   400      11   -2573.4199   -2642.0977    412.06718           20           20 
Loop time of 11.2102 on 1 procs for 400 steps with 1440 atoms

Pair  time (%) = 4.45575 (39.7474)
Neigh time (%) = 1.86555 (16.6416)
Comm  time (%) = 0.0379353 (0.338401)
Outpt time (%) = 0.0610819 (0.54488)
Other time (%) = 4.78984 (42.7277)

Nlocal:    1440 ave 1440 max 1440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    5320 ave 5320 max 5320 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    419459 ave 419459 max 419459 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs: 838918 ave 838918 max 838918 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 838918
Ave neighs/atom = 582.582
Neighbor list builds = 40
Dangerous builds = 0


# change thermostat to hoover
fix_modify	AtC transfer unfix temperature all
fix_modify  	AtC transfer thermal control flux faceset obndy 
fix_modify      AtC transfer filter type exponential
fix_modify	AtC transfer filter scale 10000.0
fix_modify	AtC transfer filter on

# add nodesets
#               ID  mesh create_nodeset tag xmin xmax ymin ymax zmin zmax
fix_modify      AtC mesh create_nodeset lbc -12.1  -11.9   -12  12   -12  12
fix_modify      AtC mesh create_nodeset rbc  11.9   12.1   -12  12   -12  12
fix_modify      AtC transfer fix temperature lbc 40.
fix_modify      AtC transfer fix temperature rbc 20.

# initialize filter
run		100
Memory usage per processor = 8.97948 Mbytes
Step CPU TotEng PotEng AtC[1] Temp AtC[2] 
   400       0   -2573.4199   -2642.0977    412.06718           20           20 
   410     0.3    -2573.399   -2643.8456    429.61396    20.515068    21.555366 
   420     0.6   -2573.4225   -2646.1086      430.028     21.16726    21.573916 
   430    0.91   -2573.4498   -2647.2056      430.455    21.478791    21.593046 
   440     1.2   -2573.4565   -2646.2695    430.87731    21.204227    21.611967 
   450     1.5   -2573.4725   -2644.3172    431.27891    20.631017     21.62996 
   460     1.8   -2573.4862   -2643.0051    431.65927    20.244924    21.647001 
   470     2.1   -2573.4906   -2642.6175    432.02801    20.130768    21.663521 
   480     2.4   -2573.5014   -2642.5644     432.3911    20.112138    21.679788 
   490     2.7   -2573.5132   -2642.9216    432.75177    20.212768    21.695947 
   500       3   -2573.5326   -2643.6695    433.11495    20.424906    21.712218 
Loop time of 3.0217 on 1 procs for 100 steps with 1440 atoms

Pair  time (%) = 1.11102 (36.7679)
Neigh time (%) = 0.465189 (15.3949)
Comm  time (%) = 0.0091815 (0.303852)
Outpt time (%) = 0.0152943 (0.506148)
Other time (%) = 1.42102 (47.0272)

Nlocal:    1440 ave 1440 max 1440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    5320 ave 5320 max 5320 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    419046 ave 419046 max 419046 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs: 838092 ave 838092 max 838092 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 838092
Ave neighs/atom = 582.008
Neighbor list builds = 10
Dangerous builds = 0

# set up output, should be before a "run"
fix_modify      AtC transfer output bar1d_fluxFE 100 text

# ouput command
#dump            D1 all atom 1000 dump.bar1d
fix_modify      AtC transfer atomic_output bar1d_fluxMD 100

# run with FE
reset_timestep 0
thermo		100
run 		10000
Memory usage per processor = 8.97948 Mbytes
Step CPU TotEng PotEng AtC[1] Temp AtC[2] 
     0       0   -2573.5326   -2643.6695    433.11495    20.424906    21.712218 
   100       3   -2573.4996     -2644.68    436.56595    20.728783    21.866831 
   200       6   -2573.6452   -2641.8181    439.65242    19.852963    22.005112 
   300     8.9   -2573.7003   -2646.4622    442.67272    21.189339    22.140428 
   400      12   -2573.8123   -2641.5274    445.34109    19.719609    22.259977 
   500      15    -2573.523   -2644.2791    447.87899    20.605203    22.373681 
   600      18   -2573.5066   -2641.7526    450.30082    19.874234    22.482184 
   700      21   -2573.1755   -2642.9899    452.59197    20.330998    22.584833 
   800      24   -2572.7532   -2642.4538    454.74808    20.297842    22.681431 
   900      27   -2572.4242   -2643.2186    456.80456    20.616377    22.773566 
  1000      30   -2572.1111   -2644.2513    458.77119    21.008267    22.861675 
  1100      33   -2571.8664   -2642.2676    460.69037    20.501859    22.947659 
  1200      36   -2571.6698   -2642.4072    462.52036    20.599778    23.029647 
  1300      39   -2571.1188   -2640.8357    464.26327    20.302568    23.107733 
  1400      42   -2570.6841   -2642.0319    465.90618    20.777507    23.181339 
  1500      45   -2570.3755   -2642.5393    467.64779    21.015167    23.259367 
  1600      48   -2570.1086   -2640.3963    469.24937    20.468802    23.331122 
  1700      51   -2569.7084   -2642.3964    470.76324    21.167807    23.398946 
  1800      53   -2569.2903    -2643.213    472.26485    21.527379    23.466222 
  1900      56   -2568.8699   -2641.4957    473.83022    21.149691    23.536354 
  2000      59   -2568.3377   -2641.3608    475.30209    21.265411    23.602297 
  2100      62   -2567.6236   -2639.3792    476.69625    20.896274    23.664759 
  2200      65   -2566.8936   -2642.0946    478.02908    21.899656    23.724472 
  2300      68   -2566.4627   -2640.2742    479.41262    21.494985    23.786458 
  2400      71   -2566.0253   -2638.6268    480.76007    21.142611    23.846827 
  2500      74   -2565.8021   -2639.6421    482.09822    21.503291    23.906779 
  2600      77   -2565.2093   -2642.2012     483.3378    22.421166    23.962315 
  2700      80   -2564.6901   -2639.8567    484.63598    21.889625    24.020477 
  2800      83   -2564.0658   -2636.9481     485.8689     21.22441    24.075714 
  2900      86   -2563.3168   -2639.3155    487.10404    22.131928    24.131051 
  3000      89   -2562.6825   -2635.5318    488.27527    21.214781    24.183525 
  3100      92   -2562.1212   -2635.4426    489.43761    21.352279      24.2356 
  3200      95   -2561.6126   -2636.3019    490.64892    21.750607     24.28987 
  3300      98   -2561.1335   -2639.0741    491.78462    22.697438    24.340752 
  3400   1e+02   -2560.4828   -2638.3251    492.87662     22.66881    24.389676 
  3500   1e+02   -2559.8843   -2635.4238    493.96107    21.998211    24.438262 
  3600 1.1e+02   -2559.2443   -2634.7161    495.09564     21.97848    24.489093 
  3700 1.1e+02   -2558.5654   -2636.1565    496.14063    22.595663    24.535911 
  3800 1.1e+02   -2558.0214   -2636.7671    497.17918    22.931888     24.58244 
  3900 1.2e+02   -2557.9398    -2634.982    498.30063    22.435836    24.632684 
  4000 1.2e+02   -2557.8749   -2635.5655    499.26966    22.624655    24.676098 
  4100 1.2e+02   -2557.8331   -2635.3677    500.27412    22.579214    24.721101 
  4200 1.2e+02   -2557.6329   -2635.9432    501.25564    22.805115    24.765075 
  4300 1.3e+02   -2557.4707    -2636.512    502.24607    23.017987    24.809448 
  4400 1.3e+02   -2557.3019   -2632.8823    503.29942    22.010137    24.856641 
  4500 1.3e+02   -2556.8882   -2633.5726    504.19269    22.331634    24.896661 
  4600 1.4e+02   -2556.5255   -2637.0121    505.14884    23.438878    24.939499 
  4700 1.4e+02   -2556.1965   -2636.3657    506.12562    23.346446    24.983261 
  4800 1.4e+02    -2555.728    -2636.154     507.0392    23.421248    25.024191 
  4900 1.5e+02   -2555.3573   -2634.8572    507.93584    23.151538    25.064363 
  5000 1.5e+02   -2554.8839   -2635.3615    508.86307    23.436248    25.105905 
  5100 1.5e+02   -2554.5001   -2632.2863    509.79029    22.652461    25.147447 
  5200 1.5e+02   -2554.2786   -2635.3015    510.67821    23.595069    25.187227 
  5300 1.6e+02   -2554.1208   -2633.4672    511.56223    23.106822    25.226833 
  5400 1.6e+02   -2553.8571   -2632.9509      512.411    23.033282     25.26486 
  5500 1.6e+02   -2553.4771   -2633.4831    513.27749     23.29891    25.303681 
  5600 1.7e+02    -2552.995   -2634.0399    514.08357    23.601475    25.339795 
  5700 1.7e+02   -2552.6786     -2632.23    514.99251    23.166531    25.380517 
  5800 1.7e+02   -2552.1989   -2634.2926    515.83523    23.906877    25.418273 
  5900 1.8e+02   -2551.9275   -2633.7331    516.69181    23.822967     25.45665 
  6000 1.8e+02   -2551.5879   -2633.4709    517.50304    23.845533    25.492995 
  6100 1.8e+02   -2551.1096   -2633.3576    518.27013    23.951824    25.527362 
  6200 1.8e+02   -2550.6066   -2634.4431    519.07898    24.414427      25.5636 
  6300 1.9e+02   -2550.1427   -2633.9705    519.85788    24.411888    25.598497 
  6400 1.9e+02   -2549.6148   -2630.7643    520.70201    23.631931    25.636316 
  6500 1.9e+02   -2549.2143   -2629.4555    521.48165      23.3674    25.671246 
  6600   2e+02    -2548.823   -2629.4952    522.21153    23.492935    25.703946 
  6700   2e+02   -2548.6124   -2631.6154    523.03499    24.171693    25.740839 
  6800   2e+02    -2548.314   -2627.4378    523.72811    23.041997    25.771892 
  6900   2e+02   -2548.0996    -2632.112    524.53399    24.465645    25.807997 
  7000 2.1e+02   -2547.8468    -2630.457    525.24887    24.057291    25.840026 
  7100 2.1e+02   -2547.5093   -2630.8501    526.01815     24.27005    25.874491 
  7200 2.1e+02   -2547.1919   -2630.0362    526.75581    24.125462     25.90754 
  7300 2.2e+02   -2546.8056   -2631.0682     527.4846    24.538524    25.940191 
  7400 2.2e+02    -2546.541   -2632.4362    528.24198     25.01394    25.974124 
  7500 2.2e+02   -2546.1286   -2629.6863    528.94188     24.33324    26.005481 
  7600 2.3e+02    -2545.959   -2629.3922    529.57701    24.296979    26.033936 
  7700 2.3e+02   -2546.0743    -2629.693    530.30436    24.351001    26.066523 
  7800 2.3e+02   -2546.1431   -2631.6521    530.98889    24.901471    26.097191 
  7900 2.3e+02   -2546.1056   -2629.3749    531.66127    24.249239    26.127315 
  8000 2.4e+02   -2546.0454   -2630.0836    532.37925    24.473159    26.159482 
  8100 2.4e+02   -2545.9725   -2630.5976    533.05102    24.644071     26.18958 
  8200 2.4e+02   -2545.5772   -2629.4844    533.65121    24.435002    26.216469 
  8300 2.5e+02   -2545.5178   -2631.6842    534.43183    25.092927    26.251443 
  8400 2.5e+02   -2545.3432   -2629.5904    535.02156    24.534025    26.277864 
  8500 2.5e+02   -2545.2097   -2631.2853    535.66213     25.06648    26.306563 
  8600 2.6e+02   -2544.9173   -2629.2314     536.3311    24.553498    26.336535 
  8700 2.6e+02   -2544.5414   -2628.3855    536.99695    24.416625    26.366366 
  8800 2.6e+02   -2543.8563   -2629.5985    537.57029    24.969392    26.392053 
  8900 2.6e+02   -2543.2906    -2628.292    538.33031    24.753655    26.426103 
  9000 2.7e+02   -2542.5357   -2627.1708    538.87931     24.64698      26.4507 
  9100 2.7e+02   -2542.1926    -2627.894    539.53269    24.957511    26.479973 
  9200 2.7e+02   -2542.0567   -2627.6595    540.14474    24.928803    26.507394 
  9300 2.8e+02   -2542.1288   -2626.8786    540.80469    24.680402    26.536961 
  9400 2.8e+02   -2541.8301   -2627.2829    541.36001    24.885088    26.561841 
  9500 2.8e+02   -2541.6773   -2628.1451    541.99633    25.180691    26.590349 
  9600 2.9e+02   -2541.3762    -2629.589    542.51985    25.688852    26.613804 
  9700 2.9e+02   -2541.0314   -2625.3135    543.15786    24.544177    26.642389 
  9800 2.9e+02   -2540.6298   -2625.8733    543.76425    24.824163    26.669556 
  9900 2.9e+02   -2540.2376   -2628.1266    544.31076    25.594543    26.694041 
 10000   3e+02   -2540.0111   -2625.9159    544.89126    25.016719    26.720049 
Loop time of 297.023 on 1 procs for 10000 steps with 1440 atoms

Pair  time (%) = 107.376 (36.1506)
Neigh time (%) = 46.5622 (15.6763)
Comm  time (%) = 0.924362 (0.311209)
Outpt time (%) = 0.154094 (0.0518793)
Other time (%) = 142.007 (47.81)

Nlocal:    1440 ave 1440 max 1440 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    5320 ave 5320 max 5320 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    419203 ave 419203 max 419203 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs: 838406 ave 838406 max 838406 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 838406
Ave neighs/atom = 582.226
Neighbor list builds = 1000
Dangerous builds = 0
