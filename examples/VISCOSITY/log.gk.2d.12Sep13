LAMMPS (10 Sep 2013)
# sample LAMMPS input script for viscosity of 2d LJ liquid
# Green-Kubo method via fix ave/correlate

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable    p equal 400     # correlation length
variable    s equal 5       # sample interval
variable    d equal $p*$s   # dump interval
variable    d equal 400*$s   
variable    d equal 400*5   

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

lattice         sq2 ${rho}
lattice         sq2 0.5999999999999999778
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox block 0 $x 0 $y -0.1 0.1
region          simbox block 0 20 0 $y -0.1 0.1
region          simbox block 0 20 0 20 -0.1 0.1
create_box      1 simbox
Created orthogonal box = (0 0 -0.182574) to (36.5148 36.5148 0.182574)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

# equilibration run

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

thermo          $d
thermo          2000
run	        10000
Memory usage per processor = 2.07097 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0     -0.56617    -1.535262 
    2000    1.0164992   -1.6006146            0  -0.58538603   0.88642098 
    4000    1.0955206   -1.6156387            0  -0.52148756   0.94410568 
    6000    1.0384034   -1.6029204            0  -0.56581499   0.82862864 
    8000      1.03126   -1.5776603            0  -0.54768937     1.122187 
   10000    1.0159313   -1.6063811            0  -0.59171973    0.9961884 
Loop time of 1.89357 on 1 procs for 10000 steps with 800 atoms

Pair  time (%) = 1.05965 (55.9602)
Neigh time (%) = 0.227317 (12.0047)
Comm  time (%) = 0.0356276 (1.88151)
Outpt time (%) = 5.60284e-05 (0.00295888)
Other time (%) = 0.570923 (30.1506)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    264 ave 264 max 264 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5614 ave 5614 max 5614 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5614
Ave neighs/atom = 7.0175
Neighbor list builds = 1103
Dangerous builds = 0

velocity	all scale $t
velocity	all scale 1

unfix		2

# Green-Kubo viscosity calculation

reset_timestep  0

variable         pxy equal pxy

fix              SS all ave/correlate $s $p $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 $p $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 400 $d                  v_pxy type auto file profile.gk.2d ave running
fix              SS all ave/correlate 5 400 2000                  v_pxy type auto file profile.gk.2d ave running

variable         scale equal 1.0/$t*vol*$s*dt
variable         scale equal 1.0/1*vol*$s*dt
variable         scale equal 1.0/1*vol*5*dt
variable         v11 equal trap(f_SS[3])*${scale}
variable         v11 equal trap(f_SS[3])*33.333333333333328596

thermo_style     custom step temp press pxy v_v11

run              500000
Memory usage per processor = 2.07097 Mbytes
Step Temp Press Pxy v11 
       0            1   0.98664157    0.1056765   0.18612539 
    2000   0.95291404     1.199872   0.16190354    6.3622865 
    4000   0.97035474   0.95019583 -0.028108952 -0.019331326 
    6000   0.99784792    1.0066466 0.0085549073  -0.12148778 
    8000   0.99816414   0.90521139 0.00095639386 0.0098644997 
   10000    0.9951641   0.96718253  0.090881095   0.50006024 
   12000   0.93744355    1.2391514  0.014185646    1.4928658 
   14000     1.000559   0.97734913 -0.096964014    1.3899184 
   16000     1.002721    1.1185539  0.026144411    1.0983068 
   18000   0.96861294    1.0439439  0.090245855    1.4107497 
   20000   0.98664185   0.97686008  -0.27549912    1.3394189 
   22000   0.97569716    1.0845656   -0.0734503    1.2870138 
   24000   0.98609865    1.0625182  -0.01142576    1.0253871 
   26000     0.988828   0.99456937 -0.019918137    0.9418664 
   28000   0.98671933   0.94373279  -0.21675597   0.94445052 
   30000   0.98778176    0.8446134   0.15106071    0.9681741 
   32000   0.97606274    1.0297113  -0.15539564   0.91574182 
   34000    1.0018246   0.96354339 0.0040827444   0.86638522 
   36000    1.0106496   0.78936538 -0.075881707   0.85472064 
   38000     1.002101   0.84613466  0.096875042   0.79935874 
   40000   0.99674744    1.0228324  0.068840647   0.75555879 
   42000   0.98994908   0.96088667 -0.067028764   0.89587645 
   44000   0.96432917    1.0396458  -0.14766862   0.98252655 
   46000    0.9857594    1.0493731  -0.16618989   0.92998032 
   48000   0.99435908    1.0474288 -0.099147004   0.96068255 
   50000   0.98424778    1.0498745  -0.02093585   0.91727045 
   52000    1.0087964    1.0044041     -0.17322   0.85023294 
   54000   0.98865025   0.96826791 -0.0040697022   0.78082036 
   56000   0.99830593   0.85271022 -0.0095598719   0.76991826 
   58000    1.0067449   0.83099437 -0.0088816687   0.73064231 
   60000   0.99157769   0.97115433  0.054722168   0.68728526 
   62000   0.98221722    1.0180359 -0.019303097    0.6924154 
   64000    1.0107737    0.8729291   0.14432752   0.67840745 
   66000   0.98057736     1.147233  -0.15209863    0.6829561 
   68000   0.99861459        1.013  0.096201469   0.64354984 
   70000   0.99465851   0.99448469  -0.15043327   0.65410181 
   72000   0.96494888    1.0879386   0.10533378   0.59884711 
   74000   0.98295883    1.0364372  -0.15043121   0.89748148 
   76000    1.0006934    1.0423573 -0.019296985   0.96967781 
   78000   0.97007774   0.89100292  0.082518797    1.0416848 
   80000    0.9673494    1.0862372 0.0059477626    1.0154864 
   82000      1.00901   0.91118297   0.11024238    1.0445278 
   84000   0.99091853     1.029323  0.064448536    1.0177414 
   86000   0.99769204    1.0031789  0.049276808     1.012145 
   88000    1.0043966   0.87571549 0.0098902782    1.0258499 
   90000   0.98664263   0.95754039 -0.078411226    1.0183036 
   92000   0.97082418    1.0007131  -0.16528157    1.0313541 
   94000    0.9718415     1.134436   0.13053227    1.0133067 
   96000   0.97769459    1.1823894 -0.034238523   0.98394844 
   98000    1.0212676    1.0322511  0.019298484   0.98987481 
  100000   0.98939854   0.94010891  -0.14270608   0.93622435 
  102000   0.99029022     1.032313 -0.084354688    0.9349947 
  104000   0.97710114   0.93914663 -0.061639137   0.95912515 
  106000    1.0015283   0.94261993 -0.065425987   0.98677831 
  108000    1.0277867   0.90869174  0.012240704   0.93883613 
  110000   0.99627564   0.96468532  0.016729662   0.92041863 
  112000    1.0053403   0.89703815  0.053013062   0.90792399 
  114000    1.0061962   0.88630948  0.074929857   0.89048522 
  116000   0.95237809    1.0422611   0.03659581   0.90269348 
  118000   0.99935668   0.95007176   0.17759824   0.91222275 
  120000   0.96695648    1.0439211  0.034405839   0.97878534 
  122000   0.97945456   0.99746187    0.0068417   0.97320581 
  124000    1.0205146   0.94768233 -0.0059643466   0.97517978 
  126000   0.99066371    1.1996852 -0.014932912   0.98986369 
  128000   0.98292228    1.0610561  0.045677014   0.99324967 
  130000   0.97938306     1.056683 -0.070425405    1.0229877 
  132000   0.98907671    1.1401504  0.017589327    1.0266663 
  134000   0.97298779    1.0372376 -0.053985765    1.0140165 
  136000     1.006034   0.95903957   0.02253597   0.99236069 
  138000   0.99107129   0.93393363   0.12735171   0.97191787 
  140000   0.97467096    1.1824765 -0.037275252   0.95115537 
  142000   0.99599019   0.93770801 -0.0063475745   0.91527534 
  144000   0.98928711    1.0100989  -0.14030583   0.92830561 
  146000    1.0252234   0.86035265  -0.10246737   0.93782417 
  148000     1.014654   0.79624898  0.016043825   0.91183296 
  150000    1.0025365   0.94434929  0.061147641   0.91181019 
  152000   0.98239056   0.96273739  -0.06423689   0.91302568 
  154000   0.99242128    1.0133692  0.054121583   0.90943966 
  156000    0.9565225    1.1188086   0.14095454   0.90748691 
  158000   0.98447114    1.0678162  0.029354999   0.95922918 
  160000   0.99401344   0.88196818  0.035219872   0.95995359 
  162000   0.99157731   0.98581187  0.092655892    1.0460888 
  164000   0.98700844    1.0628065 -0.097600946    1.0021877 
  166000   0.99653656    1.0967715  -0.13363058    1.0272155 
  168000   0.97631159    1.0234334 -0.085606659    1.0452207 
  170000    1.0037365   0.87168897  -0.05818739    1.1534091 
  172000   0.99599564    0.9223394 -0.021708101    1.1079595 
  174000   0.95487975    1.1632417   0.07399437    1.0992262 
  176000   0.99699032    1.0259118 -0.069297394     1.086451 
  178000   0.99794248   0.92978817 -0.036423033    1.0850363 
  180000   0.97147417    1.0886532  -0.10560093    1.0831337 
  182000    0.9875809    1.1116588  0.074972498    1.1130653 
  184000   0.97900449   0.93659533 -0.039279882    1.1189945 
  186000    0.9679462    1.2538405 -0.015579462     1.099796 
  188000    1.0074452   0.87991578  -0.20476294    1.1007234 
  190000   0.97473004   0.98106665 -0.072522838    1.0894785 
  192000   0.98717919    0.9718274  0.059062062     1.086273 
  194000    1.0030985   0.94066352   0.15646304    1.1914576 
  196000   0.98500284   0.96429266   0.11204948    1.1594863 
  198000    0.9840631   0.90903459 -0.0053663326    1.1502972 
  200000   0.97458345    1.0019506 0.00027337741    1.1410582 
  202000   0.98772368    1.0082562 0.0069097265    1.2104792 
  204000   0.99875662   0.90609936 -0.024992308    1.2337143 
  206000   0.98028117   0.92135146  0.015407324    1.2200096 
  208000   0.98909505   0.89346463  -0.13505415    1.2282618 
  210000   0.99264762    1.0637228   0.15772329    1.2298716 
  212000     1.001344   0.92015447 -0.022356905    1.2175726 
  214000    1.0199747   0.92259571  0.012763156    1.2046812 
  216000   0.95599898    1.0739248 -0.075513344    1.1935807 
  218000   0.99797077    1.0673568  0.049840078    1.1801809 
  220000    0.9905579   0.97950128  0.058186552    1.2027082 
  222000   0.99177609     1.028659 -0.076396538    1.1782589 
  224000    1.0105632    1.0136738  0.039008755    1.1848006 
  226000    1.0023731    0.8427875  -0.10734019     1.177471 
  228000   0.98752126   0.90957923 -0.050531743    1.3182698 
  230000    0.9810267    1.0784386   0.08508881    1.3092904 
  232000    1.0021266   0.93921109  -0.18635777    1.2973489 
  234000   0.99533025   0.91807335   0.16664865    1.2848923 
  236000   0.98011149   0.92896398  0.020234263    1.2941781 
  238000    1.0080589    1.0422206  0.080342493    1.2756861 
  240000     1.013769   0.91271642   0.10024033    1.2720643 
  242000    1.0084395    0.8645878 -0.014896263    1.2473047 
  244000   0.96637824    1.0817071  -0.16165169    1.2490751 
  246000   0.97629725    1.0768466  0.062453669    1.2348816 
  248000   0.97081168   0.95332682   0.09584424    1.2232201 
  250000     1.001316   0.90207588 -0.045980098    1.2179401 
  252000    1.0107243   0.97832107  -0.14601722    1.2134106 
  254000   0.98659744    1.0943909 -0.088294528    1.2333875 
  256000    1.0123386   0.99162386 -0.039344985    1.2164364 
  258000   0.95762302    1.0676734  0.012199759    1.2076414 
  260000   0.99842463   0.99944454 -0.060917216    1.1988621 
  262000   0.97766994    1.0286325  -0.10141058    1.2395609 
  264000   0.97615582   0.90531751   0.18512981    1.2044769 
  266000   0.96241019    1.0566036  0.078113491    1.2005364 
  268000    1.0168176   0.81665569 -0.030349244    1.2025997 
  270000   0.99827104    1.0749573 -0.056801916    1.1962529 
  272000    0.9968558   0.94529972  0.028725191    1.1828897 
  274000   0.97566641   0.91457261  0.015049168    1.1902579 
  276000   0.99070015   0.94576384  0.025755724    1.1896323 
  278000   0.96895102    1.0397797  0.080651494    1.1763571 
  280000    1.0072996   0.89570696  -0.15542961    1.1652696 
  282000    1.0144016   0.77288242 -0.029784437    1.1582708 
  284000    1.0181351    0.7694665 -0.054640099    1.1544617 
  286000   0.98291392    0.9938831 -0.0062479011    1.1596522 
  288000   0.97279582    1.0358224  -0.13401081    1.1505486 
  290000   0.99909636    1.0213079 -0.0012162009    1.1399725 
  292000   0.98460352   0.94742548 -0.031343507    1.1581955 
  294000   0.99038521   0.98665849  0.051955637    1.1524198 
  296000   0.99556533   0.86180797  0.055142099    1.1523058 
  298000   0.97636077   0.98781403  0.013204553     1.129189 
  300000   0.97032776    1.0678134   0.11879155    1.1176141 
  302000    1.0003067   0.87686391  0.023979249    1.1210971 
  304000    1.0209877   0.82384059 -0.019162225    1.1201332 
  306000   0.98495148   0.97853853 0.0067884582    1.1146556 
  308000    1.0080456   0.89962394 -0.039014939    1.1072495 
  310000   0.98760314    1.0580182 -0.0084950963    1.1128641 
  312000    1.0163132     0.743878  -0.13381063    1.1072529 
  314000   0.97482482   0.93981262    0.1188583    1.1113744 
  316000   0.99642196   0.92559157 -0.076386258    1.1180406 
  318000   0.98668334    0.9960588  0.051851225    1.1282305 
  320000     1.018361   0.82279734 -0.033370883    1.1306313 
  322000    1.0101361   0.79697655 -0.0097104031    1.1269227 
  324000   0.98374012   0.89538164  0.072387631    1.1184602 
  326000    1.0005728   0.81698596 -0.097827025    1.1067008 
  328000   0.98296796    1.0888354 -0.00019150727    1.1026196 
  330000   0.97244323    1.1015085  0.047308269    1.0967215 
  332000   0.99301221    1.0908167  -0.12434045    1.0911357 
  334000   0.99279827    1.0192878 -0.030977699    1.0804029 
  336000   0.98580679     1.055276   0.11288823    1.0750277 
  338000   0.98757346    1.0072102   0.10201237    1.0933627 
  340000    1.0067327   0.87701361  0.067382458    1.0850067 
  342000    1.0154351   0.94291159  0.070059816    1.0801363 
  344000    0.9743083    1.1059353  0.066961003    1.1524185 
  346000   0.99814584    1.0356474 -0.016510209    1.1432772 
  348000   0.97641572    1.1686199  0.046528576    1.1496039 
  350000   0.99518846    1.0517486   0.13448583    1.1381818 
  352000   0.98588655   0.98536282 -0.060862396    1.1294455 
  354000   0.96615995    1.1110151  0.083719861    1.1256268 
  356000    1.0078606   0.78439358  -0.10603102    1.1362455 
  358000   0.99367549    1.0489552   0.07500459    1.1427616 
  360000   0.98811261    1.0329632   0.02037644    1.1456498 
  362000   0.99543973   0.89319851  0.071618522    1.1516636 
  364000   0.98165417   0.88412777   0.01496297    1.1479466 
  366000   0.97321522    1.1989343   0.12226461    1.1407247 
  368000   0.98226259   0.98513508 -0.032773905     1.145514 
  370000   0.98523554   0.99191598  0.048321875    1.1454723 
  372000   0.99757543    1.0704533 -0.044499362    1.1397563 
  374000   0.96826544    1.0155716   0.10537727    1.1380956 
  376000   0.97764036   0.91461704 -0.0071326471    1.1311759 
  378000   0.96197183    1.2654546  0.063772824    1.1342523 
  380000    0.9563135   0.92013089   0.14946354     1.122797 
  382000   0.99157671    1.1416454 -0.0020281283    1.1146792 
  384000   0.99439496    1.0461009 -0.095485509    1.1101174 
  386000    0.9964491   0.96726205 -0.096570092    1.1043801 
  388000   0.98660387   0.92002862 -0.050238768    1.1028544 
  390000   0.97619357   0.95568771 -0.0093958893    1.0994103 
  392000   0.97043698    1.1278757  0.078765507    1.1095933 
  394000   0.97478556   0.93908482  0.010033169    1.0896552 
  396000   0.98483138   0.88172231 -0.0092943479    1.0731932 
  398000   0.99224177   0.84195437 -0.0059744644    1.0682901 
  400000    1.0140238   0.88969569  -0.14294787    1.0626823 
  402000   0.98939257   0.91691411 0.0064466276    1.0892164 
  404000    0.9930004   0.91196344  -0.15724573    1.0852194 
  406000   0.98184881   0.93556127 -0.030604809    1.0779626 
  408000    1.0097979   0.97009028 -0.011737511    1.0779471 
  410000    0.9913927    0.9406984 0.00091540813    1.0902918 
  412000   0.95799086    1.1298786  -0.03512312    1.1138864 
  414000    1.0089501   0.84475916   0.13645298    1.1142398 
  416000    0.9897256   0.98316262  0.010485716    1.1164657 
  418000    1.0133333   0.86050241  0.055260598    1.1048567 
  420000   0.97407581   0.97216618  0.098782939    1.1125666 
  422000    1.0009494   0.88470049  0.038139624    1.1163397 
  424000   0.97321563    1.1466493 -0.086272829    1.1173945 
  426000   0.96442304    1.0810966 -0.061944411    1.1068751 
  428000    0.9982547   0.87602547  0.081196445    1.1070854 
  430000   0.97915448    1.1485682 -0.065531916    1.1259179 
  432000   0.96422041    1.1298461 -0.0082763069    1.1175144 
  434000   0.99510123    1.0224406  -0.11423626    1.1160931 
  436000    1.0240236   0.88695443 0.0075708194    1.1085978 
  438000   0.99001944    1.0244717  0.075879487    1.1212094 
  440000    1.0116423   0.89412767  -0.11768379    1.1190682 
  442000   0.98993631   0.92631483  0.067324168     1.111235 
  444000   0.95107091    1.1508927 0.0019160629    1.1098578 
  446000   0.98621381   0.91043895 -0.061521131    1.1148618 
  448000   0.97695569     1.177126  -0.05322695    1.1104409 
  450000   0.99066051   0.99745105  0.080431605    1.1058023 
  452000    1.0146071   0.95227428  0.007801217    1.1249178 
  454000   0.99162513   0.96925579 -0.036153968    1.1100001 
  456000    1.0215781   0.88427275 -0.050979723    1.1071667 
  458000   0.98021089   0.84902388   0.08620799    1.1003492 
  460000   0.98981752    1.0990911  0.047765387    1.1091971 
  462000   0.97418524     1.023144  -0.11243577     1.101482 
  464000   0.98172755    1.0676962  0.065603574    1.0966983 
  466000   0.99352242   0.88377489   0.11849997    1.0934089 
  468000    0.9916114    0.9404547  0.041191002    1.0843991 
  470000    0.9675487    1.0416201  0.038992075    1.0909162 
  472000   0.97960188    1.0249638    0.1102279     1.087763 
  474000   0.97114134    1.1160983  0.046857123    1.0919439 
  476000   0.99567674   0.93675154  -0.06832563    1.0879316 
  478000    0.9784867    1.0660872 0.0030176417    1.0834439 
  480000   0.99936399   0.97607692  0.096835801    1.0780983 
  482000    1.0274496   0.87081314  0.054818419    1.0724507 
  484000   0.97139265    1.0730706  -0.12345378    1.0754362 
  486000   0.97408298   0.99765268 -0.0064488819    1.0691212 
  488000    0.9873109    1.0488011  0.001679366    1.0680362 
  490000    1.0289514   0.77625996 -0.090952895    1.0799008 
  492000   0.98122494   0.97560083  0.068756789    1.0746541 
  494000    1.0009648    1.0046735  0.013556863     1.074882 
  496000   0.96262432   0.94043431   -0.1359217     1.078487 
  498000      1.00248    1.1101056 -0.065062628    1.0774483 
  500000     0.964375    1.1119972  0.062483884    1.0744491 
Loop time of 78.4755 on 1 procs for 500000 steps with 800 atoms

Pair  time (%) = 54.1325 (68.9801)
Neigh time (%) = 12.1352 (15.4637)
Comm  time (%) = 1.85499 (2.36378)
Outpt time (%) = 0.00424814 (0.00541334)
Other time (%) = 10.3486 (13.1871)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    267 ave 267 max 267 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5583 ave 5583 max 5583 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5583
Ave neighs/atom = 6.97875
Neighbor list builds = 58699
Dangerous builds = 0

variable         eta equal v_v11
print            "running average viscosity: ${eta}"
running average viscosity: 1.0744491378557243788
