LAMMPS (10 Sep 2013)
# sample LAMMPS input script for viscosity of 2d LJ liquid
# NEMD via fix deform and fix nvt/sllod

# settings

variable	x equal 20
variable	y equal 20

variable	rho equal 0.6
variable        t equal 1.0
variable	rc equal 2.5

variable	srate equal 2.7

# problem setup

units		lj
dimension	2
atom_style	atomic
neigh_modify	delay 0 every 1

# problem setup

lattice         sq2 ${rho}
lattice         sq2 0.5999999999999999778
Lattice spacing in x,y,z = 1.82574 1.82574 1.82574
region          simbox prism 0 $y 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 $y -0.1 0.1 0.0 0.0 0.0
region          simbox prism 0 20 0 20 -0.1 0.1 0.0 0.0 0.0
create_box      1 simbox
Created triclinic box = (0 0 -0.182574) to (36.5148 36.5148 0.182574) with tilt (0 0 0)
  1 by 1 by 1 MPI processor grid
create_atoms    1 box
Created 800 atoms

pair_style      lj/cut ${rc}
pair_style      lj/cut 2.5
pair_coeff      * * 1 1

mass            * 1.0
velocity        all create $t 97287
velocity        all create 1 97287

fix             1 all nve
fix	        2 all langevin $t $t 0.1 498094
fix	        2 all langevin 1 $t 0.1 498094
fix	        2 all langevin 1 1 0.1 498094
fix	        3 all enforce2d

# equilibration run

thermo          1000
run	        5000
Memory usage per processor = 2.07097 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0            1     -1.56492            0     -0.56617    -1.535262 
    1000    0.9455393    -1.573329            0  -0.62897162   0.91884199 
    2000    1.0359047   -1.6229551            0  -0.58834528   0.96136682 
    3000    1.0171488   -1.5468681            0  -0.53099077    1.1078235 
    4000    1.0040221   -1.5977142            0  -0.59494717   0.92428924 
    5000   0.95883045   -1.6087309            0  -0.65109902   0.92015626 
Loop time of 0.995848 on 1 procs for 5000 steps with 800 atoms

Pair  time (%) = 0.530232 (53.2443)
Neigh time (%) = 0.155753 (15.6403)
Comm  time (%) = 0.0214312 (2.15206)
Outpt time (%) = 5.38826e-05 (0.00541073)
Other time (%) = 0.288377 (28.958)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    266 ave 266 max 266 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5604 ave 5604 max 5604 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5604
Ave neighs/atom = 7.005
Neighbor list builds = 548
Dangerous builds = 0

unfix  	        1
unfix		2

# turn on NEMD shear and equilibrate some more

velocity	all scale $t
velocity	all scale 1

variable	xyrate equal ${srate}/lx
variable	xyrate equal 2.7000000000000001776/lx

fix		1 all nvt/sllod temp $t $t 0.1
fix		1 all nvt/sllod temp 1 $t 0.1
fix		1 all nvt/sllod temp 1 1 0.1
fix		2 all deform 1 xy erate ${xyrate} remap v
fix		2 all deform 1 xy erate 0.07394254526319743448 remap v
fix		4 all ave/spatial 20 250 5000 y center 0.05 vx 		  units reduced file profile.nemd.2d

compute		usual all temp
compute		tilt all temp/deform

thermo          1000
thermo_style	custom step temp c_usual epair etotal press pxy
thermo_modify	temp tilt
run		50000
Memory usage per processor = 2.07189 Mbytes
Step Temp usual E_pair TotEng Press Pxy 
    5000    2.2074694            1   -1.6087309   0.59597912    1.6684031  -0.13173607 
    6000   0.91633679    1.0719617   -1.6395918  -0.72440047   0.75849191 -0.095097981 
    7000    1.0124825    1.1977616   -1.6934341  -0.68221723   0.70703149  -0.15913906 
    8000    1.0360742     1.244051   -1.6664702  -0.63169111   0.87208594  -0.17196758 
    9000   0.97397154    1.2397496   -1.6727765   -0.7000224   0.80220669  -0.11127356 
   10000   0.95658497    1.2726404   -1.6735904  -0.71820119   0.67518534  0.021843949 
   11000   0.99924023    1.3580428     -1.67571  -0.67771886   0.70353983 -0.095458782 
   12000    1.0433584    1.3936154   -1.6710176   -0.6289634   0.78515023  -0.10560886 
   13000    1.0405816    1.4490361   -1.6830775  -0.64379669   0.61832448  -0.11781994 
   14000    1.0497802    1.4357015   -1.6534549  -0.60498685   0.76907329  0.017545708 
   15000   0.96121525    1.3821511   -1.6498177  -0.68980398   0.95020534 -0.080877133 
   16000    1.0267815    1.4361052   -1.6538729  -0.62837492   0.68232896 -0.070333365 
   17000   0.93630695    1.3935392   -1.6232359  -0.68809929   0.76153713 0.0065771149 
   18000    1.0096924    1.5362618   -1.6690032  -0.66057292   0.74673844 -0.0020401284 
   19000   0.98814671    1.4707103   -1.6447486  -0.65783707   0.72488074  -0.13287245 
   20000   0.99667627    1.5457608   -1.6408152  -0.64538473   0.60598401 -0.0076374847 
   21000   0.98153893    1.5408205   -1.6148102  -0.63449823   0.80827079  -0.13251983 
   22000    1.0074242    1.6101043   -1.6422641  -0.63609914   0.90042046  -0.24385712 
   23000   0.95365942    1.5736051   -1.6412154  -0.68874806    0.8559935   -0.2467715 
   24000   0.98446077    1.5616505   -1.6395606  -0.65633045   0.73483641  -0.08920475 
   25000    1.0485516    1.6856359   -1.6399653   -0.5927244   0.84977844 -0.075926647 
   26000   0.96582655    1.5721629   -1.5882566  -0.62363728   0.81869074  0.090152592 
   27000   0.97557823    1.6668575   -1.6191458  -0.64478708   0.91081614  -0.19376266 
   28000    1.0303654    1.6964024   -1.6092391   -0.5801616   0.86334845  -0.17578668 
   29000    1.0622338    1.7710626   -1.6229948   -0.5620888   0.99336949  -0.14536132 
   30000   0.96943779    1.6600645   -1.6139092   -0.6456832    0.9989094  -0.02138527 
   31000   0.93832908    1.6925042   -1.6176446  -0.68048846   0.95346065  -0.17742851 
   32000    0.9875824     1.725668   -1.6119922  -0.62564431   0.96558919 -0.043195696 
   33000   0.99760198    1.7058006   -1.6052067  -0.60885172   0.98003863   -0.1333913 
   34000    1.0279367    1.7569574    -1.599245   -0.5725932   0.92585533  -0.16404413 
   35000   0.93404083    1.7440669   -1.6103769  -0.67750362   0.85837384  -0.23365559 
   36000     1.050384    1.8439426   -1.6563916  -0.60732054   0.67392288  -0.10063943 
   37000   0.94243088    1.7640322   -1.6138567   -0.6726039   0.96591044 -0.027194268 
   38000   0.98755975    1.8113344   -1.6079596  -0.62163426    1.0223699    -0.201769 
   39000    1.0420603    1.8627119   -1.5973478     -0.55659    1.0381788   0.12071081 
   40000    1.0335545    1.8837126   -1.5851743   -0.5529117   0.94822902  -0.10987028 
   41000   0.94213103    1.8188004   -1.6049587  -0.66400536   0.97923033   0.01154085 
   42000    1.0356435    1.8901318   -1.6212526  -0.58690373   0.95585859  -0.19557187 
   43000   0.99015606    1.8799525   -1.6090628  -0.62014448    0.9274227   -0.2300794 
   44000    1.0161294    1.9551452   -1.6180455  -0.60318623    1.0355228  -0.12706459 
   45000   0.98674382    1.8916077   -1.6468656  -0.66135521   0.78299308  -0.15774308 
   46000    1.0113469    1.9533202   -1.5957721  -0.58568941   0.78737351   0.13820702 
   47000    1.0571363    1.9631114   -1.5772356  -0.52142074   0.95792606  0.029844288 
   48000   0.94855706    1.8697175   -1.6015863  -0.65421497   0.90993104  -0.34180657 
   49000    1.0607674    1.9704564   -1.5868247  -0.52738329    1.0716947 -0.034892185 
   50000   0.97263672    1.9338729   -1.6082924  -0.63687146    1.0235045  -0.16412663 
   51000    1.0378868    1.9671463   -1.5809392  -0.54434973    1.1981016  0.057155145 
   52000     1.005245    1.9432386   -1.6053723  -0.60138379   0.96669621  -0.04065554 
   53000    1.0051888    1.9494803    -1.592364  -0.58843173   0.94235557 -0.082756851 
   54000   0.98792555    1.9333497   -1.5977723   -0.6110817    1.0539616 -0.052439197 
   55000    1.0215148    1.9761517   -1.6026169  -0.58237902   0.98461466 -0.014054852 
Loop time of 13.2512 on 1 procs for 50000 steps with 800 atoms

Pair  time (%) = 5.62991 (42.486)
Neigh time (%) = 3.31133 (24.9889)
Comm  time (%) = 0.333608 (2.51757)
Outpt time (%) = 0.00183129 (0.0138198)
Other time (%) = 3.97453 (29.9937)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    276 ave 276 max 276 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5608 ave 5608 max 5608 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5608
Ave neighs/atom = 7.01
Neighbor list builds = 11158
Dangerous builds = 0

# data gathering run

variable	visc equal -pxy/(v_srate/ly)
fix		vave all ave/time 10 100 1000 v_visc ave running start 56000

thermo_style	custom step temp press pxy v_visc f_vave
WARNING: New thermo_style command, previous thermo_modify settings will be lost (../output.cpp:664)
thermo_modify	temp tilt

#dump	        1 all custom 10 dump.nemd.2d id type x y z vx

run		50000
Memory usage per processor = 2.11211 Mbytes
Step Temp Press Pxy visc vave 
   55000    1.0215148   0.98406243 -0.015573121    0.2106111            0 
   56000   0.97676391    0.7935725 -0.097217766    1.3147744   0.94442622 
   57000   0.98121663   0.97189374  -0.09906427    1.3397466    1.0348472 
   58000   0.99072249    1.0185041   -0.1107535    1.4978319    1.1148823 
   59000    1.0339566    1.1930503  -0.11512608    1.5569667     1.136778 
   60000   0.96659848   0.92099027 -0.040929962   0.55353737    1.1425378 
   61000   0.91281753   0.94424526 0.0057649576 -0.077965366    1.1569145 
   62000   0.94858877    1.0998838 -0.017149668   0.23193235    1.1483313 
   63000   0.95337651   0.89712297  -0.11187696    1.5130256    1.2009105 
   64000    1.0210948    0.9602771 -0.054478663   0.73677019    1.2148796 
   65000    1.0504997   0.94778551  -0.15854746    2.1441981    1.2093498 
   66000   0.98082278    1.0669108 -0.079622124    1.0768107    1.2394021 
   67000     1.004502    1.0176002 0.0064462478 -0.087179144    1.2171347 
   68000   0.92374901   0.71524627  -0.16232949    2.1953463    1.2280608 
   69000    1.0515117    1.1458523   0.10895185   -1.4734664    1.2214747 
   70000    1.0555502     1.076672 -0.042203866   0.57076567      1.19651 
   71000    0.9770682     1.180182  -0.13504139    1.8263016    1.1565664 
   72000    1.0086134     1.022067 -0.037398667   0.50578009    1.1850636 
   73000    1.0162758     1.120033 -0.059765955    0.8082756    1.1911215 
   74000   0.99405946   0.89203552  -0.24842296    3.3596755    1.1878296 
   75000   0.98750361   0.94382542  -0.22651557    3.0633996     1.185964 
   76000    1.0464263    1.2902475 -0.054604453   0.73847137    1.1830982 
   77000   0.97443033    0.9748021   -0.0188378   0.25476266    1.1807479 
   78000    1.0458063    1.0029976 -0.073834161   0.99853421    1.1713126 
   79000    1.0144775     1.218542  0.062883654   -0.8504394    1.1810856 
   80000    1.0114425   0.86457858 0.0071905047 -0.097244484    1.1826166 
   81000   0.94134141   0.77988469  -0.12039379    1.6282073    1.1949499 
   82000    1.0043004    1.1044886 -0.071274637   0.96391918    1.1858594 
   83000    1.0183148   0.97315487  -0.17878927    2.4179486    1.1847614 
   84000    1.0089223   0.94988998  -0.14706747    1.9889425     1.186726 
   85000   0.99683237    1.1387674 -0.093287095     1.261616    1.1950365 
   86000   0.98703013   0.90123949 -0.071666603   0.96922013    1.1994887 
   87000   0.98715174    1.0031198  0.073329807  -0.99171332    1.2030095 
   88000   0.98802533     0.780636  -0.18839651     2.547877     1.206866 
   89000   0.98607737    1.0366379  -0.16016943    2.1661336    1.2122118 
   90000    1.0210319    1.0157699 -0.036734636   0.49679972    1.2136124 
   91000    1.0383205    1.0432409   -0.2294371    3.1029105    1.2119958 
   92000    1.0552856    1.2186718 -0.013410875   0.18136886    1.2082849 
   93000    1.0114907     1.075338 0.0035134444  -0.04751587    1.2094306 
   94000   0.94044675     1.054018  0.085446493   -1.1555795     1.203052 
   95000    1.0158089   0.97472916  -0.11967767    1.6185225    1.2030168 
   96000     1.020383   0.89405366  -0.14288077    1.9323215    1.2030977 
   97000   0.96955936    1.0480423  -0.11860582    1.6040268    1.2056096 
   98000    1.0091452   0.84288535   -0.1289184    1.7434942    1.1994042 
   99000   0.99665723    1.0303263  -0.02254625    0.3049158     1.194661 
  100000   0.94019285   0.98342349 -0.069073187   0.93414673    1.1935304 
  101000    1.0351616    1.0994068 -0.089112502    1.2051587    1.1778161 
  102000   0.94550389    1.0840839 -0.093572091    1.2654702    1.1855211 
  103000    1.0384124    1.0513178 -0.053925313   0.72928668    1.1787243 
  104000    1.0561611   0.87476291  -0.13807613    1.8673434    1.1807725 
  105000    1.0046808   0.95999328  0.015725114  -0.21266665    1.1820494 
Loop time of 13.826 on 1 procs for 50000 steps with 800 atoms

Pair  time (%) = 5.72616 (41.4159)
Neigh time (%) = 3.64084 (26.3333)
Comm  time (%) = 0.359706 (2.60167)
Outpt time (%) = 0.0011127 (0.00804788)
Other time (%) = 4.09817 (29.6411)

Nlocal:    800 ave 800 max 800 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    264 ave 264 max 264 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    5616 ave 5616 max 5616 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 5616
Ave neighs/atom = 7.02
Neighbor list builds = 12198
Dangerous builds = 0
