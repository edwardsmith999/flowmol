#######################################################################
# This input file has been included for base-case simulation setup, and 
# is designed to be read-only on the version-control server. Please 
# create a copy of this file called 'MD.in' (the default input file name 
# in the main code) if you would like to change the simulation 
# parameters.
# -----------------------------------------------------------------------

#------------------------------------------------------------------------
#########################################################################

			#### ##    ## ########  ##     ## ########    
			 ##  ###   ## ##     ## ##     ##    ##      
			 ##  ####  ## ##     ## ##     ##    ##     
			 ##  ## ## ## ########  ##     ##    ##    
			 ##  ##  #### ##        ##     ##    ##   
			 ##  ##   ### ##        ##     ##    ##  
			#### ##    ## ##         #######     ## 

#########################################################################
#------------------------------------------------------------------------
#########################################################################
# Boundary force flag and distances, formatted:
#   bforce_flag(1) (x direction, bottom)           (integer)
#   bforce_flag(2) (x direction, top)              (integer)
#   bforce_flag(3) (y direction, bottom)           (integer)
#   bforce_flag(4) (y direction, top)              (integer)
#   bforce_flag(5) (z direction, bottom)           (integer)
#   bforce_flag(6) (z direction, top)              (integer)
#   bforce_dxyz(1) (x distance, bottom)            (real)
#   bforce_dxyz(2) (x distance, top)               (real)
#   bforce_dxyz(3) (y distance, bottom)            (real)
#   bforce_dxyz(4) (y distance, top)               (real)
#   bforce_dxyz(5) (z distance, bottom)            (real)
#   bforce_dxyz(6) (z distance, top)               (real)
#
# If periodic boundaries in x, y or z directions are turned off, the
# option to apply a boundary force to keep molecules within the domain
# is provided via the bforce flag. Choose from the following in each
# direction:
#
#    0 = off 
#    1 = O'Connell & Thompson     1995  (Phys. Rev. E 52, 5792)
#    2 = Nie, Chen, E & Robbins   2003  (JFM 500 pp. 55-64)
#    3 = Flekkøy, Wagner & Feder  2000  (Europhys. Lett. 52 3, p271)
#    4 = boundary force pdf input file ./bforce.input 
#
# bforce_dxyz defines the distance from each edge of the domain beyond 
# which any particle will no longer feel the effect of the boundary 
# force. Low values correspond to hard walls, while larger values will
# make the boundaries softer.
# -----------------------------------------------------------------------
BFORCE
0
0
0
2
0
0
0.0
0.0
0.0
5.129
0.0
0.0

#########################################################################
# Initial configuration
#
#    0 - FCC Lattice
#
#    1 - Special case, must be followed by string on next line. This
#        string must be lower case, so the same string in capitals is
#        reserved as an input flag for information about the special
#        case. Options:
#
#            - solid_liquid
#                 tethered walls of different density to fluid
#
#            - dense_fene     
#                 connect monomers on an FCC lattice with a specified 
#                 chain length and FENE potential parameters. 
#
#            - sparse_fene    
#                 connect monomers on a cubic lattice
#                 separated by FENE equilibrium distance
#
#            - concentric_cylinders
#                 build concentric cylinders from an FCC lattice
#                 and melt them between specular walls
#
#            - fill_cylinders 
#                 tether concentric cylinders from previous
#                 simulation to their initial sites, and fill them
#                 with fluid 
#
#            - fill_cylinders_fene_solution
#                 tether concentric cylinders from previous
#                 simulation to their initial sites, and fill them
#                 with FENE solution fluid 
#
#            - rotate_cylinders
#                 restart from filled cylinder restart file and
#                 rotate the inner cylinder with specified
#                 angular velocity 
#            
#            - polymer_brush
#                 solid_liquid, walls different density to fluid,
#                 polymers attached to surface. 
#
#    2 - Configuration file, like a *.pdb. To be developed.
#
# -----------------------------------------------------------------------
INITIAL_CONFIG_FLAG
1
polymer_brush

POLYMER_BRUSH
40
30.0
1.5
0.1

#########################################################################
# Number density of the particles in the system:
# -----------------------------------------------------------------------
DENSITY
0.8
LIQUIDDENSITY
0.4

#########################################################################
# Cut-off distance for particle interaction:
#	2^(1/6) = 1.12246204830937
# -----------------------------------------------------------------------
RCUTOFF
1.12246204830937

#########################################################################
# Define initial temperature of the system:
#	- determines magnitude of initial random velocities
# -----------------------------------------------------------------------
INPUTTEMPERATURE
1.0

INITIAL_CONFIG_FLAG
0

#########################################################################
# Number of unit cells in the x,y,z directions, formatted:
#	x
#	y
#	z	
# -----------------------------------------------------------------------
INITIALNUNITS
96
30
24

#########################################################################
# Total number of timesteps:
# -----------------------------------------------------------------------
NSTEPS
150000


#########################################################################
# Results are recorded periodically every TPLOT timesteps:
#	(subroutine simulation_record is called)
# -----------------------------------------------------------------------
TPLOT
15

#########################################################################
# Timestep interval:
# -----------------------------------------------------------------------
DELTA_T
0.005

#########################################################################
# Integration algorithm
# 0: Leap-frog Verlet
# 1: Velocity Verlet
# 2: Other
# -----------------------------------------------------------------------
INTEGRATION_ALGORITHM
0

#########################################################################
# Force list used
# 0: All Pairs
# 1: Cell List
# 2: Neighbour list with all interactions
# 3: Neighbour list using 3rd law optimisation (half interactions)
# -----------------------------------------------------------------------
FORCE_LIST
3

#########################################################################
# Extra distance added to r_cutoff to determine neighbour cell size
# -----------------------------------------------------------------------
DELTA_RNEIGHBR
0.3


#########################################################################
# Ensemble selector: case sensitive! 
# 0 - NVE
# 1 - NVT (Nosé-Hoover thermostat)
# 2 - NVT (Gaussian iso-kinetic thermostat) - only availble with VV
# 3 - NVT (Profile unbiased Nosé-Hoover thermostat)
# 4 - NVT (Pairwise additive Nosé-Hoover thermostat by Allen & Schmid)
# 5 - NVT (DPD thermostat by Soddemann, Dunweg an Kremer Phys Rev E 68, 046702 (2003))
# 6 - TAG system - specify fixed wall and localised thermostatting
# -----------------------------------------------------------------------
ENSEMBLE
6

#########################################################################
# Periodic boundary flags, formatted:
#	x
#	y
#	z
#
#	Constraint must be put in place before periodic BC are turned off!
#	
#	0 - off
#	1 - periodic
#	2 - Lees-Edwards shearing BC
#
#	Note: currently, only the boundary in the y direction may be sheared.
# -----------------------------------------------------------------------
PERIODIC
1
0
1


#########################################################################
# Specular walls
# Specifiy the distance from the top and bottom of the domain of the 
# specular wall. Molecules are reflected if they pass this wall
#   specular_wall(1) (x direction, top & bottom)	(dp real)
#   specular_wall(2) (y direction, top & bottom)	(dp real)
#   specular_wall(3) (z direction, top & bottom)	(dp real)
#
# -----------------------------------------------------------------------
SPECULAR_WALL
0.0
0.1
0.0

#########################################################################
# Shear definition, formatted:
#	shear direction (i.e. 1 for x direction, -2 for negative y direction)
#	shear iter0
#	velocity or rate flag: 0-velocity, 1-rate
#	numerical value
# -----------------------------------------------------------------------
DEFINE_SHEAR
1
0
0
1.0

#########################################################################
# Potential flag:
#	0 - Lennard-Jones
#	1 - FENE spring polymer potentials
# -----------------------------------------------------------------------
POTENTIAL_FLAG
0

#########################################################################
# Parameters of the FENE potential, formatted:
#	number of LJ beads for each polymer chain
#	spring constant, k_c
#	maximum spring elongation
# -----------------------------------------------------------------------
FENE_INFO
8
30.0
1.5

#########################################################################
# Random number seeds, formattted:
#	seed1
#	seed2
#	
# If seed1 and seed2 are the same, the seed generation will be
# automatically randomised by the main program.
# -----------------------------------------------------------------------
SEED
1
2


#########################################################################
# MPI topology
#   npx 
#   npy
#   npz
#
# if npz = 0 it will be set to nproc/(npx*npy)
#
# constrain: npx*npy*npz = nproc 
# nproc is set by the argument of mpirun
#-----------------------------------------------------------------------
PROCESSORS
8
2
2

########################################################################
# Velocity of sliding molecules in wall
# ----------------------------------------------------------------------
WALLSLIDEV
0.0
0.0
0.0

########################################################################
# Distance from domain bottom to apply sliding velocity to molecules 
# where applied velocity v=WALLSLIDEV
# ----------------------------------------------------------------------
SLIDEDISTBOTTOM
0.0
0.0
0.0

########################################################################
# Distance from domain top to apply sliding velocity to molecules 
# where applied velocity v=WALLSLIDEV
# ----------------------------------------------------------------------
SLIDEDISTTOP
0.0
0.0
0.0

########################################################################
# Distance from domain bottom to Fix molecules, i.e. v=0 unless sliding
# ----------------------------------------------------------------------
FIXDISTBOTTOM
0.0
0.0
0.0

########################################################################
# Distance from domain top to Fix molecules, i.e. v=0 unless sliding
# ----------------------------------------------------------------------
FIXDISTTOP
0.0
0.0
0.0

########################################################################
# Distance from domain bottom to tethered molecules using spring like
# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
# strength of tethering potential from Petravic and Harrowell 
# with constants (k4 = 5,000, k6 = 5,000,000)
# ----------------------------------------------------------------------
TETHEREDDISTBOTTOM
0.0
5.1299
0.0

########################################################################
# Distance from domain top to tethered molecules using spring like
# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
# strength of tethering potential from Petravic and Harrowell 
# with constants (k4 = 5,000, k6 = 5,000,000)
# ----------------------------------------------------------------------
TETHEREDDISTTOP
0.0
0.0
0.0


########################################################################
# Distance from domain bottom to apply thermostat 
# ----------------------------------------------------------------------
THERMSTATBOTTOM
0.0
5.1299
0.0

########################################################################
# Distance from domain top to apply thermostat 
# ----------------------------------------------------------------------
THERMSTATTOP
0.0
0.0
0.0

#------------------------------------------------------------------------
#########################################################################

	 #######  ##     ## ######## ########  ##     ## ######## 
	##     ## ##     ##    ##    ##     ## ##     ##    ##    
	##     ## ##     ##    ##    ##     ## ##     ##    ##    
	##     ## ##     ##    ##    ########  ##     ##    ##    
	##     ## ##     ##    ##    ##        ##     ##    ##    
	##     ## ##     ##    ##    ##        ##     ##    ##    
	 #######   #######     ##    ##         #######     ##    

#########################################################################
#------------------------------------------------------------------------

#########################################################################
# Output flag for visualisation in VMD:
#	Flag: 	0-off, 
#			1-homogeneous, 
#			2-solid/liquid,
#	      	3-homogeneous+halos, 
#			4-Debug
#	Number of intervals: 0-all, 1 to 20-specified in csv format below
#						20 or more-all
#	Intervals: start and finish iteration of each interval in format
#	       start_1, finish_1, start_2, finish_2, etc, etc
# -----------------------------------------------------------------------
VMD_OUTFLAG
0
0

#########################################################################
# Output flag for macroscopic properties:
#	0 - off
#	1 - print to terminal
#	2 - output file + print to terminal
# -----------------------------------------------------------------------
MACRO_OUTFLAG
1

#########################################################################
# Output flag for mass record:
#	output_flag (0=off 1,2,3=x,y,z slice 4=3D bins)
#	No. of samples for mass average
# -----------------------------------------------------------------------
MASS_OUTFLAG
0
1

#########################################################################
# Output flag for Velocity record:
#	output_flag (0=off 1,2,3=x,y,z slice 4=3D bins)
#	No. of samples for velocity average
# -----------------------------------------------------------------------
VELOCITY_OUTFLAG
4
100

#########################################################################
# Output flag for Velocity record:
#	output_flag (0=off 1,2,3=x,y,z slice 4=3D bins)
#	No. of samples for velocity average
# -----------------------------------------------------------------------
TEMPERATURE_OUTFLAG
0
100

#########################################################################
# Output flag for Pressure binning:
#	output_flag (0=off 1=virial 2=Volume Averaged)
#	No. of samples for pressure average (number of viscosity bins)
#	Seperate kinetic and configurational 0 = together 1=seperate
# -----------------------------------------------------------------------
PRESSURE_OUTFLAG
2
100
0

#########################################################################
# Output flag for viscosity:
#	output_flag (0=off 1=virial 2=Volume Averaged)
#	No. of Steps to average viscosity sample bins over 
#
# Note that Visc output freq = (PRESSURE_visc_bins*visc_ave_steps)
# -----------------------------------------------------------------------
VISCOSITY_OUTFLAG
0
10


#########################################################################
## Control Volume Conservation Averaging
##	CV Conservation averaging (0=off 1=on) - take mass, momentum or 
##	energy flux measure every step to ensureflux will be equal to change 
##	in snapshots. Note, this increases computational cost somewhat
##
## -----------------------------------------------------------------------
CV_CONSERVE
0

#########################################################################
# Output flag for mass flux:
#	output_flag (0=off 1=3D CV)
#	No. of samples for mass flux & interval for CV mass snapshot
#
# -----------------------------------------------------------------------
MFLUX_OUTFLAG
0
1500

#########################################################################
# Output flag for velocity flux:
#	output_flag (0=off 1,2,3=x,y,z MOP 4=3D CV)
#	No. of samples for momentum flux/pressure & CV momentum snapshots
#
# -----------------------------------------------------------------------
VFLUX_OUTFLAG
0
1500

#########################################################################
# Output flag for energy flux:
#	output_flag (0=off 1,2,3=x,y,z MOP 4=3D CV)
#	No. of samples for energy flux/power & CV energy snapshots
#
# -----------------------------------------------------------------------
EFLUX_OUTFLAG
0
1

#########################################################################
# Output flag for end-to-end vector time correlation function (etevtcf):
#	- flag (0-off,1-print to terminal,2-write to output file)
#	- iteration at which to begin averaging (must be "hit" by a tplot, 
#	  otherwise etev_0 will not be initialised and the t.c.f. will be
#	  incorrectly calculated.
# -----------------------------------------------------------------------
ETEVTCF_OUTFLAG
0
0

#########################################################################
# Radius of gyration output flag:
#	0 - off
#	1 - on
# -----------------------------------------------------------------------
R_GYRATION_OUTFLAG
0
0

#########################################################################
# Radial distribution output flag
#	- flag: 
#		> 0 - off
#		> 1 - on
#	- maximum radius for the calculation of g(r)
#	- number of radial "shells" or "bins"
# -----------------------------------------------------------------------
RADIALDIST_OUTFLAG
0
3.5
100

#########################################################################
# Static structure factor output flag
#	- flag: 
#		> 0 - off
#		> 1 - on
#	- projection axis 1 (x=1,y=2,z=3)
#   - projection axis 2 (x=1,y=2,z=3)
#	- maximum wavenumber n, where k = 2*pi*n/domain
# -----------------------------------------------------------------------
STRUCT_OUTFLAG
0
1
2
50
