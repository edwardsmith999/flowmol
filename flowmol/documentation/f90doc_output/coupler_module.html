<HTML>
<HEAD>
   <TITLE> module coupler_module (generated by f90doc) </TITLE>
</HEAD>
<H1> Module coupler_module </H1>
<PRE>module coupler_module

        ! Uses
    use <A HREF="iso_c_binding.html">ISO_C_BINDING</A>

        ! Variables
    integer, public, parameter :: <A HREF="coupler_module.html#var_void">VOID</A> = -666
    integer, public, parameter :: <A HREF="coupler_module.html#var_cfd_realm">cfd_realm</A> = 1
    integer, public, parameter :: <A HREF="coupler_module.html#var_md_realm">md_realm</A> = 2
    character (len=*), public, parameter, dimension (2) :: <A HREF="coupler_module.html#var_realm_name">realm_name</A> = (/ "CFD", "MD " /)
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_realm">COUPLER_ERROR_REALM</A> = 1
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_one_realm">COUPLER_ERROR_ONE_REALM</A> = 2
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_init">COUPLER_ERROR_INIT</A> = 3
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_input_file">COUPLER_ERROR_INPUT_FILE</A> = 4
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_read_input">COUPLER_ERROR_READ_INPUT</A> = 5
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_continuum_force">COUPLER_ERROR_CONTINUUM_FORCE</A> = 6
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_abort_on_request">COUPLER_ABORT_ON_REQUEST</A> = 7
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_abort_send_cfd">COUPLER_ABORT_SEND_CFD</A> = 8
    integer, public, parameter :: <A HREF="coupler_module.html#var_coupler_error_cart_comm">COUPLER_ERROR_CART_COMM</A> = 9
    integer, public :: <A HREF="coupler_module.html#var_ierr">ierr</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_world_comm">CPL_WORLD_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_realm_comm">CPL_REALM_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_inter_comm">CPL_INTER_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_cart_comm">CPL_CART_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_olap_comm">CPL_OLAP_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_graph_comm">CPL_GRAPH_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cpl_realm_intersection_comm">CPL_REALM_INTERSECTION_COMM</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_realm">realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_myid_world">myid_world</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rank_world">rank_world</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rootid_world">rootid_world</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_myid_realm">myid_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rank_realm">rank_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rootid_realm">rootid_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_myid_cart">myid_cart</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rank_cart">rank_cart</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rootid_cart">rootid_cart</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_myid_olap">myid_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rank_olap">rank_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_cfdid_olap">CFDid_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_myid_graph">myid_graph</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_rank_graph">rank_graph</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_mdrealm">rank_world2rank_mdrealm</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_mdcart">rank_world2rank_mdcart</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_cfdrealm">rank_world2rank_cfdrealm</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_cfdcart">rank_world2rank_cfdcart</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_olap">rank_world2rank_olap</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_graph">rank_world2rank_graph</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_world2rank_inter">rank_world2rank_inter</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_mdrealm2rank_world">rank_mdrealm2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_mdcart2rank_world">rank_mdcart2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_cfdrealm2rank_world">rank_cfdrealm2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_cfdcart2rank_world">rank_cfdcart2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_olap2rank_world">rank_olap2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_graph2rank_world">rank_graph2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_inter2rank_world">rank_inter2rank_world</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_rank_olap2rank_realm">rank_olap2rank_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nproc_md">nproc_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nproc_cfd">nproc_cfd</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nproc_olap">nproc_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nproc_world">nproc_world</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npx_md">npx_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npy_md">npy_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npz_md">npz_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npx_cfd">npx_cfd</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npy_cfd">npy_cfd</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_npz_cfd">npz_cfd</A>
    logical, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_olap_mask">olap_mask</A>
    integer, public, protected, dimension(:,:), allocatable :: <A HREF="coupler_module.html#var_rank2coord_cfd">rank2coord_cfd</A>
    integer, public, protected, dimension(:,:), allocatable :: <A HREF="coupler_module.html#var_rank2coord_md">rank2coord_md</A>
    integer, public, protected, dimension(:,:,:), allocatable :: <A HREF="coupler_module.html#var_coord2rank_cfd">coord2rank_cfd</A>
    integer, public, protected, dimension(:,:,:), allocatable :: <A HREF="coupler_module.html#var_coord2rank_md">coord2rank_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_iblock_realm">iblock_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jblock_realm">jblock_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kblock_realm">kblock_realm</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncx">ncx</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncy">ncy</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncz">ncz</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmin">icmin</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmax">icmax</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmin">jcmin</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmax">jcmax</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmin">kcmin</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmax">kcmax</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmin_olap">icmin_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmax_olap">icmax_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmin_olap">jcmin_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmax_olap">jcmax_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmin_olap">kcmin_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmax_olap">kcmax_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncx_olap">ncx_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncy_olap">ncy_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_ncz_olap">ncz_olap</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_constraint_algo">constraint_algo</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_constraint_cvflag">constraint_CVflag</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmin_cnst">icmin_cnst</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_icmax_cnst">icmax_cnst</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmin_cnst">jcmin_cnst</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_jcmax_cnst">jcmax_cnst</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmin_cnst">kcmin_cnst</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_kcmax_cnst">kcmax_cnst</A>
    integer, public, parameter :: <A HREF="coupler_module.html#var_constraint_off">constraint_off</A> = 0
    integer, public, parameter :: <A HREF="coupler_module.html#var_constraint_ot">constraint_OT</A> = 1
    integer, public, parameter :: <A HREF="coupler_module.html#var_constraint_ncer">constraint_NCER</A> = 2
    integer, public, parameter :: <A HREF="coupler_module.html#var_constraint_flekkoy">constraint_Flekkoy</A> = 3
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_icpmin_md">icPmin_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_icpmax_md">icPmax_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_jcpmin_md">jcPmin_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_jcpmax_md">jcPmax_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_kcpmin_md">kcPmin_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_kcpmax_md">kcPmax_md</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_icpmin_cfd">icPmin_cfd</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_icpmax_cfd">icPmax_cfd</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_jcpmin_cfd">jcPmin_cfd</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_jcpmax_cfd">jcPmax_cfd</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_kcpmin_cfd">kcPmin_cfd</A>
    integer, public, protected, dimension(:), allocatable :: <A HREF="coupler_module.html#var_kcpmax_cfd">kcPmax_cfd</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_xl_md">xL_md</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_yl_md">yL_md</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_zl_md">zL_md</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_xl_cfd">xL_cfd</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_yl_cfd">yL_cfd</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_zl_cfd">zL_cfd</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_xl_olap">xL_olap</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_yl_olap">yL_olap</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_zl_olap">zL_olap</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_xll">xLl</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_yll">yLl</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_zll">zLl</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dx">dx</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dy">dy</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dz">dz</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dymin">dymin</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dymax">dymax</A>
    real (kind=kind (0.d0)), public, protected, dimension(:,:), allocatable, target :: <A HREF="coupler_module.html#var_xg">xg</A>
    real (kind=kind (0.d0)), public, protected, dimension(:,:), allocatable, target :: <A HREF="coupler_module.html#var_yg">yg</A>
    real (kind=kind (0.d0)), public, protected, dimension(:), allocatable, target :: <A HREF="coupler_module.html#var_zg">zg</A>
    integer, public, protected, dimension(:,:), allocatable :: <A HREF="coupler_module.html#var_cfd_icoord2olap_md_icoords">cfd_icoord2olap_md_icoords</A>
    integer, public, protected, dimension(:,:), allocatable :: <A HREF="coupler_module.html#var_cfd_jcoord2olap_md_jcoords">cfd_jcoord2olap_md_jcoords</A>
    integer, public, protected, dimension(:,:), allocatable :: <A HREF="coupler_module.html#var_cfd_kcoord2olap_md_kcoords">cfd_kcoord2olap_md_kcoords</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nsteps_md">nsteps_md</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nsteps_cfd">nsteps_cfd</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_nsteps_coupled">nsteps_coupled</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_average_period">average_period</A> = 1
    integer, public, protected :: <A HREF="coupler_module.html#var_save_period">save_period</A> = 10
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dt_md">dt_md</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_dt_cfd">dt_cfd</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_density_md">density_md</A>
    real (kind=kind (0.d0)), public, protected :: <A HREF="coupler_module.html#var_density_cfd">density_cfd</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_timestep_ratio">timestep_ratio</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_md_cfd_match_cellsize">md_cfd_match_cellsize</A>
    integer, public, protected :: <A HREF="coupler_module.html#var_testval">testval</A>
    logical, public, protected, dimension (3) :: <A HREF="coupler_module.html#var_staggered_averages">staggered_averages</A> = (/ .false., .false., .false. /)

        ! Interfaces
    public interface <A HREF="coupler_module.html#interface_error_abort">error_abort</A>

        ! Subroutines and functions
    public subroutine <A HREF="coupler_module.html#subroutine_cpl_create_comm">CPL_create_comm</A> (callingrealm, RETURNED_REALM_COMM, ierror)
    public subroutine <A HREF="coupler_module.html#subroutine_read_coupler_input">read_coupler_input</A> ()
    public subroutine <A HREF="coupler_module.html#subroutine_cpl_write_header">CPL_write_header</A> (header_filename)
    public subroutine <A HREF="coupler_module.html#subroutine_coupler_cfd_init">coupler_cfd_init</A> (nsteps, dt, icomm_grid, icoord, npxyz_cfd, xyzL, ncxyz, density, ijkcmax, ijkcmin, iTmin, iTmax, jTmin, jTmax, kTmin, kTmax, xgrid, ygrid, zgrid)
    public subroutine <A HREF="coupler_module.html#subroutine_coupler_md_init">coupler_md_init</A> (Nsteps, initialstep, dt, icomm_grid, icoord, npxyz_md, globaldomain, density)
    public subroutine <A HREF="coupler_module.html#subroutine_set_coupled_timing">set_coupled_timing</A> (Nsteps, initialstep)
    public subroutine <A HREF="coupler_module.html#subroutine_cpl_create_map">CPL_create_map</A> ()
    public subroutine <A HREF="coupler_module.html#subroutine_cpl_cfd_adjust_domain">CPL_cfd_adjust_domain</A> (xL, yL, zL, nx, ny, nz, density_output)
    public subroutine <A HREF="coupler_module.html#subroutine_cpl_rank_map">CPL_rank_map</A> (COMM, rank, nproc, comm2world, world2comm, ierr)
    public subroutine <A HREF="coupler_module.html#subroutine_locate">locate</A> (fileid, keyword, have_data)
    private subroutine <A HREF="coupler_module.html#subroutine_error_abort_s">error_abort_s</A> (msg)
    private subroutine <A HREF="coupler_module.html#subroutine_error_abort_si">error_abort_si</A> (msg, i)
    public subroutine <A HREF="coupler_module.html#subroutine_messenger_lasterrorcheck">messenger_lasterrorcheck</A> ()
    public subroutine <A HREF="coupler_module.html#subroutine_printf">printf</A> (buf, dplaces_in)
    public subroutine <A HREF="coupler_module.html#subroutine_write_matrix_int">write_matrix_int</A> (a, varname, fh)
    public subroutine <A HREF="coupler_module.html#subroutine_write_matrix">write_matrix</A> (a, varname, fh)

end module coupler_module
</PRE>
 COUPLER MODULE: 
 A single coupler module for both codes - this contains the same information 
 on both md and cfd side 
<P>
  <UL>
  <LI>  Error handling
  <LI>  MPI communicators
  <LI>  Simulation realms
  <LI>  MPI processor IDs
  <LI>  Processor topologies
  <LI>  Processor cartesian coords
  <LI>  Global cell grid parameters
  <LI>  Processor cell ranges
  <LI>  Domain and cell dimensions
  <LI>  Positions of CFD grid lines
  <LI>  CFD to MD processor mapping
  <LI>  Simulation parameters
<P>
  </UL>
 The data is protected so only setup routines in this module can change it
 Setup routines which have access to coupler parameters
<P>
 <UL>
 <LI>  CPL_create_comm          (cfd+md)   splits MPI_COMM_WORLD, create inter - 
                                       communicator between CFD and MD
<P>
 <LI>  CPL_create_map           (cfd+md)   creates correspondence maps between 
                                       the CFD grid and MD domains
<P>
 <LI>  CPL_cfd_adjust_domain     (cfd)     adjust CFD tomain to an integer number 
                                       FCC or similar MD initial layout
 </UL>
<P>
<STRONG>Author:</STRONG> David Trevelyan, Edward Smith
<P>
<STRONG>See also:</STRONG> module <A HREF="coupler.html">coupler</A>

<HR><H2> Description of Variables </H2>
<A NAME="var_void"><H3>VOID</H3></A>
<PRE>integer, public, parameter :: VOID = -666
</PRE>
VOID value for data initialisation
<A NAME="var_cfd_realm"><H3>cfd_realm</H3></A>
<PRE>integer, public, parameter :: cfd_realm = 1
</PRE>
 CFD realm identifier
<A NAME="var_md_realm"><H3>md_realm</H3></A>
<PRE>integer, public, parameter :: md_realm = 2
</PRE>
 MD realm identifier
<A NAME="var_realm_name"><H3>realm_name</H3></A>
<PRE>character (len=*), public, parameter, dimension (2) :: realm_name = (/ "CFD", "MD " /)
</PRE>
 Used with realm identifier to get name
<A NAME="var_coupler_error_realm"><H3>COUPLER_ERROR_REALM</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_REALM = 1
</PRE>
 error codes
 wrong realm value
<A NAME="var_coupler_error_one_realm"><H3>COUPLER_ERROR_ONE_REALM</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_ONE_REALM = 2
</PRE>
 one realm missing
<A NAME="var_coupler_error_init"><H3>COUPLER_ERROR_INIT</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_INIT = 3
</PRE>
 initialisation error
<A NAME="var_coupler_error_input_file"><H3>COUPLER_ERROR_INPUT_FILE</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_INPUT_FILE = 4
</PRE>
 wrong value in input file
<A NAME="var_coupler_error_read_input"><H3>COUPLER_ERROR_READ_INPUT</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_READ_INPUT = 5
</PRE>
 error in processing input file or data transfers
<A NAME="var_coupler_error_continuum_force"><H3>COUPLER_ERROR_CONTINUUM_FORCE</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_CONTINUUM_FORCE = 6
</PRE>
the region in which the continuum constrain force is apply spans over two MD domains
<A NAME="var_coupler_abort_on_request"><H3>COUPLER_ABORT_ON_REQUEST</H3></A>
<PRE>integer, public, parameter :: COUPLER_ABORT_ON_REQUEST = 7
</PRE>
 used in request_abort 
<A NAME="var_coupler_abort_send_cfd"><H3>COUPLER_ABORT_SEND_CFD</H3></A>
<PRE>integer, public, parameter :: COUPLER_ABORT_SEND_CFD = 8
</PRE>
 error in coupler_cfd_send
<A NAME="var_coupler_error_cart_comm"><H3>COUPLER_ERROR_CART_COMM</H3></A>
<PRE>integer, public, parameter :: COUPLER_ERROR_CART_COMM = 9
</PRE>
 Wrong comm value in CPL_Cart_coords
<A NAME="var_ierr"><H3>ierr</H3></A>
<PRE>integer, public :: ierr
</PRE>
 MPI error flag
<A NAME="var_cpl_world_comm"><H3>CPL_WORLD_COMM</H3></A>
<PRE>integer, public, protected :: CPL_WORLD_COMM
</PRE>
 Copy of MPI_COMM_WORLD, both CFD and MD realms;
<A NAME="var_cpl_realm_comm"><H3>CPL_REALM_COMM</H3></A>
<PRE>integer, public, protected :: CPL_REALM_COMM
</PRE>
 INTRA communicators within MD/CFD realms;
<A NAME="var_cpl_inter_comm"><H3>CPL_INTER_COMM</H3></A>
<PRE>integer, public, protected :: CPL_INTER_COMM
</PRE>
  CFD/MD INTER communicator between realm comms;
<A NAME="var_cpl_cart_comm"><H3>CPL_CART_COMM</H3></A>
<PRE>integer, public, protected :: CPL_CART_COMM
</PRE>
  Comm w/cartesian topology for each realm;
<A NAME="var_cpl_olap_comm"><H3>CPL_OLAP_COMM</H3></A>
<PRE>integer, public, protected :: CPL_OLAP_COMM
</PRE>
  Local comm between only overlapping MD/CFD procs;
<A NAME="var_cpl_graph_comm"><H3>CPL_GRAPH_COMM</H3></A>
<PRE>integer, public, protected :: CPL_GRAPH_COMM
</PRE>
  Comm w/ graph topolgy between locally olapg procs;
<A NAME="var_cpl_realm_intersection_comm"><H3>CPL_REALM_INTERSECTION_COMM</H3></A>
<PRE>integer, public, protected :: CPL_REALM_INTERSECTION_COMM
</PRE>
  Intersecting MD/CFD procs in world;
<A NAME="var_realm"><H3>realm</H3></A>
<PRE>integer, public, protected :: realm
</PRE>
 Simulation realms
<A NAME="var_myid_world"><H3>myid_world</H3></A>
<PRE>integer, public, protected :: myid_world
</PRE>
 Processor ID from 0 to nproc_world-1;
<A NAME="var_rank_world"><H3>rank_world</H3></A>
<PRE>integer, public, protected :: rank_world
</PRE>
 Processor rank from 1 to nproc_world;
<A NAME="var_rootid_world"><H3>rootid_world</H3></A>
<PRE>integer, public, protected :: rootid_world
</PRE>
 Root processor in world;
<A NAME="var_myid_realm"><H3>myid_realm</H3></A>
<PRE>integer, public, protected :: myid_realm
</PRE>
 Processor ID from 0 to nproc_realm-1;
<A NAME="var_rank_realm"><H3>rank_realm</H3></A>
<PRE>integer, public, protected :: rank_realm
</PRE>
 Processor rank from 1 to nproc_realm;
<A NAME="var_rootid_realm"><H3>rootid_realm</H3></A>
<PRE>integer, public, protected :: rootid_realm
</PRE>
 Root processor in each realm;
<A NAME="var_myid_cart"><H3>myid_cart</H3></A>
<PRE>integer, public, protected :: myid_cart
</PRE>
 Processor ID from 0 to nproc_cart-1;
<A NAME="var_rank_cart"><H3>rank_cart</H3></A>
<PRE>integer, public, protected :: rank_cart
</PRE>
 Processor rank from 1 to nproc_cart;
<A NAME="var_rootid_cart"><H3>rootid_cart</H3></A>
<PRE>integer, public, protected :: rootid_cart
</PRE>
 Root processor in each cart topology;
<A NAME="var_myid_olap"><H3>myid_olap</H3></A>
<PRE>integer, public, protected :: myid_olap
</PRE>
 Processor ID from 0 to nproc_olap-1;
<A NAME="var_rank_olap"><H3>rank_olap</H3></A>
<PRE>integer, public, protected :: rank_olap
</PRE>
 Processor rank from 1 to nproc_olap;
<A NAME="var_cfdid_olap"><H3>CFDid_olap</H3></A>
<PRE>integer, public, protected :: CFDid_olap
</PRE>
 Root processor in overlap is the CFD processor;
<A NAME="var_myid_graph"><H3>myid_graph</H3></A>
<PRE>integer, public, protected :: myid_graph
</PRE>
 Processor ID from 0 to nproc_graph-1;
<A NAME="var_rank_graph"><H3>rank_graph</H3></A>
<PRE>integer, public, protected :: rank_graph
</PRE>
 Processor rank from 1 to nproc_graph;
<A NAME="var_rank_world2rank_mdrealm"><H3>rank_world2rank_mdrealm</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_mdrealm
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_mdcart"><H3>rank_world2rank_mdcart</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_mdcart
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_cfdrealm"><H3>rank_world2rank_cfdrealm</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_cfdrealm
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_cfdcart"><H3>rank_world2rank_cfdcart</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_cfdcart
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_olap"><H3>rank_world2rank_olap</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_olap
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_graph"><H3>rank_world2rank_graph</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_graph
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_world2rank_inter"><H3>rank_world2rank_inter</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_world2rank_inter
</PRE>
 Get rank in CPL_world_COMM from rank in local COMM
<A NAME="var_rank_mdrealm2rank_world"><H3>rank_mdrealm2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_mdrealm2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_mdcart2rank_world"><H3>rank_mdcart2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_mdcart2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_cfdrealm2rank_world"><H3>rank_cfdrealm2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_cfdrealm2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_cfdcart2rank_world"><H3>rank_cfdcart2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_cfdcart2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_olap2rank_world"><H3>rank_olap2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_olap2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_graph2rank_world"><H3>rank_graph2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_graph2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_inter2rank_world"><H3>rank_inter2rank_world</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_inter2rank_world
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_rank_olap2rank_realm"><H3>rank_olap2rank_realm</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: rank_olap2rank_realm
</PRE>
 Get rank in local COMM from rank in CPL_world_COMM
<A NAME="var_nproc_md"><H3>nproc_md</H3></A>
<PRE>integer, public, protected :: nproc_md
</PRE>
 Total number of processor in md
<A NAME="var_nproc_cfd"><H3>nproc_cfd</H3></A>
<PRE>integer, public, protected :: nproc_cfd
</PRE>
 Total number of processor in cfd
<A NAME="var_nproc_olap"><H3>nproc_olap</H3></A>
<PRE>integer, public, protected :: nproc_olap
</PRE>
 Total number of processor in overlap region
<A NAME="var_nproc_world"><H3>nproc_world</H3></A>
<PRE>integer, public, protected :: nproc_world
</PRE>
 Total number of processor in world
<A NAME="var_npx_md"><H3>npx_md</H3></A>
<PRE>integer, public, protected :: npx_md
</PRE>
 Number of processor in x in the md
<A NAME="var_npy_md"><H3>npy_md</H3></A>
<PRE>integer, public, protected :: npy_md
</PRE>
 Number of processor in y in the md
<A NAME="var_npz_md"><H3>npz_md</H3></A>
<PRE>integer, public, protected :: npz_md
</PRE>
 Number of processor in z in the md
<A NAME="var_npx_cfd"><H3>npx_cfd</H3></A>
<PRE>integer, public, protected :: npx_cfd
</PRE>
 Number of processor in x in the cfd
<A NAME="var_npy_cfd"><H3>npy_cfd</H3></A>
<PRE>integer, public, protected :: npy_cfd
</PRE>
 Number of processor in y in the cfd
<A NAME="var_npz_cfd"><H3>npz_cfd</H3></A>
<PRE>integer, public, protected :: npz_cfd
</PRE>
 Number of processor in z in the cfd
<A NAME="var_olap_mask"><H3>olap_mask</H3></A>
<PRE>logical, public, protected, dimension(:), allocatable :: olap_mask
</PRE>
 Overlap mask specifying which processors overlap using world ranks
<A NAME="var_rank2coord_cfd"><H3>rank2coord_cfd</H3></A>
<PRE>integer, public, protected, dimension(:,:), allocatable :: rank2coord_cfd
</PRE>
 Array containing coordinates for each cartesian rank 
<A NAME="var_rank2coord_md"><H3>rank2coord_md</H3></A>
<PRE>integer, public, protected, dimension(:,:), allocatable :: rank2coord_md
</PRE>
 Array containing coordinates for each cartesian rank 
<A NAME="var_coord2rank_cfd"><H3>coord2rank_cfd</H3></A>
<PRE>integer, public, protected, dimension(:,:,:), allocatable :: coord2rank_cfd
</PRE>
<A NAME="var_coord2rank_md"><H3>coord2rank_md</H3></A>
<PRE>integer, public, protected, dimension(:,:,:), allocatable :: coord2rank_md
</PRE>
<A NAME="var_iblock_realm"><H3>iblock_realm</H3></A>
<PRE>integer, public, protected :: iblock_realm
</PRE>
 Processor cartesian coords	
<A NAME="var_jblock_realm"><H3>jblock_realm</H3></A>
<PRE>integer, public, protected :: jblock_realm
</PRE>
 Processor cartesian coords	
<A NAME="var_kblock_realm"><H3>kblock_realm</H3></A>
<PRE>integer, public, protected :: kblock_realm
</PRE>
 Processor cartesian coords	
<A NAME="var_ncx"><H3>ncx</H3></A>
<PRE>integer, public, protected :: ncx
</PRE>
<A NAME="var_ncy"><H3>ncy</H3></A>
<PRE>integer, public, protected :: ncy
</PRE>
<A NAME="var_ncz"><H3>ncz</H3></A>
<PRE>integer, public, protected :: ncz
</PRE>
<A NAME="var_icmin"><H3>icmin</H3></A>
<PRE>integer, public, protected :: icmin
</PRE>
<A NAME="var_icmax"><H3>icmax</H3></A>
<PRE>integer, public, protected :: icmax
</PRE>
<A NAME="var_jcmin"><H3>jcmin</H3></A>
<PRE>integer, public, protected :: jcmin
</PRE>
<A NAME="var_jcmax"><H3>jcmax</H3></A>
<PRE>integer, public, protected :: jcmax
</PRE>
<A NAME="var_kcmin"><H3>kcmin</H3></A>
<PRE>integer, public, protected :: kcmin
</PRE>
<A NAME="var_kcmax"><H3>kcmax</H3></A>
<PRE>integer, public, protected :: kcmax
</PRE>
<A NAME="var_icmin_olap"><H3>icmin_olap</H3></A>
<PRE>integer, public, protected :: icmin_olap
</PRE>
<A NAME="var_icmax_olap"><H3>icmax_olap</H3></A>
<PRE>integer, public, protected :: icmax_olap
</PRE>
<A NAME="var_jcmin_olap"><H3>jcmin_olap</H3></A>
<PRE>integer, public, protected :: jcmin_olap
</PRE>
<A NAME="var_jcmax_olap"><H3>jcmax_olap</H3></A>
<PRE>integer, public, protected :: jcmax_olap
</PRE>
<A NAME="var_kcmin_olap"><H3>kcmin_olap</H3></A>
<PRE>integer, public, protected :: kcmin_olap
</PRE>
<A NAME="var_kcmax_olap"><H3>kcmax_olap</H3></A>
<PRE>integer, public, protected :: kcmax_olap
</PRE>
<A NAME="var_ncx_olap"><H3>ncx_olap</H3></A>
<PRE>integer, public, protected :: ncx_olap
</PRE>
<A NAME="var_ncy_olap"><H3>ncy_olap</H3></A>
<PRE>integer, public, protected :: ncy_olap
</PRE>
<A NAME="var_ncz_olap"><H3>ncz_olap</H3></A>
<PRE>integer, public, protected :: ncz_olap
</PRE>
<A NAME="var_constraint_algo"><H3>constraint_algo</H3></A>
<PRE>integer, public, protected :: constraint_algo
</PRE>
<A NAME="var_constraint_cvflag"><H3>constraint_CVflag</H3></A>
<PRE>integer, public, protected :: constraint_CVflag
</PRE>
<A NAME="var_icmin_cnst"><H3>icmin_cnst</H3></A>
<PRE>integer, public, protected :: icmin_cnst
</PRE>
<A NAME="var_icmax_cnst"><H3>icmax_cnst</H3></A>
<PRE>integer, public, protected :: icmax_cnst
</PRE>
<A NAME="var_jcmin_cnst"><H3>jcmin_cnst</H3></A>
<PRE>integer, public, protected :: jcmin_cnst
</PRE>
<A NAME="var_jcmax_cnst"><H3>jcmax_cnst</H3></A>
<PRE>integer, public, protected :: jcmax_cnst
</PRE>
<A NAME="var_kcmin_cnst"><H3>kcmin_cnst</H3></A>
<PRE>integer, public, protected :: kcmin_cnst
</PRE>
<A NAME="var_kcmax_cnst"><H3>kcmax_cnst</H3></A>
<PRE>integer, public, protected :: kcmax_cnst
</PRE>
<A NAME="var_constraint_off"><H3>constraint_off</H3></A>
<PRE>integer, public, parameter :: constraint_off = 0
</PRE>
<A NAME="var_constraint_ot"><H3>constraint_OT</H3></A>
<PRE>integer, public, parameter :: constraint_OT = 1
</PRE>
<A NAME="var_constraint_ncer"><H3>constraint_NCER</H3></A>
<PRE>integer, public, parameter :: constraint_NCER = 2
</PRE>
<A NAME="var_constraint_flekkoy"><H3>constraint_Flekkoy</H3></A>
<PRE>integer, public, parameter :: constraint_Flekkoy = 3
</PRE>
<A NAME="var_icpmin_md"><H3>icPmin_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: icPmin_md
</PRE>
<A NAME="var_icpmax_md"><H3>icPmax_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: icPmax_md
</PRE>
<A NAME="var_jcpmin_md"><H3>jcPmin_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: jcPmin_md
</PRE>
<A NAME="var_jcpmax_md"><H3>jcPmax_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: jcPmax_md
</PRE>
<A NAME="var_kcpmin_md"><H3>kcPmin_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: kcPmin_md
</PRE>
<A NAME="var_kcpmax_md"><H3>kcPmax_md</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: kcPmax_md
</PRE>
<A NAME="var_icpmin_cfd"><H3>icPmin_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: icPmin_cfd
</PRE>
<A NAME="var_icpmax_cfd"><H3>icPmax_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: icPmax_cfd
</PRE>
<A NAME="var_jcpmin_cfd"><H3>jcPmin_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: jcPmin_cfd
</PRE>
<A NAME="var_jcpmax_cfd"><H3>jcPmax_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: jcPmax_cfd
</PRE>
<A NAME="var_kcpmin_cfd"><H3>kcPmin_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: kcPmin_cfd
</PRE>
<A NAME="var_kcpmax_cfd"><H3>kcPmax_cfd</H3></A>
<PRE>integer, public, protected, dimension(:), allocatable :: kcPmax_cfd
</PRE>
<A NAME="var_xl_md"><H3>xL_md</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: xL_md
</PRE>
<A NAME="var_yl_md"><H3>yL_md</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: yL_md
</PRE>
<A NAME="var_zl_md"><H3>zL_md</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: zL_md
</PRE>
<A NAME="var_xl_cfd"><H3>xL_cfd</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: xL_cfd
</PRE>
<A NAME="var_yl_cfd"><H3>yL_cfd</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: yL_cfd
</PRE>
<A NAME="var_zl_cfd"><H3>zL_cfd</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: zL_cfd
</PRE>
<A NAME="var_xl_olap"><H3>xL_olap</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: xL_olap
</PRE>
<A NAME="var_yl_olap"><H3>yL_olap</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: yL_olap
</PRE>
<A NAME="var_zl_olap"><H3>zL_olap</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: zL_olap
</PRE>
<A NAME="var_xll"><H3>xLl</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: xLl
</PRE>
<A NAME="var_yll"><H3>yLl</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: yLl
</PRE>
<A NAME="var_zll"><H3>zLl</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: zLl
</PRE>
<A NAME="var_dx"><H3>dx</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dx
</PRE>
<A NAME="var_dy"><H3>dy</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dy
</PRE>
<A NAME="var_dz"><H3>dz</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dz
</PRE>
<A NAME="var_dymin"><H3>dymin</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dymin
</PRE>
<A NAME="var_dymax"><H3>dymax</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dymax
</PRE>
<A NAME="var_xg"><H3>xg</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected, dimension(:,:), allocatable, target :: xg
</PRE>
<A NAME="var_yg"><H3>yg</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected, dimension(:,:), allocatable, target :: yg
</PRE>
<A NAME="var_zg"><H3>zg</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected, dimension(:), allocatable, target :: zg
</PRE>
<A NAME="var_cfd_icoord2olap_md_icoords"><H3>cfd_icoord2olap_md_icoords</H3></A>
<PRE>integer, public, protected, dimension(:,:), allocatable :: cfd_icoord2olap_md_icoords
</PRE>
<A NAME="var_cfd_jcoord2olap_md_jcoords"><H3>cfd_jcoord2olap_md_jcoords</H3></A>
<PRE>integer, public, protected, dimension(:,:), allocatable :: cfd_jcoord2olap_md_jcoords
</PRE>
<A NAME="var_cfd_kcoord2olap_md_kcoords"><H3>cfd_kcoord2olap_md_kcoords</H3></A>
<PRE>integer, public, protected, dimension(:,:), allocatable :: cfd_kcoord2olap_md_kcoords
</PRE>
<A NAME="var_nsteps_md"><H3>nsteps_md</H3></A>
<PRE>integer, public, protected :: nsteps_md
</PRE>
<A NAME="var_nsteps_cfd"><H3>nsteps_cfd</H3></A>
<PRE>integer, public, protected :: nsteps_cfd
</PRE>
<A NAME="var_nsteps_coupled"><H3>nsteps_coupled</H3></A>
<PRE>integer, public, protected :: nsteps_coupled
</PRE>
<A NAME="var_average_period"><H3>average_period</H3></A>
<PRE>integer, public, protected :: average_period = 1
</PRE>
<A NAME="var_save_period"><H3>save_period</H3></A>
<PRE>integer, public, protected :: save_period = 10
</PRE>
<A NAME="var_dt_md"><H3>dt_md</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dt_md
</PRE>
<A NAME="var_dt_cfd"><H3>dt_cfd</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: dt_cfd
</PRE>
<A NAME="var_density_md"><H3>density_md</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: density_md
</PRE>
<A NAME="var_density_cfd"><H3>density_cfd</H3></A>
<PRE>real (kind=kind (0.d0)), public, protected :: density_cfd
</PRE>
<A NAME="var_timestep_ratio"><H3>timestep_ratio</H3></A>
<PRE>integer, public, protected :: timestep_ratio
</PRE>
<A NAME="var_md_cfd_match_cellsize"><H3>md_cfd_match_cellsize</H3></A>
<PRE>integer, public, protected :: md_cfd_match_cellsize
</PRE>
<A NAME="var_testval"><H3>testval</H3></A>
<PRE>integer, public, protected :: testval
</PRE>
<A NAME="var_staggered_averages"><H3>staggered_averages</H3></A>
<PRE>logical, public, protected, dimension (3) :: staggered_averages = (/ .false., .false., .false. /)
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_error_abort"><H3>error_abort</H3></A>
<PRE>public interface error_abort
    module procedure <A HREF="#subroutine_error_abort_s">error_abort_s</A>
    module procedure <A HREF="#subroutine_error_abort_si">error_abort_si</A>
end interface error_abort
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_cpl_create_comm"><H3>CPL_create_comm</H3></A>
<PRE>public subroutine CPL_create_comm (callingrealm, RETURNED_REALM_COMM, ierror)
    integer, intent(in) :: callingrealm
    integer, intent(out) :: RETURNED_REALM_COMM
    integer, intent(out) :: ierror
    ! Calls: MPI_comm_rank, MPI_comm_size, create_comm, test_realms
end subroutine CPL_create_comm
</PRE>
 (cfd+md) Splits MPI_COMM_WORLD in both the CFD and MD code respectively
 		   and create intercommunicator between CFD and MD
<A NAME="subroutine_read_coupler_input"><H3>read_coupler_input</H3></A>
<PRE>public subroutine read_coupler_input ()
    ! Calls: error_abort, locate
end subroutine read_coupler_input
</PRE>
 Read Coupler input file
<A NAME="subroutine_cpl_write_header"><H3>CPL_write_header</H3></A>
<PRE>public subroutine CPL_write_header (header_filename)
    character (len=*), intent(in) :: header_filename
    ! Calls: date_and_time
end subroutine CPL_write_header
</PRE>
 Writes header information to specified filename in the format
 Variable description ; variable name ; variable
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  CPL_write_header (header_filename)
<P>
  </UL>
 <LI>  Input
<P>
  <UL>
  <LI>  header_filename
   <UL>
   <LI>  File name to write header to
<P>
   </UL>
  </UL>
 <LI>  Input/Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 <LI>  Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_coupler_cfd_init"><H3>coupler_cfd_init</H3></A>
<PRE>public subroutine coupler_cfd_init (nsteps, dt, icomm_grid, icoord, npxyz_cfd, xyzL, ncxyz, density, ijkcmax, ijkcmin, iTmin, iTmax, jTmin, jTmax, kTmin, kTmax, xgrid, ygrid, zgrid)
    integer, intent(in) :: nsteps
    real (kind=kind (0.d0)), intent(in) :: dt
    integer, intent(in) :: icomm_grid
    integer, dimension(:,:), intent(in) :: icoord
    integer, dimension(3), intent(in) :: npxyz_cfd
    real (kind=kind (0.d0)), dimension(3), intent(in) :: xyzL
    integer, dimension(3), intent(in) :: ncxyz
    real (kind=kind (0.d0)), intent(in) :: density
    integer, dimension(3), intent(in) :: ijkcmax
    integer, dimension(3), intent(in) :: ijkcmin
    integer, dimension(:), intent(in) :: iTmin
    integer, dimension(:), intent(in) :: iTmax
    integer, dimension(:), intent(in) :: jTmin
    integer, dimension(:), intent(in) :: jTmax
    integer, dimension(:), intent(in) :: kTmin
    integer, dimension(:), intent(in) :: kTmax
    real (kind=kind (0.d0)), dimension(:,:), intent(in) :: xgrid
    real (kind=kind (0.d0)), dimension(:,:), intent(in) :: ygrid
    real (kind=kind (0.d0)), dimension(:  ), intent(in) :: zgrid
    ! Calls: CPL_create_map, CPL_rank_map, MPI_Cart_rank, MPI_bcast, MPI_comm_dup, MPI_comm_rank, check_mesh, read_coupler_input
end subroutine coupler_cfd_init
</PRE>
 Initialisation routine for coupler module - Every variable is sent and stored
 to ensure both md and cfd region have an identical list of parameters
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  coupler_cfd_init(nsteps,dt_cfd,icomm_grid,icoord,npxyz_cfd,xyzL,ncxyz,
  </UL>
 </UL>
							   density,ijkcmax,ijkcmin,iTmin,iTmax,jTmin,
							   jTmax,kTmin,kTmax,xg,yg,zg)
<P>
 <UL>
 <LI>  Input
<P>
  <UL>
  <LI>  nsteps
   <UL>
   <LI>  Number of time steps the CFD code is expected to run for (integer)
   </UL>
  <LI>  dt_cfd
   <UL>
   <LI>  CFD timestep (dp real)
   </UL>
  <LI>  icomm_grid
   <UL>
   <LI>  The MPI communicator setup by the MPI_CART_CREATE command in the 
     CFD region (integer)
   </UL>
  <LI>  icoord
   <UL>
   <LI>  The three coordinate for each rank in the domain (integer array nproc by 3)
   </UL>
  <LI>  npxyz_cfd
   <UL>
   <LI>  Number of processors in each cartesian dimension (integer array 3)
   </UL>
  <LI>  xyzL
   <UL>
   <LI>  Size of domain in each cartesian dimension (dp real array 3)
   </UL>
  <LI>  ncxyz
   <UL>
   <LI>  Global number of cells in each cartesian dimension (integer array 3)
   </UL>
  <LI>  density
   <UL>
   <LI>  Density of the CFD simulation (dp_real)
   </UL>
  <LI>  ijkcmax
   <UL>
   <LI>  Global maximum cell in each cartesian dimension (integer array 3)
   </UL>
  <LI>  ijkcmin
   <UL>
   <LI>  Global minimum cell in each cartesian dimension (integer array 3)
   </UL>
  <LI>  iTmin
   <UL>
   <LI>  Local minimum cell for each rank (integer array no. procs in x)
   </UL>
  <LI>  iTmax
   <UL>
   <LI>  Local maximum cell for each rank (integer array no. procs in x)
   </UL>
  <LI>  jTmin
   <UL>
   <LI>  Local minimum cell for each rank (integer array no. procs in y)
   </UL>
  <LI>  jTmax
   <UL>
   <LI>  Local maximum cell for each rank (integer array no. procs in y)
   </UL>
  <LI>  kTmin
   <UL>
   <LI>  Local minimum cell for each rank (integer array no. procs in z)
   </UL>
  <LI>  kTmax
   <UL>
   <LI>  Local maximum cell for each rank (integer array no. procs in z)
   </UL>
  <LI>  xg
   <UL>
   <LI>  Array of cell vertices in the x direction (no. cells in x by 
     no. cells in y)
   </UL>
  <LI>  yg
   <UL>
   <LI>  Array of cell vertices in the y direction (no. cells in x by 
     no. cells in y)
   </UL>
  <LI>  zg
   <UL>
   <LI>  Array of cell vertices in the z direction (no. cells in z)
<P>
   </UL>
  </UL>
 <LI>  Input/Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 <LI>  Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_coupler_md_init"><H3>coupler_md_init</H3></A>
<PRE>public subroutine coupler_md_init (Nsteps, initialstep, dt, icomm_grid, icoord, npxyz_md, globaldomain, density)
    integer, intent(inout) :: nsteps
    integer, intent(inout) :: initialstep
    real (kind=kind (0.d0)), intent(in) :: dt
    integer, intent(in) :: icomm_grid
    integer, dimension(:,:), allocatable, intent(in) :: icoord
    integer, dimension(3), intent(in) :: npxyz_md
    real (kind=kind (0.d0)), dimension(3), intent(in) :: globaldomain
    real (kind=kind (0.d0)), intent(in) :: density
    ! Calls: CPL_create_map, CPL_rank_map, MPI_Abort, MPI_Cart_rank, MPI_bcast, MPI_comm_dup, MPI_comm_rank, read_coupler_input, set_coupled_timing
end subroutine coupler_md_init
</PRE>
 Initialisation routine for coupler module - Every variable is sent and stored
 to ensure both md and cfd region have an identical list of parameters
<P>
 <UL>
 <LI>  Synopsis
<P>
  <UL>
  <LI>  coupler_mf_init(nsteps,dt_md,icomm_grid,icoord,npxyz_md,globaldomain,density)
<P>
  </UL>
 <LI>  Input
<P>
  <UL>
  <LI>  nsteps
   <UL>
   <LI>  Number of time steps the MD code is expected to run for (integer)
   </UL>
  <LI>  dt_md
   <UL>
   <LI>  MD timestep (dp real)
   </UL>
  <LI>  icomm_grid
   <UL>
   <LI>  The MPI communicator setup by the MPI_CART_CREATE command in the 
     CFD region (integer)
   </UL>
  <LI>  icoord
   <UL>
   <LI>  The three coordinate for each rank in the domain (integer array nproc by 3)
   </UL>
  <LI>  npxyz_md
   <UL>
   <LI>  Number of processors in each cartesian dimension (integer array 3)
   </UL>
  <LI>  globaldomain
   <UL>
   <LI>  Size of domain in each cartesian dimension (dp real array 3)
   </UL>
  <LI>  density
   <UL>
   <LI>  Density of the CFD simulation (dp_real)
<P>
   </UL>
  </UL>
 <LI>  Input/Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 <LI>  Output
  <UL>
  <LI>  NONE
<P>
  </UL>
 </UL>
<P>
<STRONG>Author:</STRONG> Edward Smith
<A NAME="subroutine_set_coupled_timing"><H3>set_coupled_timing</H3></A>
<PRE>public subroutine set_coupled_timing (Nsteps, initialstep)
    integer, intent(out) :: Nsteps
    integer, intent(in) :: initialstep
end subroutine set_coupled_timing
</PRE>
<A NAME="subroutine_cpl_create_map"><H3>CPL_create_map</H3></A>
<PRE>public subroutine CPL_create_map ()
    ! Calls: CPL_overlap_topology, check_config_feasibility, get_md_cell_ranges, get_overlap_blocks, prepare_overlap_comms
end subroutine CPL_create_map
</PRE>
 Establish for all MD processors the mapping (if any) 
 to coupled CFD processors
<A NAME="subroutine_cpl_cfd_adjust_domain"><H3>CPL_cfd_adjust_domain</H3></A>
<PRE>public subroutine CPL_cfd_adjust_domain (xL, yL, zL, nx, ny, nz, density_output)
    real (kind=kind (0.d0)), optional, intent(inout) :: xL
    real (kind=kind (0.d0)), optional, intent(inout) :: yL
    real (kind=kind (0.d0)), optional, intent(inout) :: zL
    integer, optional, intent(inout) :: nx
    integer, optional, intent(inout) :: ny
    integer, optional, intent(inout) :: nz
    real (kind=kind (0.d0)), optional, intent(inout) :: density_output
    ! Calls: MPI_Abort, init_length, test_cfd_cell_sizes
end subroutine CPL_cfd_adjust_domain
</PRE>
<A NAME="subroutine_cpl_rank_map"><H3>CPL_rank_map</H3></A>
<PRE>public subroutine CPL_rank_map (COMM, rank, nproc, comm2world, world2comm, ierr)
    integer, intent(in) :: COMM
    integer, intent(out) :: rank
    integer, intent(out) :: nproc
    integer, dimension(:), allocatable, intent(out) :: comm2world
    integer, dimension(:), allocatable, intent(out) :: world2comm
    integer, intent(out) :: ierr
    ! Calls: MPI_allgather, MPI_comm_rank, MPI_comm_size
end subroutine CPL_rank_map
</PRE>
<A NAME="subroutine_locate"><H3>locate</H3></A>
<PRE>public subroutine locate (fileid, keyword, have_data)
    integer, intent(in) :: fileid
    character (len=*), intent(in) :: keyword
    logical, intent(out) :: have_data
end subroutine locate
</PRE>
<A NAME="subroutine_error_abort_s"><H3>error_abort_s</H3></A>
<PRE>private subroutine error_abort_s (msg)
    character (len=*), optional, intent(in) :: msg
    ! Calls: MPI_Abort
end subroutine error_abort_s
</PRE>
<A NAME="subroutine_error_abort_si"><H3>error_abort_si</H3></A>
<PRE>private subroutine error_abort_si (msg, i)
    character (len=*), intent(in) :: msg
    integer, intent(in) :: i
    ! Calls: MPI_Abort
end subroutine error_abort_si
</PRE>
<A NAME="subroutine_messenger_lasterrorcheck"><H3>messenger_lasterrorcheck</H3></A>
<PRE>public subroutine messenger_lasterrorcheck ()
    ! Calls: MPI_Error_string
end subroutine messenger_lasterrorcheck
</PRE>
<A NAME="subroutine_printf"><H3>printf</H3></A>
<PRE>public subroutine printf (buf, dplaces_in)
    double precision, dimension(:), intent(in) :: buf
    integer, optional, intent(in) :: dplaces_in
end subroutine printf
</PRE>
<A NAME="subroutine_write_matrix_int"><H3>write_matrix_int</H3></A>
<PRE>public subroutine write_matrix_int (a, varname, fh)
    integer, dimension(:,:) :: a
    character (len=*) :: varname
    integer :: fh
end subroutine write_matrix_int
</PRE>
<A NAME="subroutine_write_matrix"><H3>write_matrix</H3></A>
<PRE>public subroutine write_matrix (a, varname, fh)
    double precision, dimension(:,:) :: a
    character (len=*) :: varname
    integer :: fh
end subroutine write_matrix
</PRE>
</HTML>
