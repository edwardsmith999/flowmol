Index: MD.in
===================================================================
--- MD.in	(revision 400)
+++ MD.in	(working copy)
@@ -1,286 +1,132 @@
-#######################################################################
-# This input file has been included for base-case simulation setup, and 
-# is designed to be read-only on the version-control server. Please 
-# create a copy of this file called 'MD.in' (the default input file name 
-# in the main code) if you would like to change the simulation 
-# parameters.
-# -----------------------------------------------------------------------
-
 #------------------------------------------------------------------------
-#########################################################################
-
-			#### ##    ## ########  ##     ## ########    
-			 ##  ###   ## ##     ## ##     ##    ##      
-			 ##  ####  ## ##     ## ##     ##    ##     
-			 ##  ## ## ## ########  ##     ##    ##    
-			 ##  ##  #### ##        ##     ##    ##   
-			 ##  ##   ### ##        ##     ##    ##  
-			#### ##    ## ##         #######     ## 
-
-#########################################################################
+INITIAL_CONFIG_FLAG
+1
+dense_fene
 #------------------------------------------------------------------------
-
-#########################################################################
-# Number density of the particles in the system:
-# -----------------------------------------------------------------------
-DENSITY
+DENSE_FENE
+1
+30.0
+1.5
 0.8
-
-#########################################################################
-# Cut-off distance for particle interaction:
-#	2^(1/6) = 1.12246204830937
+26
+18
+26
 # -----------------------------------------------------------------------
-RCUTOFF
-2.2
-
-#########################################################################
-# Define initial temperature of the system:
-#	- determines magnitude of initial random velocities
-# -----------------------------------------------------------------------
 INPUTTEMPERATURE
-1.1
-
-#########################################################################
-# Initial configuration
-#
-#    0 - FCC Lattice
-#    1 - Special case, must be followed by string on next line 
-#    2 - Configuration file
+1.0
 # -----------------------------------------------------------------------
-INITIAL_CONFIG_FLAG
-0
-special_case_name
-
-#########################################################################
-# Number of unit cells in the x,y,z directions, formatted:
-#	x
-#	y
-#	z	
-# -----------------------------------------------------------------------
-INITIALNUNITS
-24
-18
-24
-
-#########################################################################
-# Total number of timesteps:
-# -----------------------------------------------------------------------
 NSTEPS
 1000
-
-
-#########################################################################
-# Results are recorded periodically every TPLOT timesteps:
-#	(subroutine simulation_record is called)
 # -----------------------------------------------------------------------
 TPLOT
 15
-
-#########################################################################
-# Timestep interval:
 # -----------------------------------------------------------------------
 DELTA_T
 0.005
-
-#########################################################################
-# Integration algorithm
-# 0: Leap-frog Verlet
-# 1: Velocity Verlet
-# 2: Other
 # -----------------------------------------------------------------------
 INTEGRATION_ALGORITHM
 0
-
-#########################################################################
-# Force list used
-# 0: All Pairs
-# 1: Cell List
-# 2: Neighbour list with all interactions
-# 3: Neighbour list using 3rd law optimisation (half interactions)
 # -----------------------------------------------------------------------
 FORCE_LIST
 3
-
-#########################################################################
-# Extra distance added to r_cutoff to determine neighbour cell size
 # -----------------------------------------------------------------------
 DELTA_RNEIGHBR
 0.29
-
-
-#########################################################################
-# Ensemble selector: case sensitive! 
-# 0 - NVE
-# 1 - NVT (NosÃ©-Hoover thermostat)
-# 2 - NVT (Gaussian iso-kinetic thermostat) - only availble with VV
-# 3 - NVT (Profile unbiased NosÃ©-Hoover thermostat)
-# 4 - NVT (Pairwise additive NosÃ©-Hoover thermostat by Allen & Schmid)
-# 5 - NVT (DPD thermostat by Soddemann, Dunweg an Kremer Phys Rev E 68, 046702 (2003))
-# 6 - TAG system - specify fixed wall and localised thermostatting
 # -----------------------------------------------------------------------
+RESCUE_SNAPSHOT_FREQ
+21600
+# -----------------------------------------------------------------------
+FIXED_REBUILD_FLAG
+0
+20
+# -----------------------------------------------------------------------
+SORT_FLAG
+0
+1
+3
+# -----------------------------------------------------------------------
 ENSEMBLE
 6
-
-#########################################################################
-# Periodic boundary flags, formatted:
-#	x
-#	y
-#	z
-#
-#	Constraint must be put in place before periodic BC are turned off!
-#	
-#	0 - off
-#	1 - periodic
-#	2 - Lees-Edwards shearing BC
-#
-#	Note: currently, only the boundary in the y direction may be sheared.
 # -----------------------------------------------------------------------
 PERIODIC
 1
 0
 1
-
-#########################################################################
-# Shear definition, formatted:
-#	shear direction (i.e. 1 for x direction, -2 for negative y direction)
-#	shear iter0
-#	velocity or rate flag: 0-velocity, 1-rate
-#	numerical value
 # -----------------------------------------------------------------------
-DEFINE_SHEAR
-1
+BFORCE
 0
 0
-1.0
-
-#########################################################################
-# Potential flag:
-#	0 - Lennard-Jones
-#	1 - FENE spring polymer potentials
+0
+2
+0
+0
+0.0
+0.0
+0.0
+2.0
+0.0
+0.0
 # -----------------------------------------------------------------------
-POTENTIAL_FLAG
+SOLVENT_INFO
 0
-
-#########################################################################
-# Parameters of the FENE potential, formatted:
-#	number of LJ beads for each polymer chain
-#	spring constant, k_c
-#	maximum spring elongation
+0
+0.0
+0.0
+0.0
 # -----------------------------------------------------------------------
-FENE_INFO
-8
-30.0
-1.5
-
-#########################################################################
-# Random number seeds, formattted:
-#	seed1
-#	seed2
-#	
-# If seed1 and seed2 are the same, the seed generation will be
-# automatically randomised by the main program.
-# -----------------------------------------------------------------------
 SEED
 1
 2
-
-
-#########################################################################
-# MPI topology
-#   npx 
-#   npy
-#   npz
-#
-# if npz = 0 it will be set to nproc/(npx*npy)
-#
-# constrain: npx*npy*npz = nproc 
-# nproc is set by the argument of mpirun
-#-----------------------------------------------------------------------
-PROCESSORS
-2
-2
-1
-
-########################################################################
-# Velocity of sliding molecules in wall
 # ----------------------------------------------------------------------
 WALLSLIDEV
 0.0
 0.0
 0.0
-
-########################################################################
-# Distance from domain bottom to apply sliding velocity to molecules 
-# where applied velocity v=WALLSLIDEV
 # ----------------------------------------------------------------------
 SLIDEDISTBOTTOM
 0.0
 0.0
 0.0
-
-########################################################################
-# Distance from domain top to apply sliding velocity to molecules 
-# where applied velocity v=WALLSLIDEV
 # ----------------------------------------------------------------------
 SLIDEDISTTOP
 0.0
 0.0
 0.0
-
-########################################################################
-# Distance from domain bottom to Fix molecules, i.e. v=0 unless sliding
 # ----------------------------------------------------------------------
 FIXDISTBOTTOM
 0.0
 0.0
 0.0
-
-########################################################################
-# Distance from domain top to Fix molecules, i.e. v=0 unless sliding
 # ----------------------------------------------------------------------
 FIXDISTTOP
 0.0
 0.0
 0.0
-
-########################################################################
-# Distance from domain bottom to tethered molecules using spring like
-# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
-# strength of tethering potential from Petravic and Harrowell 
-# with constants (k4 = 5,000, k6 = 5,000,000)
 # ----------------------------------------------------------------------
 TETHEREDDISTBOTTOM
 0.0
-1.29
+1.3
 0.0
-
-########################################################################
-# Distance from domain top to tethered molecules using spring like
-# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
-# strength of tethering potential from Petravic and Harrowell 
-# with constants (k4 = 5,000, k6 = 5,000,000)
 # ----------------------------------------------------------------------
 TETHEREDDISTTOP
 0.0
 0.0
 0.0
-
-
-########################################################################
-# Distance from domain bottom to apply thermostat 
-# ----------------------------------------------------------------------
+# -----------------------------------------------------------------------
 THERMSTATBOTTOM
 0.0
+1.3
 0.0
-0.0
-
-########################################################################
-# Distance from domain top to apply thermostat 
 # ----------------------------------------------------------------------
 THERMSTATTOP
 0.0
-41.0392
 0.0
+0.0
+#-----------------------------------------------------------------------
+PROCESSORS
+2 
+2
+1
 
 #------------------------------------------------------------------------
 #########################################################################
@@ -302,7 +148,7 @@
 #			1-homogeneous, 
 #			2-solid/liquid,
 #	      	3-homogeneous+halos, 
-#			4-Debug
+#			4-"true" unwrapped positions
 #	Number of intervals: 0-all, 1 to 20-specified in csv format below
 #						20 or more-all
 #	Intervals: start and finish iteration of each interval in format
@@ -310,8 +156,8 @@
 # -----------------------------------------------------------------------
 VMD_OUTFLAG
 1
-5
-0,100,200,400,1000,2000,4000,5000,6000,7500
+3
+0, 1000, 9000, 10000, 99000, 100000
 
 #########################################################################
 # Output flag for macroscopic properties:
@@ -331,7 +177,7 @@
 # -----------------------------------------------------------------------
 MASS_OUTFLAG
 0
-1
+100
 
 #########################################################################
 # Output flag for Velocity record:
@@ -339,15 +185,6 @@
 #	No. of samples for velocity average
 # -----------------------------------------------------------------------
 VELOCITY_OUTFLAG
-4
-200
-
-#########################################################################
-# Output flag for Velocity record:
-#	output_flag (0=off 1,2,3=x,y,z slice 4=3D bins)
-#	No. of samples for velocity average
-# -----------------------------------------------------------------------
-TEMPERATURE_OUTFLAG
 0
 100
 
@@ -355,12 +192,10 @@
 # Output flag for Pressure binning:
 #	output_flag (0=off 1=virial 2=Volume Averaged)
 #	No. of samples for pressure average (number of viscosity bins)
-#	Seperate kinetic and configurational 0 = together 1=seperate
 # -----------------------------------------------------------------------
 PRESSURE_OUTFLAG
 0
 100
-0
 
 #########################################################################
 # Output flag for viscosity:
@@ -373,6 +208,15 @@
 0
 100
 
+#########################################################################
+# Control Volume Conservation Averaging
+#	CV Conservation averaging (0=off 1=on) - take mass, momentum or 
+#	energy flux measure every step to ensureflux will be equal to change 
+#	in snapshots. Note, this increases computational cost somewhat
+#
+# -----------------------------------------------------------------------
+CV_CONSERVE
+1
 
 #########################################################################
 # Output flag for mass flux:
@@ -402,14 +246,19 @@
 # -----------------------------------------------------------------------
 EFLUX_OUTFLAG
 0
-1
+100
 
 #########################################################################
 # Output flag for end-to-end vector time correlation function (etevtcf):
-#	- flag (0-off,1-print to terminal,2-write to output file)
+#	- flag:
+#	    > 0 - off
+#	    > 1 - on-the-fly calculation, printed to terminal
+#	    > 2 - write entire history of vectors so that t.c.f. may
+#	          be calculated with a post-processing routine (fft).
+#
 #	- iteration at which to begin averaging (must be "hit" by a tplot, 
 #	  otherwise etev_0 will not be initialised and the t.c.f. will be
-#	  incorrectly calculated.
+#	  incorrectly calculated.)
 # -----------------------------------------------------------------------
 ETEVTCF_OUTFLAG
 0
@@ -417,8 +266,13 @@
 
 #########################################################################
 # Radius of gyration output flag:
-#	0 - off
-#	1 - on
+#	- flag:
+#		> 0 - off
+#		> 1 - on
+#		> 2 - on + output file
+#	- iteration at which to begin averaging (must be "hit" by a tplot, 
+#	  otherwise etev_0 will not be initialised and the t.c.f. will be
+#	  incorrectly calculated.)
 # -----------------------------------------------------------------------
 R_GYRATION_OUTFLAG
 0
@@ -428,11 +282,12 @@
 # Radial distribution output flag
 #	- flag: 
 #		> 0 - off
-#		> 1 - on
+#		> 1 - on (1D, spherical)
+#		> 2 - on (3D, cartesian)
 #	- maximum radius for the calculation of g(r)
 #	- number of radial "shells" or "bins"
 # -----------------------------------------------------------------------
-RADIALDIST_OUTFLAG
+RDF_OUTFLAG
 0
 3.5
 100
Index: param.inc
===================================================================
--- param.inc	(revision 400)
+++ param.inc	(working copy)
@@ -16,7 +16,7 @@
 !
 
 !--Define Grid Dimension
-   parameter (ngx = 8+1 , ngy = 8+1, ngz = 8+1, ngxyz =ngx *ngy *ngz  , nphase=26)
+   parameter (ngx = 16+1 , ngy = 16+1, ngz = 16+1, ngxyz =ngx *ngy *ngz  , nphase=26)
    parameter (ngxm= ngx-1 , ngym= ngy-1, ngzm= ngz-1, ngxyzm=ngxm*ngym*ngzm            )
 
    parameter (npx=1, npy=1, npz=1, nproc=npx*npy*npz)
Index: input.file
===================================================================
--- input.file	(revision 400)
+++ input.file	(working copy)
@@ -1,7 +1,7 @@
-41.0394227202	! Lx		Domain Length
-41.0394227202	! Ly		Domain height at inlet
-9				! ngx		Number of streamwise  grid points
-9				! ngy		Number of wall-normal grid points
+44.4593746136	! Lx		Domain Length
+44.7702793312	! Ly		Domain height at inlet
+17				! ngx		Number of streamwise  grid points
+17				! ngy		Number of wall-normal grid points
 0				! imeshY	Mesh Sretching parameter (0=uniform)(1=tanh)(2=gauss-lobatto)
 40.				! ratio		Mesh Stretching Ratio (delta yn / delta y1)
 0				! direction Mesh Stretching direction (0=top to bottom)(1=bottom to top)
Index: input.setup
===================================================================
--- input.setup	(revision 400)
+++ input.setup	(working copy)
@@ -3,14 +3,14 @@
 !ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
 
 ! Grid size  !T (Should be the same as (ngx,ngy,ngz) in "param.inc"
-9	nix
-9	niy
-9	niz
+17	nix
+17	niy
+17	niz
 
 ! Domain size
-41.0394227202	xL	domain length
-41.0394227202	yL	domain length
-41.0394227202	zL  domain width
+44.4593746136 xL	domain length
+44.7702793312 yL	domain length
+44.4593746136 zL  domain width
 
 ! Mesh parameters
 0	imeshY	stretching in Y: (0)uniform (1)pw-linear (2)matched tanh (3) Gauss-Lobatto
Index: COUPLER.in
===================================================================
--- COUPLER.in	(revision 400)
+++ COUPLER.in	(working copy)
@@ -20,6 +20,37 @@
 DENSITY_CFD
 0.8
 
+###############################################################################
+#
+#   constraint_info
+#      -  flag choosing continuum to molecular constraint method (integer)
+#             0 = off 
+#             1 = O'Connell & Thompson     1995  Phys. Rev. E 52, 5792
+#             2 = Nie, Chen, E & Robbins   2003  JFM 500 pp. 55-64
+#             3 = FlekkÃ¸y, Wagner & Feder  2000  Europhys. Lett. 52 3, p271
+#
+#      -  flag for control volume version of the above           (integer)
+#             0 = no
+#             1 = yes
+#
+#      -  define constrained region cell extents             (6 * integer)
+#             1. icmin_cnst
+#             2. icmax_cnst
+#             3. jcmin_cnst
+#             4. jcmax_cnst
+#             5. kcmin_cnst
+#             6. kcmax_cnst
+#
+# -----------------------------------------------------------------------------
+CONSTRAINT_INFO
+2
+0
+1
+8
+3
+3
+1
+8
 
 ###############################################################################
 #
Index: diffed
===================================================================
--- diffed	(revision 400)
+++ diffed	(working copy)
@@ -1,59 +1,563 @@
-50,51c50,51
-< 12      ianim
-< 15.0    save_dt
----
-> 12        ianim
-> 15.0     save_dt
-1,2c1,2
-< 41.0394227202	! Lx		Domain Length
-< 41.0394227202	! Ly		Domain height at inlet
----
-> 41.0394227202407 	! Lx		Domain Length
-> 41.0394227202407	! Ly		Domain height at inlet
-11,13c11,13
-< 41.0394227202	xL	domain length
-< 41.0394227202	yL	domain length
-< 41.0394227202	zL  domain width
----
-> 41.0394227202407		xL domain length
-> 41.0394227202407		yL domain height
-> 41.0394227202407		zL domain width
-41c41
-< 1.1
----
-> 1.0
-43,49d42
-< #########################################################################
-< # Initial configuration
-< #
-< #    0 - FCC Lattice
-< #    1 - Special case, must be followed by string on next line 
-< #    2 - Configuration file
-< # -----------------------------------------------------------------------
-52d44
-< special_case_name
-62c54
-< 18
----
-> 30
-108c100
-< 0.29
----
-> 0.3
-254c246
-< 1.29
----
-> 10.2598
-319,322c311,312
-< #	1 - high precision > stdout
-< #	2 - high precision > stdout + results/macroscopic_properties
-< #	3 - concise        > stdout
-< #	4 - concise        > stdout + results/macroscopic_properties
----
-> #	1 - print to terminal
-> #	2 - output file + print to terminal
-0a1
-> 	Í^Âej?>+ŸvŽr?¯µ‡k-Ðu?éŸÄä|?ôY%ú¿ƒ?biÙå’‰?Ð¥—û@L?Â²E…Õ-”?DAYû)š?[p½”N ?¥âû‹{ð£?gÓ+ÿä¨?¡–sÿ®?Ç=ò)¹Ç²??ÍJNo•¶?Í~ƒ¦¦`»?¡~W½(tÀ?>ýHVlÃ?1%bØAÖÆ?t¯X*ùæÊ?¢ï[l_Ï?fÒFòÎÒ?Gd±òÁ·Ô?û3	›dÁ×?.‘ÂóÚ?%bXC¤?Þ?4MÞK5ôà?—n•¢öâ?Z<ä¯‰÷ä?@Èvqöæ?¨ÃˆÕ'1é?R·Éí¦Ÿë?þñdª½í?
-\ No newline at end of file
+Index: MD.in
+===================================================================
+--- MD.in	(revision 400)
++++ MD.in	(working copy)
+@@ -1,286 +1,132 @@
+-#######################################################################
+-# This input file has been included for base-case simulation setup, and 
+-# is designed to be read-only on the version-control server. Please 
+-# create a copy of this file called 'MD.in' (the default input file name 
+-# in the main code) if you would like to change the simulation 
+-# parameters.
+-# -----------------------------------------------------------------------
+-
+ #------------------------------------------------------------------------
+-#########################################################################
+-
+-			#### ##    ## ########  ##     ## ########    
+-			 ##  ###   ## ##     ## ##     ##    ##      
+-			 ##  ####  ## ##     ## ##     ##    ##     
+-			 ##  ## ## ## ########  ##     ##    ##    
+-			 ##  ##  #### ##        ##     ##    ##   
+-			 ##  ##   ### ##        ##     ##    ##  
+-			#### ##    ## ##         #######     ## 
+-
+-#########################################################################
++INITIAL_CONFIG_FLAG
++1
++dense_fene
+ #------------------------------------------------------------------------
+-
+-#########################################################################
+-# Number density of the particles in the system:
+-# -----------------------------------------------------------------------
+-DENSITY
++DENSE_FENE
++1
++30.0
++1.5
+ 0.8
+-
+-#########################################################################
+-# Cut-off distance for particle interaction:
+-#	2^(1/6) = 1.12246204830937
++26
++18
++26
+ # -----------------------------------------------------------------------
+-RCUTOFF
+-2.2
+-
+-#########################################################################
+-# Define initial temperature of the system:
+-#	- determines magnitude of initial random velocities
+-# -----------------------------------------------------------------------
+ INPUTTEMPERATURE
+-1.1
+-
+-#########################################################################
+-# Initial configuration
+-#
+-#    0 - FCC Lattice
+-#    1 - Special case, must be followed by string on next line 
+-#    2 - Configuration file
++1.0
+ # -----------------------------------------------------------------------
+-INITIAL_CONFIG_FLAG
+-0
+-special_case_name
+-
+-#########################################################################
+-# Number of unit cells in the x,y,z directions, formatted:
+-#	x
+-#	y
+-#	z	
+-# -----------------------------------------------------------------------
+-INITIALNUNITS
+-24
+-18
+-24
+-
+-#########################################################################
+-# Total number of timesteps:
+-# -----------------------------------------------------------------------
+ NSTEPS
+ 1000
+-
+-
+-#########################################################################
+-# Results are recorded periodically every TPLOT timesteps:
+-#	(subroutine simulation_record is called)
+ # -----------------------------------------------------------------------
+ TPLOT
+ 15
+-
+-#########################################################################
+-# Timestep interval:
+ # -----------------------------------------------------------------------
+ DELTA_T
+ 0.005
+-
+-#########################################################################
+-# Integration algorithm
+-# 0: Leap-frog Verlet
+-# 1: Velocity Verlet
+-# 2: Other
+ # -----------------------------------------------------------------------
+ INTEGRATION_ALGORITHM
+ 0
+-
+-#########################################################################
+-# Force list used
+-# 0: All Pairs
+-# 1: Cell List
+-# 2: Neighbour list with all interactions
+-# 3: Neighbour list using 3rd law optimisation (half interactions)
+ # -----------------------------------------------------------------------
+ FORCE_LIST
+ 3
+-
+-#########################################################################
+-# Extra distance added to r_cutoff to determine neighbour cell size
+ # -----------------------------------------------------------------------
+ DELTA_RNEIGHBR
+ 0.29
+-
+-
+-#########################################################################
+-# Ensemble selector: case sensitive! 
+-# 0 - NVE
+-# 1 - NVT (NosÃ©-Hoover thermostat)
+-# 2 - NVT (Gaussian iso-kinetic thermostat) - only availble with VV
+-# 3 - NVT (Profile unbiased NosÃ©-Hoover thermostat)
+-# 4 - NVT (Pairwise additive NosÃ©-Hoover thermostat by Allen & Schmid)
+-# 5 - NVT (DPD thermostat by Soddemann, Dunweg an Kremer Phys Rev E 68, 046702 (2003))
+-# 6 - TAG system - specify fixed wall and localised thermostatting
+ # -----------------------------------------------------------------------
++RESCUE_SNAPSHOT_FREQ
++21600
++# -----------------------------------------------------------------------
++FIXED_REBUILD_FLAG
++0
++20
++# -----------------------------------------------------------------------
++SORT_FLAG
++0
++1
++3
++# -----------------------------------------------------------------------
+ ENSEMBLE
+ 6
+-
+-#########################################################################
+-# Periodic boundary flags, formatted:
+-#	x
+-#	y
+-#	z
+-#
+-#	Constraint must be put in place before periodic BC are turned off!
+-#	
+-#	0 - off
+-#	1 - periodic
+-#	2 - Lees-Edwards shearing BC
+-#
+-#	Note: currently, only the boundary in the y direction may be sheared.
+ # -----------------------------------------------------------------------
+ PERIODIC
+ 1
+ 0
+ 1
+-
+-#########################################################################
+-# Shear definition, formatted:
+-#	shear direction (i.e. 1 for x direction, -2 for negative y direction)
+-#	shear iter0
+-#	velocity or rate flag: 0-velocity, 1-rate
+-#	numerical value
+ # -----------------------------------------------------------------------
+-DEFINE_SHEAR
+-1
++BFORCE
+ 0
+ 0
+-1.0
+-
+-#########################################################################
+-# Potential flag:
+-#	0 - Lennard-Jones
+-#	1 - FENE spring polymer potentials
++0
++2
++0
++0
++0.0
++0.0
++0.0
++2.0
++0.0
++0.0
+ # -----------------------------------------------------------------------
+-POTENTIAL_FLAG
++SOLVENT_INFO
+ 0
+-
+-#########################################################################
+-# Parameters of the FENE potential, formatted:
+-#	number of LJ beads for each polymer chain
+-#	spring constant, k_c
+-#	maximum spring elongation
++0
++0.0
++0.0
++0.0
+ # -----------------------------------------------------------------------
+-FENE_INFO
+-8
+-30.0
+-1.5
+-
+-#########################################################################
+-# Random number seeds, formattted:
+-#	seed1
+-#	seed2
+-#	
+-# If seed1 and seed2 are the same, the seed generation will be
+-# automatically randomised by the main program.
+-# -----------------------------------------------------------------------
+ SEED
+ 1
+ 2
+-
+-
+-#########################################################################
+-# MPI topology
+-#   npx 
+-#   npy
+-#   npz
+-#
+-# if npz = 0 it will be set to nproc/(npx*npy)
+-#
+-# constrain: npx*npy*npz = nproc 
+-# nproc is set by the argument of mpirun
+-#-----------------------------------------------------------------------
+-PROCESSORS
+-2
+-2
+-1
+-
+-########################################################################
+-# Velocity of sliding molecules in wall
+ # ----------------------------------------------------------------------
+ WALLSLIDEV
+ 0.0
+ 0.0
+ 0.0
+-
+-########################################################################
+-# Distance from domain bottom to apply sliding velocity to molecules 
+-# where applied velocity v=WALLSLIDEV
+ # ----------------------------------------------------------------------
+ SLIDEDISTBOTTOM
+ 0.0
+ 0.0
+ 0.0
+-
+-########################################################################
+-# Distance from domain top to apply sliding velocity to molecules 
+-# where applied velocity v=WALLSLIDEV
+ # ----------------------------------------------------------------------
+ SLIDEDISTTOP
+ 0.0
+ 0.0
+ 0.0
+-
+-########################################################################
+-# Distance from domain bottom to Fix molecules, i.e. v=0 unless sliding
+ # ----------------------------------------------------------------------
+ FIXDISTBOTTOM
+ 0.0
+ 0.0
+ 0.0
+-
+-########################################################################
+-# Distance from domain top to Fix molecules, i.e. v=0 unless sliding
+ # ----------------------------------------------------------------------
+ FIXDISTTOP
+ 0.0
+ 0.0
+ 0.0
+-
+-########################################################################
+-# Distance from domain bottom to tethered molecules using spring like
+-# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
+-# strength of tethering potential from Petravic and Harrowell 
+-# with constants (k4 = 5,000, k6 = 5,000,000)
+ # ----------------------------------------------------------------------
+ TETHEREDDISTBOTTOM
+ 0.0
+-1.29
++1.3
+ 0.0
+-
+-########################################################################
+-# Distance from domain top to tethered molecules using spring like
+-# restoring forces with potential equation phi= -k4*rio^4 - k6*rio^6
+-# strength of tethering potential from Petravic and Harrowell 
+-# with constants (k4 = 5,000, k6 = 5,000,000)
+ # ----------------------------------------------------------------------
+ TETHEREDDISTTOP
+ 0.0
+ 0.0
+ 0.0
+-
+-
+-########################################################################
+-# Distance from domain bottom to apply thermostat 
+-# ----------------------------------------------------------------------
++# -----------------------------------------------------------------------
+ THERMSTATBOTTOM
+ 0.0
++1.3
+ 0.0
+-0.0
+-
+-########################################################################
+-# Distance from domain top to apply thermostat 
+ # ----------------------------------------------------------------------
+ THERMSTATTOP
+ 0.0
+-41.0392
+ 0.0
++0.0
++#-----------------------------------------------------------------------
++PROCESSORS
++2 
++2
++1
+ 
+ #------------------------------------------------------------------------
+ #########################################################################
+@@ -302,7 +148,7 @@
+ #			1-homogeneous, 
+ #			2-solid/liquid,
+ #	      	3-homogeneous+halos, 
+-#			4-Debug
++#			4-"true" unwrapped positions
+ #	Number of intervals: 0-all, 1 to 20-specified in csv format below
+ #						20 or more-all
+ #	Intervals: start and finish iteration of each interval in format
+@@ -310,8 +156,8 @@
+ # -----------------------------------------------------------------------
+ VMD_OUTFLAG
+ 1
+-5
+-0,100,200,400,1000,2000,4000,5000,6000,7500
++3
++0, 1000, 9000, 10000, 99000, 100000
+ 
+ #########################################################################
+ # Output flag for macroscopic properties:
+@@ -331,7 +177,7 @@
+ # -----------------------------------------------------------------------
+ MASS_OUTFLAG
+ 0
+-1
++100
+ 
+ #########################################################################
+ # Output flag for Velocity record:
+@@ -339,15 +185,6 @@
+ #	No. of samples for velocity average
+ # -----------------------------------------------------------------------
+ VELOCITY_OUTFLAG
+-4
+-200
+-
+-#########################################################################
+-# Output flag for Velocity record:
+-#	output_flag (0=off 1,2,3=x,y,z slice 4=3D bins)
+-#	No. of samples for velocity average
+-# -----------------------------------------------------------------------
+-TEMPERATURE_OUTFLAG
+ 0
+ 100
+ 
+@@ -355,12 +192,10 @@
+ # Output flag for Pressure binning:
+ #	output_flag (0=off 1=virial 2=Volume Averaged)
+ #	No. of samples for pressure average (number of viscosity bins)
+-#	Seperate kinetic and configurational 0 = together 1=seperate
+ # -----------------------------------------------------------------------
+ PRESSURE_OUTFLAG
+ 0
+ 100
+-0
+ 
+ #########################################################################
+ # Output flag for viscosity:
+@@ -373,6 +208,15 @@
+ 0
+ 100
+ 
++#########################################################################
++# Control Volume Conservation Averaging
++#	CV Conservation averaging (0=off 1=on) - take mass, momentum or 
++#	energy flux measure every step to ensureflux will be equal to change 
++#	in snapshots. Note, this increases computational cost somewhat
++#
++# -----------------------------------------------------------------------
++CV_CONSERVE
++1
+ 
+ #########################################################################
+ # Output flag for mass flux:
+@@ -402,14 +246,19 @@
+ # -----------------------------------------------------------------------
+ EFLUX_OUTFLAG
+ 0
+-1
++100
+ 
+ #########################################################################
+ # Output flag for end-to-end vector time correlation function (etevtcf):
+-#	- flag (0-off,1-print to terminal,2-write to output file)
++#	- flag:
++#	    > 0 - off
++#	    > 1 - on-the-fly calculation, printed to terminal
++#	    > 2 - write entire history of vectors so that t.c.f. may
++#	          be calculated with a post-processing routine (fft).
++#
+ #	- iteration at which to begin averaging (must be "hit" by a tplot, 
+ #	  otherwise etev_0 will not be initialised and the t.c.f. will be
+-#	  incorrectly calculated.
++#	  incorrectly calculated.)
+ # -----------------------------------------------------------------------
+ ETEVTCF_OUTFLAG
+ 0
+@@ -417,8 +266,13 @@
+ 
+ #########################################################################
+ # Radius of gyration output flag:
+-#	0 - off
+-#	1 - on
++#	- flag:
++#		> 0 - off
++#		> 1 - on
++#		> 2 - on + output file
++#	- iteration at which to begin averaging (must be "hit" by a tplot, 
++#	  otherwise etev_0 will not be initialised and the t.c.f. will be
++#	  incorrectly calculated.)
+ # -----------------------------------------------------------------------
+ R_GYRATION_OUTFLAG
+ 0
+@@ -428,11 +282,12 @@
+ # Radial distribution output flag
+ #	- flag: 
+ #		> 0 - off
+-#		> 1 - on
++#		> 1 - on (1D, spherical)
++#		> 2 - on (3D, cartesian)
+ #	- maximum radius for the calculation of g(r)
+ #	- number of radial "shells" or "bins"
+ # -----------------------------------------------------------------------
+-RADIALDIST_OUTFLAG
++RDF_OUTFLAG
+ 0
+ 3.5
+ 100
+Index: param.inc
+===================================================================
+--- param.inc	(revision 400)
++++ param.inc	(working copy)
+@@ -16,7 +16,7 @@
+ !
+ 
+ !--Define Grid Dimension
+-   parameter (ngx = 8+1 , ngy = 8+1, ngz = 8+1, ngxyz =ngx *ngy *ngz  , nphase=26)
++   parameter (ngx = 16+1 , ngy = 16+1, ngz = 16+1, ngxyz =ngx *ngy *ngz  , nphase=26)
+    parameter (ngxm= ngx-1 , ngym= ngy-1, ngzm= ngz-1, ngxyzm=ngxm*ngym*ngzm            )
+ 
+    parameter (npx=1, npy=1, npz=1, nproc=npx*npy*npz)
+Index: input.file
+===================================================================
+--- input.file	(revision 400)
++++ input.file	(working copy)
+@@ -1,7 +1,7 @@
+-41.0394227202	! Lx		Domain Length
+-41.0394227202	! Ly		Domain height at inlet
+-9				! ngx		Number of streamwise  grid points
+-9				! ngy		Number of wall-normal grid points
++44.4593746136	! Lx		Domain Length
++44.7702793312	! Ly		Domain height at inlet
++17				! ngx		Number of streamwise  grid points
++17				! ngy		Number of wall-normal grid points
+ 0				! imeshY	Mesh Sretching parameter (0=uniform)(1=tanh)(2=gauss-lobatto)
+ 40.				! ratio		Mesh Stretching Ratio (delta yn / delta y1)
+ 0				! direction Mesh Stretching direction (0=top to bottom)(1=bottom to top)
+Index: input.setup
+===================================================================
+--- input.setup	(revision 400)
++++ input.setup	(working copy)
+@@ -3,14 +3,14 @@
+ !ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
+ 
+ ! Grid size  !T (Should be the same as (ngx,ngy,ngz) in "param.inc"
+-9	nix
+-9	niy
+-9	niz
++17	nix
++17	niy
++17	niz
+ 
+ ! Domain size
+-41.0394227202	xL	domain length
+-41.0394227202	yL	domain length
+-41.0394227202	zL  domain width
++44.4593746136 xL	domain length
++44.7702793312 yL	domain length
++44.4593746136 zL  domain width
+ 
+ ! Mesh parameters
+ 0	imeshY	stretching in Y: (0)uniform (1)pw-linear (2)matched tanh (3) Gauss-Lobatto
+Index: COUPLER.in
+===================================================================
+--- COUPLER.in	(revision 400)
++++ COUPLER.in	(working copy)
+@@ -20,6 +20,37 @@
+ DENSITY_CFD
+ 0.8
+ 
++###############################################################################
++#
++#   constraint_info
++#      -  flag choosing continuum to molecular constraint method (integer)
++#             0 = off 
++#             1 = O'Connell & Thompson     1995  Phys. Rev. E 52, 5792
++#             2 = Nie, Chen, E & Robbins   2003  JFM 500 pp. 55-64
++#             3 = FlekkÃ¸y, Wagner & Feder  2000  Europhys. Lett. 52 3, p271
++#
++#      -  flag for control volume version of the above           (integer)
++#             0 = no
++#             1 = yes
++#
++#      -  define constrained region cell extents             (6 * integer)
++#             1. icmin_cnst
++#             2. icmax_cnst
++#             3. jcmin_cnst
++#             4. jcmax_cnst
++#             5. kcmin_cnst
++#             6. kcmax_cnst
++#
++# -----------------------------------------------------------------------------
++CONSTRAINT_INFO
++2
++0
++1
++8
++3
++3
++1
++8
+ 
+ ###############################################################################
+ #
